var Ut=Object.defineProperty;var Dt=(ct,lt,p)=>lt in ct?Ut(ct,lt,{enumerable:!0,configurable:!0,writable:!0,value:p}):ct[lt]=p;var pt=(ct,lt,p)=>(Dt(ct,typeof lt!="symbol"?lt+"":lt,p),p);function Ft(ct,lt){for(var p=0;p<lt.length;p++){const L=lt[p];if(typeof L!="string"&&!Array.isArray(L)){for(const v in L)if(v!=="default"&&!(v in ct)){const a=Object.getOwnPropertyDescriptor(L,v);a&&Object.defineProperty(ct,v,a.get?a:{enumerable:!0,get:()=>L[v]})}}}return Object.freeze(Object.defineProperty(ct,Symbol.toStringTag,{value:"Module"}))}(function(){const lt=document.createElement("link").relList;if(lt&&lt.supports&&lt.supports("modulepreload"))return;for(const v of document.querySelectorAll('link[rel="modulepreload"]'))L(v);new MutationObserver(v=>{for(const a of v)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&L(c)}).observe(document,{childList:!0,subtree:!0});function p(v){const a={};return v.integrity&&(a.integrity=v.integrity),v.referrerPolicy&&(a.referrerPolicy=v.referrerPolicy),v.crossOrigin==="use-credentials"?a.credentials="include":v.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function L(v){if(v.ep)return;v.ep=!0;const a=p(v);fetch(v.href,a)}})();var wt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Wt(ct){return ct&&ct.__esModule&&Object.prototype.hasOwnProperty.call(ct,"default")?ct.default:ct}function Tt(ct){throw new Error('Could not dynamically require "'+ct+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Lt={exports:{}};(function(ct,lt){(function(p){ct.exports=p()})(function(){return function p(L,v,a){function c(r,o){if(!v[r]){if(!L[r]){var s=typeof Tt=="function"&&Tt;if(!o&&s)return s(r,!0);if(g)return g(r,!0);var t=new Error("Cannot find module '"+r+"'");throw t.code="MODULE_NOT_FOUND",t}var e=v[r]={exports:{}};L[r][0].call(e.exports,function(i){return c(L[r][1][i]||i)},e,e.exports,p,L,v,a)}return v[r].exports}for(var g=typeof Tt=="function"&&Tt,u=0;u<a.length;u++)c(a[u]);return c}({1:[function(p,L,v){var a=this&&this.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(v,"__esModule",{value:!0}),v.TypedEventEmitter=void 0;const c=a(p("events")),g=p("./shared");class u{}v.TypedEventEmitter=u,(0,g.applyMixin)(u,c.default)},{"./shared":17,events:49}],2:[function(p,L,v){(function(a,c){(function(){var g=this&&this.__createBinding||(Object.create?function(D,d,T,A){A===void 0&&(A=T);var G=Object.getOwnPropertyDescriptor(d,T);G&&!("get"in G?!d.__esModule:G.writable||G.configurable)||(G={enumerable:!0,get:function(){return d[T]}}),Object.defineProperty(D,A,G)}:function(D,d,T,A){A===void 0&&(A=T),D[A]=d[T]}),u=this&&this.__setModuleDefault||(Object.create?function(D,d){Object.defineProperty(D,"default",{enumerable:!0,value:d})}:function(D,d){D.default=d}),r=this&&this.__importStar||function(D){if(D&&D.__esModule)return D;var d={};if(D!=null)for(var T in D)T!=="default"&&Object.prototype.hasOwnProperty.call(D,T)&&g(d,D,T);return u(d,D),d},o=this&&this.__importDefault||function(D){return D&&D.__esModule?D:{default:D}};Object.defineProperty(v,"__esModule",{value:!0});const s=o(p("./topic-alias-recv")),t=o(p("mqtt-packet")),e=o(p("./default-message-id-provider")),i=p("readable-stream"),f=o(p("reinterval")),h=o(p("rfdc/default")),m=r(p("./validations")),y=o(p("debug")),E=o(p("./store")),P=o(p("./handlers")),M=p("./TypedEmitter"),k=a?a.nextTick:D=>{setTimeout(D,0)},w=c.setImmediate||((...D)=>{const d=D.shift();k(()=>{d(...D)})}),_={keepalive:60,reschedulePings:!0,protocolId:"MQTT",protocolVersion:4,reconnectPeriod:1e3,connectTimeout:3e4,clean:!0,resubscribe:!0,writeCache:!0},x=["ECONNREFUSED","EADDRINUSE","ECONNRESET","ENOTFOUND","ETIMEDOUT"];class V extends M.TypedEventEmitter{static defaultId(){return`mqttjs_${Math.random().toString(16).substr(2,8)}`}constructor(d,T){super(),this.options=T||{};for(const A in _)this.options[A]===void 0?this.options[A]=_[A]:this.options[A]=T[A];this.log=this.options.log||(0,y.default)("mqttjs:client"),this.noop=this._noop.bind(this),this.log("MqttClient :: options.protocol",T.protocol),this.log("MqttClient :: options.protocolVersion",T.protocolVersion),this.log("MqttClient :: options.username",T.username),this.log("MqttClient :: options.keepalive",T.keepalive),this.log("MqttClient :: options.reconnectPeriod",T.reconnectPeriod),this.log("MqttClient :: options.rejectUnauthorized",T.rejectUnauthorized),this.log("MqttClient :: options.properties.topicAliasMaximum",T.properties?T.properties.topicAliasMaximum:void 0),this.options.clientId=typeof T.clientId=="string"?T.clientId:V.defaultId(),this.log("MqttClient :: clientId",this.options.clientId),this.options.customHandleAcks=T.protocolVersion===5&&T.customHandleAcks?T.customHandleAcks:(...A)=>{A[3](null,0)},this.options.writeCache||(t.default.writeToStream.cacheNumbers=!1),this.streamBuilder=d,this.messageIdProvider=this.options.messageIdProvider===void 0?new e.default:this.options.messageIdProvider,this.outgoingStore=T.outgoingStore||new E.default,this.incomingStore=T.incomingStore||new E.default,this.queueQoSZero=T.queueQoSZero===void 0||T.queueQoSZero,this._resubscribeTopics={},this.messageIdToTopic={},this.pingTimer=null,this.connected=!1,this.disconnecting=!1,this.reconnecting=!1,this.queue=[],this.connackTimer=null,this.reconnectTimer=null,this._storeProcessing=!1,this._packetIdsDuringStoreProcessing={},this._storeProcessingQueue=[],this.outgoing={},this._firstConnection=!0,T.properties&&T.properties.topicAliasMaximum>0&&(T.properties.topicAliasMaximum>65535?this.log("MqttClient :: options.properties.topicAliasMaximum is out of range"):this.topicAliasRecv=new s.default(T.properties.topicAliasMaximum)),this.on("connect",()=>{const{queue:A}=this,G=()=>{const Q=A.shift();this.log("deliver :: entry %o",Q);let X=null;if(!Q)return void this._resubscribe();X=Q.packet,this.log("deliver :: call _sendPacket for %o",X);let O=!0;X.messageId&&X.messageId!==0&&(this.messageIdProvider.register(X.messageId)||(O=!1)),O?this._sendPacket(X,S=>{Q.cb&&Q.cb(S),G()}):(this.log("messageId: %d has already used. The message is skipped and removed.",X.messageId),G())};this.log("connect :: sending queued packets"),G()}),this.on("close",()=>{this.log("close :: connected set to `false`"),this.connected=!1,this.log("close :: clearing connackTimer"),clearTimeout(this.connackTimer),this.log("close :: clearing ping timer"),this.pingTimer!==null&&(this.pingTimer.clear(),this.pingTimer=null),this.topicAliasRecv&&this.topicAliasRecv.clear(),this.log("close :: calling _setupReconnect"),this._setupReconnect()}),this.options.manualConnect||(this.log("MqttClient :: setting up stream"),this.connect())}handleAuth(d,T){T()}handleMessage(d,T){T()}_nextId(){return this.messageIdProvider.allocate()}getLastMessageId(){return this.messageIdProvider.getLastAllocated()}connect(){var d;const T=new i.Writable,A=t.default.parser(this.options);let G=null;const Q=[];this.log("connect :: calling method to clear reconnect"),this._clearReconnect(),this.log("connect :: using streamBuilder provided to client to create stream"),this.stream=this.streamBuilder(this),A.on("packet",C=>{this.log("parser :: on packet push to packets array."),Q.push(C)});const X=()=>{this.log("work :: getting next packet in queue");const C=Q.shift();if(C)this.log("work :: packet pulled from queue"),(0,P.default)(this,C,O);else{this.log("work :: no packets in queue");const $=G;G=null,this.log("work :: done flag is %s",!!$),$&&$()}},O=()=>{if(Q.length)k(X);else{const C=G;G=null,C()}};T._write=(C,$,B)=>{G=B,this.log("writable stream :: parsing buffer"),A.parse(C),X()},this.log("connect :: pipe stream to writable stream"),this.stream.pipe(T),this.stream.on("error",C=>{this.log("streamErrorHandler :: error",C.message),x.includes(C.code)?(this.log("streamErrorHandler :: emitting error"),this.emit("error",C)):this.noop(C)}),this.stream.on("close",()=>{this.log("(%s)stream :: on close",this.options.clientId),this._flushVolatile(),this.log("stream: emit close to MqttClient"),this.emit("close")}),this.log("connect: sending packet `connect`");const S={cmd:"connect",protocolId:this.options.protocolId,protocolVersion:this.options.protocolVersion,clean:this.options.clean,clientId:this.options.clientId,keepalive:this.options.keepalive,username:this.options.username,password:this.options.password,properties:this.options.properties};if(this.options.will&&(S.will=Object.assign(Object.assign({},this.options.will),{payload:(d=this.options.will)===null||d===void 0?void 0:d.payload})),this.topicAliasRecv&&(S.properties||(S.properties={}),this.topicAliasRecv&&(S.properties.topicAliasMaximum=this.topicAliasRecv.max)),this._writePacket(S),A.on("error",this.emit.bind(this,"error")),this.options.properties){if(!this.options.properties.authenticationMethod&&this.options.properties.authenticationData)return this.end(()=>this.emit("error",new Error("Packet has no Authentication Method"))),this;if(this.options.properties.authenticationMethod&&this.options.authPacket&&typeof this.options.authPacket=="object"){const C=Object.assign({cmd:"auth",reasonCode:0},this.options.authPacket);this._writePacket(C)}}return this.stream.setMaxListeners(1e3),clearTimeout(this.connackTimer),this.connackTimer=setTimeout(()=>{this.log("!!connectTimeout hit!! Calling _cleanUp with force `true`"),this._cleanUp(!0)},this.options.connectTimeout),this}publish(d,T,A,G){this.log("publish :: message `%s` to topic `%s`",T,d);const{options:Q}=this;typeof A=="function"&&(G=A,A=null),A=A||{},A=Object.assign(Object.assign({},{qos:0,retain:!1,dup:!1}),A);const{qos:X,retain:O,dup:S,properties:C,cbStorePut:$}=A;if(this._checkDisconnecting(G))return this;const B=()=>{let H=0;if((X===1||X===2)&&(H=this._nextId(),H===null))return this.log("No messageId left"),!1;const F={cmd:"publish",topic:d,payload:T,qos:X,retain:O,messageId:H,dup:S};switch(Q.protocolVersion===5&&(F.properties=C),this.log("publish :: qos",X),X){case 1:case 2:this.outgoing[F.messageId]={volatile:!1,cb:G||this.noop},this.log("MqttClient:publish: packet cmd: %s",F.cmd),this._sendPacket(F,void 0,$);break;default:this.log("MqttClient:publish: packet cmd: %s",F.cmd),this._sendPacket(F,G,$)}return!0};return(this._storeProcessing||this._storeProcessingQueue.length>0||!B())&&this._storeProcessingQueue.push({invoke:B,cbStorePut:A.cbStorePut,callback:G}),this}publishAsync(d,T,A){return new Promise((G,Q)=>{this.publish(d,T,A,(X,O)=>{X?Q(X):G(O)})})}subscribe(d,T,A){const G=this.options.protocolVersion;typeof T=="function"&&(A=T),A=A||this.noop;let Q=!1,X=[];typeof d=="string"?X=d=[d]:Array.isArray(d)?X=d:typeof d=="object"&&(Q=d.resubscribe,delete d.resubscribe,X=Object.keys(d));const O=m.validateTopics(X);if(O!==null)return w(A,new Error(`Invalid topic ${O}`)),this;if(this._checkDisconnecting(A))return this.log("subscribe: discconecting true"),this;const S={qos:0};G===5&&(S.nl=!1,S.rap=!1,S.rh=0);const C=(T=Object.assign(Object.assign({},S),T)).properties,$=[],B=(F,W)=>{if(W=W||T,!Object.prototype.hasOwnProperty.call(this._resubscribeTopics,F)||this._resubscribeTopics[F].qos<W.qos||Q){const J={topic:F,qos:W.qos};G===5&&(J.nl=W.nl,J.rap=W.rap,J.rh=W.rh,J.properties=C),this.log("subscribe: pushing topic `%s` and qos `%s` to subs list",J.topic,J.qos),$.push(J)}};if(Array.isArray(d)?d.forEach(F=>{this.log("subscribe: array topic %s",F),B(F)}):Object.keys(d).forEach(F=>{this.log("subscribe: object topic %s, %o",F,d[F]),B(F,d[F])}),!$.length)return A(null,[]),this;const H=()=>{const F=this._nextId();if(F===null)return this.log("No messageId left"),!1;const W={cmd:"subscribe",subscriptions:$,messageId:F};if(C&&(W.properties=C),this.options.resubscribe){this.log("subscribe :: resubscribe true");const J=[];$.forEach(Y=>{if(this.options.reconnectPeriod>0){const Z={qos:Y.qos};G===5&&(Z.nl=Y.nl||!1,Z.rap=Y.rap||!1,Z.rh=Y.rh||0,Z.properties=Y.properties),this._resubscribeTopics[Y.topic]=Z,J.push(Y.topic)}}),this.messageIdToTopic[W.messageId]=J}return this.outgoing[W.messageId]={volatile:!0,cb(J,Y){if(!J){const{granted:Z}=Y;for(let I=0;I<Z.length;I+=1)$[I].qos=Z[I]}A(J,$)}},this.log("subscribe :: call _sendPacket"),this._sendPacket(W),!0};return(this._storeProcessing||this._storeProcessingQueue.length>0||!H())&&this._storeProcessingQueue.push({invoke:H,callback:A}),this}subscribeAsync(d,T){return new Promise((A,G)=>{this.subscribe(d,T,(Q,X)=>{Q?G(Q):A(X)})})}unsubscribe(d,T,A){typeof d=="string"&&(d=[d]),typeof T=="function"&&(A=T),A=A||this.noop;const G=m.validateTopics(d);if(G!==null)return w(A,new Error(`Invalid topic ${G}`)),this;if(this._checkDisconnecting(A))return this;const Q=()=>{const X=this._nextId();if(X===null)return this.log("No messageId left"),!1;const O={cmd:"unsubscribe",messageId:X,unsubscriptions:[]};return typeof d=="string"?O.unsubscriptions=[d]:Array.isArray(d)&&(O.unsubscriptions=d),this.options.resubscribe&&O.unsubscriptions.forEach(S=>{delete this._resubscribeTopics[S]}),typeof T=="object"&&T.properties&&(O.properties=T.properties),this.outgoing[O.messageId]={volatile:!0,cb:A},this.log("unsubscribe: call _sendPacket"),this._sendPacket(O),!0};return(this._storeProcessing||this._storeProcessingQueue.length>0||!Q())&&this._storeProcessingQueue.push({invoke:Q,callback:A}),this}unsubscribeAsync(d,T){return new Promise((A,G)=>{this.unsubscribe(d,T,(Q,X)=>{Q?G(Q):A(X)})})}end(d,T,A){this.log("end :: (%s)",this.options.clientId),d!=null&&typeof d=="boolean"||(A=A||T,T=d,d=!1),typeof T!="object"&&(A=A||T,T=null),this.log("end :: cb? %s",!!A),A&&typeof A=="function"||(A=this.noop);const G=()=>{this.log("end :: closeStores: closing incoming and outgoing stores"),this.disconnected=!0,this.incomingStore.close(X=>{this.outgoingStore.close(O=>{if(this.log("end :: closeStores: emitting end"),this.emit("end"),A){const S=X||O;this.log("end :: closeStores: invoking callback with args"),A(S)}})}),this._deferredReconnect&&this._deferredReconnect()},Q=()=>{this.log("end :: (%s) :: finish :: calling _cleanUp with force %s",this.options.clientId,d),this._cleanUp(d,()=>{this.log("end :: finish :: calling process.nextTick on closeStores"),k(G)},T)};return this.disconnecting?(A(),this):(this._clearReconnect(),this.disconnecting=!0,!d&&Object.keys(this.outgoing).length>0?(this.log("end :: (%s) :: calling finish in 10ms once outgoing is empty",this.options.clientId),this.once("outgoingEmpty",setTimeout.bind(null,Q,10))):(this.log("end :: (%s) :: immediately calling finish",this.options.clientId),Q()),this)}endAsync(d,T){return new Promise((A,G)=>{this.end(d,T,Q=>{Q?G(Q):A()})})}removeOutgoingMessage(d){if(this.outgoing[d]){const{cb:T}=this.outgoing[d];this._removeOutgoingAndStoreMessage(d,()=>{T(new Error("Message removed"))})}return this}reconnect(d){this.log("client reconnect");const T=()=>{d?(this.options.incomingStore=d.incomingStore,this.options.outgoingStore=d.outgoingStore):(this.options.incomingStore=null,this.options.outgoingStore=null),this.incomingStore=this.options.incomingStore||new E.default,this.outgoingStore=this.options.outgoingStore||new E.default,this.disconnecting=!1,this.disconnected=!1,this._deferredReconnect=null,this._reconnect()};return this.disconnecting&&!this.disconnected?this._deferredReconnect=T:T(),this}_flushVolatile(){this.outgoing&&(this.log("_flushVolatile :: deleting volatile messages from the queue and setting their callbacks as error function"),Object.keys(this.outgoing).forEach(d=>{this.outgoing[d].volatile&&typeof this.outgoing[d].cb=="function"&&(this.outgoing[d].cb(new Error("Connection closed")),delete this.outgoing[d])}))}_flush(){this.outgoing&&(this.log("_flush: queue exists? %b",!!this.outgoing),Object.keys(this.outgoing).forEach(d=>{typeof this.outgoing[d].cb=="function"&&(this.outgoing[d].cb(new Error("Connection closed")),delete this.outgoing[d])}))}_removeTopicAliasAndRecoverTopicName(d){let T;d.properties&&(T=d.properties.topicAlias);let A=d.topic.toString();if(this.log("_removeTopicAliasAndRecoverTopicName :: alias %d, topic %o",T,A),A.length===0){if(T===void 0)return new Error("Unregistered Topic Alias");if(A=this.topicAliasSend.getTopicByAlias(T),A===void 0)return new Error("Unregistered Topic Alias");d.topic=A}T&&delete d.properties.topicAlias}_checkDisconnecting(d){return this.disconnecting&&(d&&d!==this.noop?d(new Error("client disconnecting")):this.emit("error",new Error("client disconnecting"))),this.disconnecting}_reconnect(){this.log("_reconnect: emitting reconnect to client"),this.emit("reconnect"),this.connected?(this.end(()=>{this.connect()}),this.log("client already connected. disconnecting first.")):(this.log("_reconnect: calling connect"),this.connect())}_setupReconnect(){!this.disconnecting&&!this.reconnectTimer&&this.options.reconnectPeriod>0?(this.reconnecting||(this.log("_setupReconnect :: emit `offline` state"),this.emit("offline"),this.log("_setupReconnect :: set `reconnecting` to `true`"),this.reconnecting=!0),this.log("_setupReconnect :: setting reconnectTimer for %d ms",this.options.reconnectPeriod),this.reconnectTimer=setInterval(()=>{this.log("reconnectTimer :: reconnect triggered!"),this._reconnect()},this.options.reconnectPeriod)):this.log("_setupReconnect :: doing nothing...")}_clearReconnect(){this.log("_clearReconnect : clearing reconnect timer"),this.reconnectTimer&&(clearInterval(this.reconnectTimer),this.reconnectTimer=null)}_cleanUp(d,T,A={}){if(T&&(this.log("_cleanUp :: done callback provided for on stream close"),this.stream.on("close",T)),this.log("_cleanUp :: forced? %s",d),d)this.options.reconnectPeriod===0&&this.options.clean&&this._flush(),this.log("_cleanUp :: (%s) :: destroying stream",this.options.clientId),this.stream.destroy();else{const G=Object.assign({cmd:"disconnect"},A);this.log("_cleanUp :: (%s) :: call _sendPacket with disconnect packet",this.options.clientId),this._sendPacket(G,()=>{this.log("_cleanUp :: (%s) :: destroying stream",this.options.clientId),w(()=>{this.stream.end(()=>{this.log("_cleanUp :: (%s) :: stream destroyed",this.options.clientId)})})})}this.disconnecting||(this.log("_cleanUp :: client not disconnecting. Clearing and resetting reconnect."),this._clearReconnect(),this._setupReconnect()),this.pingTimer!==null&&(this.log("_cleanUp :: clearing pingTimer"),this.pingTimer.clear(),this.pingTimer=null),T&&!this.connected&&(this.log("_cleanUp :: (%s) :: removing stream `done` callback `close` listener",this.options.clientId),this.stream.removeListener("close",T),T())}_storeAndSend(d,T,A){this.log("storeAndSend :: store packet with cmd %s to outgoingStore",d.cmd);let G,Q=d;if(Q.cmd==="publish"&&(Q=(0,h.default)(d),G=this._removeTopicAliasAndRecoverTopicName(Q),G))return T&&T(G);this.outgoingStore.put(Q,X=>{if(X)return T&&T(X);A(),this._writePacket(d,T)})}_applyTopicAlias(d){if(this.options.protocolVersion===5&&d.cmd==="publish"){let T;d.properties&&(T=d.properties.topicAlias);const A=d.topic.toString();if(this.topicAliasSend)if(T){if(A.length!==0&&(this.log("applyTopicAlias :: register topic: %s - alias: %d",A,T),!this.topicAliasSend.put(A,T)))return this.log("applyTopicAlias :: error out of range. topic: %s - alias: %d",A,T),new Error("Sending Topic Alias out of range")}else A.length!==0&&(this.options.autoAssignTopicAlias?(T=this.topicAliasSend.getAliasByTopic(A),T?(d.topic="",d.properties=Object.assign(Object.assign({},d.properties),{topicAlias:T}),this.log("applyTopicAlias :: auto assign(use) topic: %s - alias: %d",A,T)):(T=this.topicAliasSend.getLruAlias(),this.topicAliasSend.put(A,T),d.properties=Object.assign(Object.assign({},d.properties),{topicAlias:T}),this.log("applyTopicAlias :: auto assign topic: %s - alias: %d",A,T))):this.options.autoUseTopicAlias&&(T=this.topicAliasSend.getAliasByTopic(A),T&&(d.topic="",d.properties=Object.assign(Object.assign({},d.properties),{topicAlias:T}),this.log("applyTopicAlias :: auto use topic: %s - alias: %d",A,T))));else if(T)return this.log("applyTopicAlias :: error out of range. topic: %s - alias: %d",A,T),new Error("Sending Topic Alias out of range")}}_noop(d){this.log("noop ::",d)}_writePacket(d,T){this.log("_writePacket :: packet: %O",d),this.log("_writePacket :: emitting `packetsend`"),this.emit("packetsend",d),this._shiftPingInterval(),this.log("_writePacket :: writing to stream");const A=t.default.writeToStream(d,this.stream,this.options);this.log("_writePacket :: writeToStream result %s",A),!A&&T&&T!==this.noop?(this.log("_writePacket :: handle events on `drain` once through callback."),this.stream.once("drain",T)):T&&(this.log("_writePacket :: invoking cb"),T())}_sendPacket(d,T,A,G){this.log("_sendPacket :: (%s) ::  start",this.options.clientId),A=A||this.noop,T=T||this.noop;const Q=this._applyTopicAlias(d);if(Q)T(Q);else{if(!this.connected)return d.cmd==="auth"?void this._writePacket(d,T):(this.log("_sendPacket :: client not connected. Storing packet offline."),void this._storePacket(d,T,A));if(G)this._writePacket(d,T);else{switch(d.cmd){case"publish":break;case"pubrel":return void this._storeAndSend(d,T,A);default:return void this._writePacket(d,T)}switch(d.qos){case 2:case 1:this._storeAndSend(d,T,A);break;default:this._writePacket(d,T)}this.log("_sendPacket :: (%s) ::  end",this.options.clientId)}}}_storePacket(d,T,A){this.log("_storePacket :: packet: %o",d),this.log("_storePacket :: cb? %s",!!T),A=A||this.noop;let G=d;if(G.cmd==="publish"){G=(0,h.default)(d);const X=this._removeTopicAliasAndRecoverTopicName(G);if(X)return T&&T(X)}const Q=G.qos||0;Q===0&&this.queueQoSZero||G.cmd!=="publish"?this.queue.push({packet:G,cb:T}):Q>0?(T=this.outgoing[G.messageId]?this.outgoing[G.messageId].cb:null,this.outgoingStore.put(G,X=>{if(X)return T&&T(X);A()})):T&&T(new Error("No connection to broker"))}_setupPingTimer(){this.log("_setupPingTimer :: keepalive %d (seconds)",this.options.keepalive),!this.pingTimer&&this.options.keepalive&&(this.pingResp=!0,this.pingTimer=(0,f.default)(()=>{this._checkPing()},1e3*this.options.keepalive))}_shiftPingInterval(){this.pingTimer&&this.options.keepalive&&this.options.reschedulePings&&this.pingTimer.reschedule(1e3*this.options.keepalive)}_checkPing(){this.log("_checkPing :: checking ping..."),this.pingResp?(this.log("_checkPing :: ping response received. Clearing flag and sending `pingreq`"),this.pingResp=!1,this._sendPacket({cmd:"pingreq"})):(this.log("_checkPing :: calling _cleanUp with force true"),this._cleanUp(!0))}_resubscribe(){this.log("_resubscribe");const d=Object.keys(this._resubscribeTopics);if(!this._firstConnection&&(this.options.clean||this.options.protocolVersion>=4&&!this.connackPacket.sessionPresent)&&d.length>0)if(this.options.resubscribe)if(this.options.protocolVersion===5){this.log("_resubscribe: protocolVersion 5");for(let T=0;T<d.length;T++){const A={};A[d[T]]=this._resubscribeTopics[d[T]],A.resubscribe=!0,this.subscribe(A,{properties:A[d[T]].properties})}}else this._resubscribeTopics.resubscribe=!0,this.subscribe(this._resubscribeTopics);else this._resubscribeTopics={};this._firstConnection=!1}_onConnect(d){if(this.disconnected)return void this.emit("connect",d);this.connackPacket=d,this.messageIdProvider.clear(),this._setupPingTimer(),this.connected=!0;const T=()=>{let A=this.outgoingStore.createStream();const G=()=>{A.destroy(),A=null,this._flushStoreProcessingQueue(),Q()},Q=()=>{this._storeProcessing=!1,this._packetIdsDuringStoreProcessing={}};this.once("close",G),A.on("error",O=>{Q(),this._flushStoreProcessingQueue(),this.removeListener("close",G),this.emit("error",O)});const X=()=>{if(!A)return;const O=A.read(1);let S;O?(this._storeProcessing=!0,this._packetIdsDuringStoreProcessing[O.messageId]?X():this.disconnecting||this.reconnectTimer?A.destroy&&A.destroy():(S=this.outgoing[O.messageId]?this.outgoing[O.messageId].cb:null,this.outgoing[O.messageId]={volatile:!1,cb(C,$){S&&S(C,$),X()}},this._packetIdsDuringStoreProcessing[O.messageId]=!0,this.messageIdProvider.register(O.messageId)?this._sendPacket(O,void 0,void 0,!0):this.log("messageId: %d has already used.",O.messageId))):A.once("readable",X)};A.on("end",()=>{let O=!0;for(const S in this._packetIdsDuringStoreProcessing)if(!this._packetIdsDuringStoreProcessing[S]){O=!1;break}O?(Q(),this.removeListener("close",G),this._invokeAllStoreProcessingQueue(),this.emit("connect",d)):T()}),X()};T()}_invokeStoreProcessingQueue(){if(!this._storeProcessing&&this._storeProcessingQueue.length>0){const d=this._storeProcessingQueue[0];if(d&&d.invoke())return this._storeProcessingQueue.shift(),!0}return!1}_invokeAllStoreProcessingQueue(){for(;this._invokeStoreProcessingQueue(););}_flushStoreProcessingQueue(){for(const d of this._storeProcessingQueue)d.cbStorePut&&d.cbStorePut(new Error("Connection closed")),d.callback&&d.callback(new Error("Connection closed"));this._storeProcessingQueue.splice(0)}_removeOutgoingAndStoreMessage(d,T){delete this.outgoing[d],this.outgoingStore.del({messageId:d},(A,G)=>{T(A,G),this.messageIdProvider.deallocate(d),this._invokeStoreProcessingQueue()})}}v.default=V}).call(this)}).call(this,p("_process"),typeof wt<"u"?wt:typeof self<"u"?self:typeof window<"u"?window:{})},{"./TypedEmitter":1,"./default-message-id-provider":9,"./handlers":13,"./store":18,"./topic-alias-recv":19,"./validations":22,_process:102,debug:30,"mqtt-packet":75,"readable-stream":125,reinterval:131,"rfdc/default":132}],3:[function(p,L,v){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(v,"__esModule",{value:!0});const c=p("buffer"),g=p("readable-stream"),u=a(p("duplexify"));let r,o,s,t=!1;v.default=(e,i)=>{if(i.hostname=i.hostname||i.host,!i.hostname)throw new Error("Could not determine host. Specify host manually.");const f=i.protocolId==="MQIsdp"&&i.protocolVersion===3?"mqttv3.1":"mqtt";(function(m){m.hostname||(m.hostname="localhost"),m.path||(m.path="/"),m.wsOptions||(m.wsOptions={})})(i);const h=function(m,y){const E=m.protocol==="alis"?"wss":"ws";let P=`${E}://${m.hostname}${m.path}`;return m.port&&m.port!==80&&m.port!==443&&(P=`${E}://${m.hostname}:${m.port}${m.path}`),typeof m.transformWsUrl=="function"&&(P=m.transformWsUrl(P,m,y)),P}(i,e);return r=i.my,r.connectSocket({url:h,protocols:f}),o=function(){const m=new g.Transform;return m._write=(y,E,P)=>{r.sendSocketMessage({data:y.buffer,success(){P()},fail(){P(new Error)}})},m._flush=y=>{r.closeSocket({success(){y()}})},m}(),s=u.default.obj(),t||(t=!0,r.onSocketOpen(()=>{s.setReadable(o),s.setWritable(o),s.emit("connect")}),r.onSocketMessage(m=>{if(typeof m.data=="string"){const y=c.Buffer.from(m.data,"base64");o.push(y)}else{const y=new FileReader;y.addEventListener("load",()=>{let E=y.result;E=E instanceof ArrayBuffer?c.Buffer.from(E):c.Buffer.from(E,"utf8"),o.push(E)}),y.readAsArrayBuffer(m.data)}}),r.onSocketClose(()=>{s.end(),s.destroy()}),r.onSocketError(m=>{s.destroy(m)})),s}},{buffer:29,duplexify:32,"readable-stream":125}],4:[function(p,L,v){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(v,"__esModule",{value:!0}),v.connectAsync=void 0;const c=a(p("debug")),g=a(p("url")),u=a(p("../client")),r=a(p("../is-browser")),o=(0,c.default)("mqttjs"),s={};function t(e,i){if(o("connecting to an MQTT broker..."),typeof e!="object"||i||(i=e,e=""),i=i||{},e&&typeof e=="string"){const h=g.default.parse(e,!0);if(h.port!=null&&(h.port=Number(h.port)),(i=Object.assign(Object.assign({},h),i)).protocol===null)throw new Error("Missing protocol");i.protocol=i.protocol.replace(/:$/,"")}if(function(h){let m;h.auth&&(m=h.auth.match(/^(.+):(.+)$/),m?(h.username=m[1],h.password=m[2]):h.username=h.auth)}(i),i.query&&typeof i.query.clientId=="string"&&(i.clientId=i.query.clientId),i.cert&&i.key){if(!i.protocol)throw new Error("Missing secure protocol key");if(["mqtts","wss","wxs","alis"].indexOf(i.protocol)===-1)switch(i.protocol){case"mqtt":i.protocol="mqtts";break;case"ws":i.protocol="wss";break;case"wx":i.protocol="wxs";break;case"ali":i.protocol="alis";break;default:throw new Error(`Unknown protocol for secure connection: "${i.protocol}"!`)}}if(!s[i.protocol]){const h=["mqtts","wss"].indexOf(i.protocol)!==-1;i.protocol=["mqtt","mqtts","ws","wss","wx","wxs","ali","alis"].filter((m,y)=>(!h||y%2!=0)&&typeof s[m]=="function")[0]}if(i.clean===!1&&!i.clientId)throw new Error("Missing clientId for unclean clients");i.protocol&&(i.defaultProtocol=i.protocol);const f=new u.default(function(h){return i.servers&&(h._reconnectCount&&h._reconnectCount!==i.servers.length||(h._reconnectCount=0),i.host=i.servers[h._reconnectCount].host,i.port=i.servers[h._reconnectCount].port,i.protocol=i.servers[h._reconnectCount].protocol?i.servers[h._reconnectCount].protocol:i.defaultProtocol,i.hostname=i.host,h._reconnectCount++),o("calling streambuilder for",i.protocol),s[i.protocol](h,i)},i);return f.on("error",()=>{}),f}r.default?(s.wx=p("./wx").default,s.wxs=p("./wx").default,s.ali=p("./ali").default,s.alis=p("./ali").default):(s.mqtt=p("./tcp").default,s.tcp=p("./tcp").default,s.ssl=p("./tls").default,s.tls=s.ssl,s.mqtts=p("./tls").default),s.ws=p("./ws").default,s.wss=p("./ws").default,v.connectAsync=function(e,i,f=!0){return new Promise((h,m)=>{const y=t(e,i),E={connect:M=>{P(),h(y)},end:()=>{P(),h(y)},error:M=>{P(),y.end(),m(M)}};function P(){Object.keys(E).forEach(M=>{y.off(M,E[M])})}f===!1&&(E.close=()=>{E.error(new Error("Couldn't connect to server"))}),Object.keys(E).forEach(M=>{y.on(M,E[M])})})},v.default=t},{"../client":2,"../is-browser":16,"./ali":3,"./tcp":5,"./tls":6,"./ws":7,"./wx":8,debug:30,url:137}],5:[function(p,L,v){var a=this&&this.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(v,"__esModule",{value:!0});const c=a(p("net")),g=(0,a(p("debug")).default)("mqttjs:tcp");v.default=(u,r)=>{r.port=r.port||1883,r.hostname=r.hostname||r.host||"localhost";const{port:o}=r,s=r.hostname;return g("port %d and host %s",o,s),c.default.createConnection(o,s)}},{debug:30,net:26}],6:[function(p,L,v){var a=this&&this.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(v,"__esModule",{value:!0});const c=a(p("tls")),g=a(p("net")),u=(0,a(p("debug")).default)("mqttjs:tls");v.default=(r,o)=>{o.port=o.port||8883,o.host=o.hostname||o.host||"localhost",g.default.isIP(o.host)===0&&(o.servername=o.host),o.rejectUnauthorized=o.rejectUnauthorized!==!1,delete o.path,u("port %d host %s rejectUnauthorized %b",o.port,o.host,o.rejectUnauthorized);const s=c.default.connect(o);function t(e){o.rejectUnauthorized&&r.emit("error",e),s.end()}return s.on("secureConnect",()=>{o.rejectUnauthorized&&!s.authorized?s.emit("error",new Error("TLS not authorized")):s.removeListener("error",t)}),s.on("error",t),s}},{debug:30,net:26,tls:26}],7:[function(p,L,v){var a=this&&this.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(v,"__esModule",{value:!0});const c=p("buffer"),g=a(p("ws")),u=a(p("debug")),r=a(p("duplexify")),o=p("readable-stream"),s=a(p("../is-browser")),t=(0,u.default)("mqttjs:ws"),e=["rejectUnauthorized","ca","cert","key","pfx","passphrase"];function i(h,m){let y=`${h.protocol}://${h.hostname}:${h.port}${h.path}`;return typeof h.transformWsUrl=="function"&&(y=h.transformWsUrl(y,h,m)),y}function f(h){const m=h;return h.hostname||(m.hostname="localhost"),h.port||(h.protocol==="wss"?m.port=443:m.port=80),h.path||(m.path="/"),h.wsOptions||(m.wsOptions={}),s.default||h.protocol!=="wss"||e.forEach(y=>{Object.prototype.hasOwnProperty.call(h,y)&&!Object.prototype.hasOwnProperty.call(h.wsOptions,y)&&(m.wsOptions[y]=h[y])}),m}v.default=s.default?(h,m)=>{let y;t("browserStreamBuilder");const E=function(G){const Q=f(G);if(Q.hostname||(Q.hostname=Q.host),!Q.hostname){if(typeof document>"u")throw new Error("Could not determine host. Specify host manually.");const X=new URL(document.URL);Q.hostname=X.hostname,Q.port||(Q.port=Number(X.port))}return Q.objectMode===void 0&&(Q.objectMode=!(Q.binary===!0||Q.binary===void 0)),Q}(m),P=E.browserBufferSize||524288,M=m.browserBufferTimeout||1e3,k=!m.objectMode,w=function(G,Q){const X=Q.protocolId==="MQIsdp"&&Q.protocolVersion===3?"mqttv3.1":"mqtt",O=i(Q,G);let S;return S=Q.createWebsocket?Q.createWebsocket(O,[X],Q):new WebSocket(O,[X]),S.binaryType="arraybuffer",S}(h,m),_=function(G,Q,X){const O=new o.Transform({objectMode:G.objectMode});return O._write=Q,O._flush=X,O}(m,function G(Q,X,O){w.bufferedAmount>P&&setTimeout(G,M,Q,X,O),k&&typeof Q=="string"&&(Q=c.Buffer.from(Q,"utf8"));try{w.send(Q)}catch(S){return O(S)}O()},function(G){w.close(),G()});m.objectMode||(_._writev=A),_.on("close",()=>{w.close()});const x=w.addEventListener!==void 0;function V(){y.setReadable(_),y.setWritable(_),y.emit("connect")}function D(){y.end(),y.destroy()}function d(G){y.destroy(G)}function T(G){let{data:Q}=G;Q=Q instanceof ArrayBuffer?c.Buffer.from(Q):c.Buffer.from(Q,"utf8"),_.push(Q)}function A(G,Q){const X=new Array(G.length);for(let O=0;O<G.length;O++)typeof G[O].chunk=="string"?X[O]=c.Buffer.from(G[O],"utf8"):X[O]=G[O].chunk;this._write(c.Buffer.concat(X),"binary",Q)}return w.readyState===w.OPEN?y=_:(y=(0,r.default)(void 0,void 0,m),m.objectMode||(y._writev=A),x?w.addEventListener("open",V):w.onopen=V),y.socket=w,x?(w.addEventListener("close",D),w.addEventListener("error",d),w.addEventListener("message",T)):(w.onclose=D,w.onerror=d,w.onmessage=T),y}:(h,m)=>{t("streamBuilder");const y=f(m),E=i(y,h),P=function(k,w,_){t("createWebSocket"),t(`protocol: ${_.protocolId} ${_.protocolVersion}`);const x=_.protocolId==="MQIsdp"&&_.protocolVersion===3?"mqttv3.1":"mqtt";let V;return t(`creating new Websocket for url: ${w} and protocol: ${x}`),V=_.createWebsocket?_.createWebsocket(w,[x],_):new g.default(w,[x],_.wsOptions),V}(0,E,y),M=g.default.createWebSocketStream(P,y.wsOptions);return M.url=E,P.on("close",()=>{M.destroy()}),M}},{"../is-browser":16,buffer:29,debug:30,duplexify:32,"readable-stream":125,ws:141}],8:[function(p,L,v){var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(v,"__esModule",{value:!0});const c=p("buffer"),g=p("readable-stream"),u=a(p("duplexify"));let r,o,s;v.default=(t,e)=>{if(e.hostname=e.hostname||e.host,!e.hostname)throw new Error("Could not determine host. Specify host manually.");const i=e.protocolId==="MQIsdp"&&e.protocolVersion===3?"mqttv3.1":"mqtt";(function(m){m.hostname||(m.hostname="localhost"),m.path||(m.path="/"),m.wsOptions||(m.wsOptions={})})(e);const f=function(m,y){const E=m.protocol==="wxs"?"wss":"ws";let P=`${E}://${m.hostname}${m.path}`;return m.port&&m.port!==80&&m.port!==443&&(P=`${E}://${m.hostname}:${m.port}${m.path}`),typeof m.transformWsUrl=="function"&&(P=m.transformWsUrl(P,m,y)),P}(e,t);r=wx.connectSocket({url:f,protocols:[i]}),o=function(){const m=new g.Transform;return m._write=(y,E,P)=>{r.send({data:y.buffer,success(){P()},fail(M){P(new Error(M))}})},m._flush=y=>{r.close({success(){y()}})},m}(),s=u.default.obj(),s._destroy=(m,y)=>{r.close({success(){y&&y(m)}})};const h=s.destroy;return s.destroy=()=>{s.destroy=h,setTimeout(()=>{r.close({fail(){s._destroy(new Error)}})},0)},r.onOpen(()=>{s.setReadable(o),s.setWritable(o),s.emit("connect")}),r.onMessage(m=>{let{data:y}=m;y=y instanceof ArrayBuffer?c.Buffer.from(y):c.Buffer.from(y,"utf8"),o.push(y)}),r.onClose(()=>{s.emit("close"),s.end(),s.destroy()}),r.onError(m=>{s.destroy(new Error(m.errMsg))}),s}},{buffer:29,duplexify:32,"readable-stream":125}],9:[function(p,L,v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=class{constructor(){this.nextId=Math.max(1,Math.floor(65535*Math.random()))}allocate(){const a=this.nextId++;return this.nextId===65536&&(this.nextId=1),a}getLastAllocated(){return this.nextId===1?65535:this.nextId-1}register(a){return!0}deallocate(a){}clear(){}}},{}],10:[function(p,L,v){Object.defineProperty(v,"__esModule",{value:!0}),v.ReasonCodes=void 0,v.ReasonCodes={0:"",1:"Unacceptable protocol version",2:"Identifier rejected",3:"Server unavailable",4:"Bad username or password",5:"Not authorized",16:"No matching subscribers",17:"No subscription existed",128:"Unspecified error",129:"Malformed Packet",130:"Protocol Error",131:"Implementation specific error",132:"Unsupported Protocol Version",133:"Client Identifier not valid",134:"Bad User Name or Password",135:"Not authorized",136:"Server unavailable",137:"Server busy",138:"Banned",139:"Server shutting down",140:"Bad authentication method",141:"Keep Alive timeout",142:"Session taken over",143:"Topic Filter invalid",144:"Topic Name invalid",145:"Packet identifier in use",146:"Packet Identifier not found",147:"Receive Maximum exceeded",148:"Topic Alias invalid",149:"Packet too large",150:"Message rate too high",151:"Quota exceeded",152:"Administrative action",153:"Payload format invalid",154:"Retain not supported",155:"QoS not supported",156:"Use another server",157:"Server moved",158:"Shared Subscriptions not supported",159:"Connection rate exceeded",160:"Maximum connect time",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"},v.default=(a,c)=>{const{messageId:g}=c,u=c.cmd;let r=null;const o=a.outgoing[g]?a.outgoing[g].cb:null;let s;if(o){switch(a.log("_handleAck :: packet type",u),u){case"pubcomp":case"puback":{const t=c.reasonCode;t&&t>0&&t!==16?(s=new Error(`Publish error: ${v.ReasonCodes[t]}`),s.code=t,a._removeOutgoingAndStoreMessage(g,()=>{o(s,c)})):a._removeOutgoingAndStoreMessage(g,o);break}case"pubrec":{r={cmd:"pubrel",qos:2,messageId:g};const t=c.reasonCode;t&&t>0&&t!==16?(s=new Error(`Publish error: ${v.ReasonCodes[t]}`),s.code=t,a._removeOutgoingAndStoreMessage(g,()=>{o(s,c)})):a._sendPacket(r);break}case"suback":{delete a.outgoing[g],a.messageIdProvider.deallocate(g);const t=c.granted;for(let e=0;e<t.length;e++)if(128&t[e]){const i=a.messageIdToTopic[g];i&&i.forEach(f=>{delete a._resubscribeTopics[f]})}delete a.messageIdToTopic[g],a._invokeStoreProcessingQueue(),o(null,c);break}case"unsuback":delete a.outgoing[g],a.messageIdProvider.deallocate(g),a._invokeStoreProcessingQueue(),o(null);break;default:a.emit("error",new Error("unrecognized packet type"))}a.disconnecting&&Object.keys(a.outgoing).length===0&&a.emit("outgoingEmpty")}else a.log("_handleAck :: Server sent an ack in error. Ignoring.")}},{}],11:[function(p,L,v){Object.defineProperty(v,"__esModule",{value:!0});const a=p("../shared"),c=p("./ack");v.default=(g,u)=>{const{options:r}=g,o=r.protocolVersion,s=o===5?u.reasonCode:u.returnCode;if(o===5)g.handleAuth(u,(t,e)=>{if(t)g.emit("error",t);else if(s===24)g.reconnecting=!1,g._sendPacket(e);else{const i=new a.ErrorWithReasonCode(`Connection refused: ${c.ReasonCodes[s]}`,s);g.emit("error",i)}});else{const t=new a.ErrorWithReasonCode(`Protocol error: Auth packets are only supported in MQTT 5. Your version:${o}`,s);g.emit("error",t)}}},{"../shared":17,"./ack":10}],12:[function(p,L,v){var a=this&&this.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(v,"__esModule",{value:!0});const c=p("./ack"),g=a(p("../topic-alias-send")),u=p("../shared");v.default=(r,o)=>{r.log("_handleConnack");const{options:s}=r,t=s.protocolVersion===5?o.reasonCode:o.returnCode;if(clearTimeout(r.connackTimer),delete r.topicAliasSend,o.properties){if(o.properties.topicAliasMaximum){if(o.properties.topicAliasMaximum>65535)return void r.emit("error",new Error("topicAliasMaximum from broker is out of range"));o.properties.topicAliasMaximum>0&&(r.topicAliasSend=new g.default(o.properties.topicAliasMaximum))}o.properties.serverKeepAlive&&s.keepalive&&(s.keepalive=o.properties.serverKeepAlive,r._shiftPingInterval()),o.properties.maximumPacketSize&&(s.properties||(s.properties={}),s.properties.maximumPacketSize=o.properties.maximumPacketSize)}if(t===0)r.reconnecting=!1,r._onConnect(o);else if(t>0){const e=new u.ErrorWithReasonCode(`Connection refused: ${c.ReasonCodes[t]}`,t);r.emit("error",e)}}},{"../shared":17,"../topic-alias-send":20,"./ack":10}],13:[function(p,L,v){var a=this&&this.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(v,"__esModule",{value:!0});const c=a(p("./publish")),g=a(p("./auth")),u=a(p("./connack")),r=a(p("./ack")),o=a(p("./pubrel"));v.default=(s,t,e)=>{const{options:i}=s;if(i.protocolVersion===5&&i.properties&&i.properties.maximumPacketSize&&i.properties.maximumPacketSize<t.length)return s.emit("error",new Error(`exceeding packets size ${t.cmd}`)),s.end({reasonCode:149,properties:{reasonString:"Maximum packet size was exceeded"}}),s;switch(s.log("_handlePacket :: emitting packetreceive"),s.emit("packetreceive",t),t.cmd){case"publish":(0,c.default)(s,t,e);break;case"puback":case"pubrec":case"pubcomp":case"suback":case"unsuback":(0,r.default)(s,t),e();break;case"pubrel":(0,o.default)(s,t,e);break;case"connack":(0,u.default)(s,t),e();break;case"auth":(0,g.default)(s,t),e();break;case"pingresp":s.pingResp=!0,e();break;case"disconnect":s.emit("disconnect",t),e();break;default:s.log("_handlePacket :: unknown command"),e()}}},{"./ack":10,"./auth":11,"./connack":12,"./publish":14,"./pubrel":15}],14:[function(p,L,v){Object.defineProperty(v,"__esModule",{value:!0});const a=[0,16,128,131,135,144,145,151,153];v.default=(c,g,u)=>{c.log("handlePublish: packet %o",g),u=u!==void 0?u:c.noop;let r=g.topic.toString();const o=g.payload,{qos:s}=g,{messageId:t}=g,{options:e}=c;if(c.options.protocolVersion===5){let i;if(g.properties&&(i=g.properties.topicAlias),i!==void 0)if(r.length===0){if(!(i>0&&i<=65535))return c.log("handlePublish :: topic alias out of range. alias: %d",i),void c.emit("error",new Error("Received Topic Alias is out of range"));{const f=c.topicAliasRecv.getTopicByAlias(i);if(!f)return c.log("handlePublish :: unregistered topic alias. alias: %d",i),void c.emit("error",new Error("Received unregistered Topic Alias"));r=f,c.log("handlePublish :: topic complemented by alias. topic: %s - alias: %d",r,i)}}else{if(!c.topicAliasRecv.put(r,i))return c.log("handlePublish :: topic alias out of range. alias: %d",i),void c.emit("error",new Error("Received Topic Alias is out of range"));c.log("handlePublish :: registered topic: %s - alias: %d",r,i)}}switch(c.log("handlePublish: qos %d",s),s){case 2:e.customHandleAcks(r,o,g,(i,f)=>(typeof i=="number"&&(f=i,i=null),i?c.emit("error",i):a.indexOf(f)===-1?c.emit("error",new Error("Wrong reason code for pubrec")):void(f?c._sendPacket({cmd:"pubrec",messageId:t,reasonCode:f},u):c.incomingStore.put(g,()=>{c._sendPacket({cmd:"pubrec",messageId:t},u)}))));break;case 1:e.customHandleAcks(r,o,g,(i,f)=>(typeof i=="number"&&(f=i,i=null),i?c.emit("error",i):a.indexOf(f)===-1?c.emit("error",new Error("Wrong reason code for puback")):(f||c.emit("message",r,o,g),void c.handleMessage(g,h=>{if(h)return u&&u(h);c._sendPacket({cmd:"puback",messageId:t,reasonCode:f},u)}))));break;case 0:c.emit("message",r,o,g),c.handleMessage(g,u);break;default:c.log("handlePublish: unknown QoS. Doing nothing.")}}},{}],15:[function(p,L,v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=(a,c,g)=>{a.log("handling pubrel packet");const u=g!==void 0?g:a.noop,{messageId:r}=c,o={cmd:"pubcomp",messageId:r};a.incomingStore.get(c,(s,t)=>{s?a._sendPacket(o,u):(a.emit("message",t.topic,t.payload,t),a.handleMessage(t,e=>{if(e)return u(e);a.incomingStore.del(t,a.noop),a._sendPacket(o,u)}))})}},{}],16:[function(p,L,v){Object.defineProperty(v,"__esModule",{value:!0});const a=typeof window<"u"&&window.document!==void 0||typeof self<"u"&&typeof self.postMessage=="function";v.default=a},{}],17:[function(p,L,v){Object.defineProperty(v,"__esModule",{value:!0}),v.applyMixin=v.ErrorWithReasonCode=void 0;class a extends Error{constructor(g,u){super(g),this.code=u,Object.setPrototypeOf(this,a.prototype),Object.getPrototypeOf(this).name="ErrorWithReasonCode"}}v.ErrorWithReasonCode=a,v.applyMixin=function(c,g,u=!1){var r;const o=[g];for(;;){const s=o[0],t=Object.getPrototypeOf(s);if(!(t!=null&&t.prototype))break;o.unshift(t)}for(const s of o)for(const t of Object.getOwnPropertyNames(s.prototype))(u||t!=="constructor")&&Object.defineProperty(c.prototype,t,(r=Object.getOwnPropertyDescriptor(s.prototype,t))!==null&&r!==void 0?r:Object.create(null))}},{}],18:[function(p,L,v){Object.defineProperty(v,"__esModule",{value:!0});const a=p("readable-stream"),c={objectMode:!0},g={clean:!0};v.default=class{constructor(u){this.options=u||{},this.options=Object.assign(Object.assign({},g),u),this._inflights=new Map}put(u,r){return this._inflights.set(u.messageId,u),r&&r(),this}createStream(){const u=new a.Readable(c),r=[];let o=!1,s=0;return this._inflights.forEach((t,e)=>{r.push(t)}),u._read=()=>{!o&&s<r.length?u.push(r[s++]):u.push(null)},u.destroy=t=>{if(!o)return o=!0,setTimeout(()=>{u.emit("close")},0),u},u}del(u,r){const o=this._inflights.get(u.messageId);return o?(this._inflights.delete(u.messageId),r(null,o)):r&&r(new Error("missing packet")),this}get(u,r){const o=this._inflights.get(u.messageId);return o?r(null,o):r&&r(new Error("missing packet")),this}close(u){this.options.clean&&(this._inflights=null),u&&u()}}},{"readable-stream":125}],19:[function(p,L,v){Object.defineProperty(v,"__esModule",{value:!0}),v.default=class{constructor(a){this.aliasToTopic={},this.max=a}put(a,c){return!(c===0||c>this.max)&&(this.aliasToTopic[c]=a,this.length=Object.keys(this.aliasToTopic).length,!0)}getTopicByAlias(a){return this.aliasToTopic[a]}clear(){this.aliasToTopic={}}}},{}],20:[function(p,L,v){var a=this&&this.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(v,"__esModule",{value:!0});const c=a(p("lru-cache")),g=p("number-allocator");v.default=class{constructor(u){u>0&&(this.aliasToTopic=new c.default({max:u}),this.topicToAlias={},this.numberAllocator=new g.NumberAllocator(1,u),this.max=u,this.length=0)}put(u,r){if(r===0||r>this.max)return!1;const o=this.aliasToTopic.get(r);return o&&delete this.topicToAlias[o],this.aliasToTopic.set(r,u),this.topicToAlias[u]=r,this.numberAllocator.use(r),this.length=this.aliasToTopic.size,!0}getTopicByAlias(u){return this.aliasToTopic.get(u)}getAliasByTopic(u){const r=this.topicToAlias[u];return r!==void 0&&this.aliasToTopic.get(r),r}clear(){this.aliasToTopic.clear(),this.topicToAlias={},this.numberAllocator.clear(),this.length=0}getLruAlias(){return this.numberAllocator.firstVacant()||[...this.aliasToTopic.keys()][this.aliasToTopic.size-1]}}},{"lru-cache":72,"number-allocator":98}],21:[function(p,L,v){Object.defineProperty(v,"__esModule",{value:!0});const a=p("number-allocator");v.default=class{constructor(){this.numberAllocator=new a.NumberAllocator(1,65535)}allocate(){return this.lastId=this.numberAllocator.alloc(),this.lastId}getLastAllocated(){return this.lastId}register(c){return this.numberAllocator.use(c)}deallocate(c){this.numberAllocator.free(c)}clear(){this.numberAllocator.clear()}}},{"number-allocator":98}],22:[function(p,L,v){function a(c){const g=c.split("/");for(let u=0;u<g.length;u++)if(g[u]!=="+"){if(g[u]==="#")return u===g.length-1;if(g[u].indexOf("+")!==-1||g[u].indexOf("#")!==-1)return!1}return!0}Object.defineProperty(v,"__esModule",{value:!0}),v.validateTopics=v.validateTopic=void 0,v.validateTopic=a,v.validateTopics=function(c){if(c.length===0)return"empty_topic_list";for(let g=0;g<c.length;g++)if(!a(c[g]))return c[g];return null}},{}],23:[function(p,L,v){var a=this&&this.__createBinding||(Object.create?function(h,m,y,E){E===void 0&&(E=y);var P=Object.getOwnPropertyDescriptor(m,y);P&&!("get"in P?!m.__esModule:P.writable||P.configurable)||(P={enumerable:!0,get:function(){return m[y]}}),Object.defineProperty(h,E,P)}:function(h,m,y,E){E===void 0&&(E=y),h[E]=m[y]}),c=this&&this.__setModuleDefault||(Object.create?function(h,m){Object.defineProperty(h,"default",{enumerable:!0,value:m})}:function(h,m){h.default=m}),g=this&&this.__importStar||function(h){if(h&&h.__esModule)return h;var m={};if(h!=null)for(var y in h)y!=="default"&&Object.prototype.hasOwnProperty.call(h,y)&&a(m,h,y);return c(m,h),m},u=this&&this.__exportStar||function(h,m){for(var y in h)y==="default"||Object.prototype.hasOwnProperty.call(m,y)||a(m,h,y)},r=this&&this.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(v,"__esModule",{value:!0}),v.ReasonCodes=v.UniqueMessageIdProvider=v.DefaultMessageIdProvider=v.Store=v.MqttClient=v.connectAsync=v.connect=v.Client=void 0;const o=r(p("./lib/client"));v.MqttClient=o.default;const s=r(p("./lib/default-message-id-provider"));v.DefaultMessageIdProvider=s.default;const t=r(p("./lib/unique-message-id-provider"));v.UniqueMessageIdProvider=t.default;const e=r(p("./lib/store"));v.Store=e.default;const i=g(p("./lib/connect"));v.connect=i.default,Object.defineProperty(v,"connectAsync",{enumerable:!0,get:function(){return i.connectAsync}}),v.Client=o.default,u(p("./lib/client"),v),u(p("./lib/shared"),v);var f=p("./lib/handlers/ack");Object.defineProperty(v,"ReasonCodes",{enumerable:!0,get:function(){return f.ReasonCodes}})},{"./lib/client":2,"./lib/connect":4,"./lib/default-message-id-provider":9,"./lib/handlers/ack":10,"./lib/shared":17,"./lib/store":18,"./lib/unique-message-id-provider":21}],24:[function(p,L,v){const{AbortController:a,AbortSignal:c}=typeof self<"u"?self:typeof window<"u"?window:void 0;L.exports=a,L.exports.AbortSignal=c,L.exports.default=a},{}],25:[function(p,L,v){v.byteLength=function(t){var e=o(t),i=e[0],f=e[1];return 3*(i+f)/4-f},v.toByteArray=function(t){var e,i,f=o(t),h=f[0],m=f[1],y=new g(function(M,k,w){return 3*(k+w)/4-w}(0,h,m)),E=0,P=m>0?h-4:h;for(i=0;i<P;i+=4)e=c[t.charCodeAt(i)]<<18|c[t.charCodeAt(i+1)]<<12|c[t.charCodeAt(i+2)]<<6|c[t.charCodeAt(i+3)],y[E++]=e>>16&255,y[E++]=e>>8&255,y[E++]=255&e;return m===2&&(e=c[t.charCodeAt(i)]<<2|c[t.charCodeAt(i+1)]>>4,y[E++]=255&e),m===1&&(e=c[t.charCodeAt(i)]<<10|c[t.charCodeAt(i+1)]<<4|c[t.charCodeAt(i+2)]>>2,y[E++]=e>>8&255,y[E++]=255&e),y},v.fromByteArray=function(t){for(var e,i=t.length,f=i%3,h=[],m=16383,y=0,E=i-f;y<E;y+=m)h.push(s(t,y,y+m>E?E:y+m));return f===1?(e=t[i-1],h.push(a[e>>2]+a[e<<4&63]+"==")):f===2&&(e=(t[i-2]<<8)+t[i-1],h.push(a[e>>10]+a[e>>4&63]+a[e<<2&63]+"=")),h.join("")};for(var a=[],c=[],g=typeof Uint8Array<"u"?Uint8Array:Array,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=0;r<64;++r)a[r]=u[r],c[u.charCodeAt(r)]=r;function o(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=t.indexOf("=");return i===-1&&(i=e),[i,i===e?0:4-i%4]}function s(t,e,i){for(var f,h,m=[],y=e;y<i;y+=3)f=(t[y]<<16&16711680)+(t[y+1]<<8&65280)+(255&t[y+2]),m.push(a[(h=f)>>18&63]+a[h>>12&63]+a[h>>6&63]+a[63&h]);return m.join("")}c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63},{}],26:[function(p,L,v){},{}],27:[function(p,L,v){var a=p("buffer"),c=a.Buffer;function g(r,o){for(var s in r)o[s]=r[s]}function u(r,o,s){return c(r,o,s)}c.from&&c.alloc&&c.allocUnsafe&&c.allocUnsafeSlow?L.exports=a:(g(a,v),v.Buffer=u),g(c,u),u.from=function(r,o,s){if(typeof r=="number")throw new TypeError("Argument must not be a number");return c(r,o,s)},u.alloc=function(r,o,s){if(typeof r!="number")throw new TypeError("Argument must be a number");var t=c(r);return o!==void 0?typeof s=="string"?t.fill(o,s):t.fill(o):t.fill(0),t},u.allocUnsafe=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return c(r)},u.allocUnsafeSlow=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return a.SlowBuffer(r)}},{buffer:29}],28:[function(p,L,v){var a=p("safe-buffer").Buffer,c=a.isEncoding||function(h){switch((h=""+h)&&h.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function g(h){var m;switch(this.encoding=function(y){var E=function(P){if(!P)return"utf8";for(var M;;)switch(P){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return P;default:if(M)return;P=(""+P).toLowerCase(),M=!0}}(y);if(typeof E!="string"&&(a.isEncoding===c||!c(y)))throw new Error("Unknown encoding: "+y);return E||y}(h),this.encoding){case"utf16le":this.text=o,this.end=s,m=4;break;case"utf8":this.fillLast=r,m=4;break;case"base64":this.text=t,this.end=e,m=3;break;default:return this.write=i,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=a.allocUnsafe(m)}function u(h){return h<=127?0:h>>5==6?2:h>>4==14?3:h>>3==30?4:h>>6==2?-1:-2}function r(h){var m=this.lastTotal-this.lastNeed,y=function(E,P,M){if((192&P[0])!=128)return E.lastNeed=0,"";if(E.lastNeed>1&&P.length>1){if((192&P[1])!=128)return E.lastNeed=1,"";if(E.lastNeed>2&&P.length>2&&(192&P[2])!=128)return E.lastNeed=2,""}}(this,h);return y!==void 0?y:this.lastNeed<=h.length?(h.copy(this.lastChar,m,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(h.copy(this.lastChar,m,0,h.length),void(this.lastNeed-=h.length))}function o(h,m){if((h.length-m)%2==0){var y=h.toString("utf16le",m);if(y){var E=y.charCodeAt(y.length-1);if(E>=55296&&E<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=h[h.length-2],this.lastChar[1]=h[h.length-1],y.slice(0,-1)}return y}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=h[h.length-1],h.toString("utf16le",m,h.length-1)}function s(h){var m=h&&h.length?this.write(h):"";if(this.lastNeed){var y=this.lastTotal-this.lastNeed;return m+this.lastChar.toString("utf16le",0,y)}return m}function t(h,m){var y=(h.length-m)%3;return y===0?h.toString("base64",m):(this.lastNeed=3-y,this.lastTotal=3,y===1?this.lastChar[0]=h[h.length-1]:(this.lastChar[0]=h[h.length-2],this.lastChar[1]=h[h.length-1]),h.toString("base64",m,h.length-y))}function e(h){var m=h&&h.length?this.write(h):"";return this.lastNeed?m+this.lastChar.toString("base64",0,3-this.lastNeed):m}function i(h){return h.toString(this.encoding)}function f(h){return h&&h.length?this.write(h):""}v.StringDecoder=g,g.prototype.write=function(h){if(h.length===0)return"";var m,y;if(this.lastNeed){if((m=this.fillLast(h))===void 0)return"";y=this.lastNeed,this.lastNeed=0}else y=0;return y<h.length?m?m+this.text(h,y):this.text(h,y):m||""},g.prototype.end=function(h){var m=h&&h.length?this.write(h):"";return this.lastNeed?m+"":m},g.prototype.text=function(h,m){var y=function(P,M,k){var w=M.length-1;if(w<k)return 0;var _=u(M[w]);return _>=0?(_>0&&(P.lastNeed=_-1),_):--w<k||_===-2?0:(_=u(M[w]),_>=0?(_>0&&(P.lastNeed=_-2),_):--w<k||_===-2?0:(_=u(M[w]),_>=0?(_>0&&(_===2?_=0:P.lastNeed=_-3),_):0))}(this,h,m);if(!this.lastNeed)return h.toString("utf8",m);this.lastTotal=y;var E=h.length-(y-this.lastNeed);return h.copy(this.lastChar,0,E),h.toString("utf8",m,E)},g.prototype.fillLast=function(h){if(this.lastNeed<=h.length)return h.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);h.copy(this.lastChar,this.lastTotal-this.lastNeed,0,h.length),this.lastNeed-=h.length}},{"safe-buffer":27}],29:[function(p,L,v){(function(a){(function(){var c=p("base64-js"),g=p("ieee754");v.Buffer=o,v.SlowBuffer=function(n){return+n!=n&&(n=0),o.alloc(+n)},v.INSPECT_MAX_BYTES=50;var u=2147483647;function r(n){if(n>u)throw new RangeError('The value "'+n+'" is invalid for option "size"');var l=new Uint8Array(n);return l.__proto__=o.prototype,l}function o(n,l,b){if(typeof n=="number"){if(typeof l=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return e(n)}return s(n,l,b)}function s(n,l,b){if(typeof n=="string")return function(z,j){if(typeof j=="string"&&j!==""||(j="utf8"),!o.isEncoding(j))throw new TypeError("Unknown encoding: "+j);var K=0|h(z,j),tt=r(K),et=tt.write(z,j);return et!==K&&(tt=tt.slice(0,et)),tt}(n,l);if(ArrayBuffer.isView(n))return i(n);if(n==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof n);if(Z(n,ArrayBuffer)||n&&Z(n.buffer,ArrayBuffer))return function(z,j,K){if(j<0||z.byteLength<j)throw new RangeError('"offset" is outside of buffer bounds');if(z.byteLength<j+(K||0))throw new RangeError('"length" is outside of buffer bounds');var tt;return tt=j===void 0&&K===void 0?new Uint8Array(z):K===void 0?new Uint8Array(z,j):new Uint8Array(z,j,K),tt.__proto__=o.prototype,tt}(n,l,b);if(typeof n=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var R=n.valueOf&&n.valueOf();if(R!=null&&R!==n)return o.from(R,l,b);var U=function(z){if(o.isBuffer(z)){var j=0|f(z.length),K=r(j);return K.length===0||z.copy(K,0,0,j),K}if(z.length!==void 0)return typeof z.length!="number"||I(z.length)?r(0):i(z);if(z.type==="Buffer"&&Array.isArray(z.data))return i(z.data)}(n);if(U)return U;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof n[Symbol.toPrimitive]=="function")return o.from(n[Symbol.toPrimitive]("string"),l,b);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof n)}function t(n){if(typeof n!="number")throw new TypeError('"size" argument must be of type number');if(n<0)throw new RangeError('The value "'+n+'" is invalid for option "size"')}function e(n){return t(n),r(n<0?0:0|f(n))}function i(n){for(var l=n.length<0?0:0|f(n.length),b=r(l),R=0;R<l;R+=1)b[R]=255&n[R];return b}function f(n){if(n>=u)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+u.toString(16)+" bytes");return 0|n}function h(n,l){if(o.isBuffer(n))return n.length;if(ArrayBuffer.isView(n)||Z(n,ArrayBuffer))return n.byteLength;if(typeof n!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof n);var b=n.length,R=arguments.length>2&&arguments[2]===!0;if(!R&&b===0)return 0;for(var U=!1;;)switch(l){case"ascii":case"latin1":case"binary":return b;case"utf8":case"utf-8":return W(n).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*b;case"hex":return b>>>1;case"base64":return J(n).length;default:if(U)return R?-1:W(n).length;l=(""+l).toLowerCase(),U=!0}}function m(n,l,b){var R=!1;if((l===void 0||l<0)&&(l=0),l>this.length||((b===void 0||b>this.length)&&(b=this.length),b<=0)||(b>>>=0)<=(l>>>=0))return"";for(n||(n="utf8");;)switch(n){case"hex":return Q(this,l,b);case"utf8":case"utf-8":return d(this,l,b);case"ascii":return A(this,l,b);case"latin1":case"binary":return G(this,l,b);case"base64":return D(this,l,b);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return X(this,l,b);default:if(R)throw new TypeError("Unknown encoding: "+n);n=(n+"").toLowerCase(),R=!0}}function y(n,l,b){var R=n[l];n[l]=n[b],n[b]=R}function E(n,l,b,R,U){if(n.length===0)return-1;if(typeof b=="string"?(R=b,b=0):b>2147483647?b=2147483647:b<-2147483648&&(b=-2147483648),I(b=+b)&&(b=U?0:n.length-1),b<0&&(b=n.length+b),b>=n.length){if(U)return-1;b=n.length-1}else if(b<0){if(!U)return-1;b=0}if(typeof l=="string"&&(l=o.from(l,R)),o.isBuffer(l))return l.length===0?-1:P(n,l,b,R,U);if(typeof l=="number")return l&=255,typeof Uint8Array.prototype.indexOf=="function"?U?Uint8Array.prototype.indexOf.call(n,l,b):Uint8Array.prototype.lastIndexOf.call(n,l,b):P(n,[l],b,R,U);throw new TypeError("val must be string, number or Buffer")}function P(n,l,b,R,U){var z,j=1,K=n.length,tt=l.length;if(R!==void 0&&((R=String(R).toLowerCase())==="ucs2"||R==="ucs-2"||R==="utf16le"||R==="utf-16le")){if(n.length<2||l.length<2)return-1;j=2,K/=2,tt/=2,b/=2}function et(ot,N){return j===1?ot[N]:ot.readUInt16BE(N*j)}if(U){var rt=-1;for(z=b;z<K;z++)if(et(n,z)===et(l,rt===-1?0:z-rt)){if(rt===-1&&(rt=z),z-rt+1===tt)return rt*j}else rt!==-1&&(z-=z-rt),rt=-1}else for(b+tt>K&&(b=K-tt),z=b;z>=0;z--){for(var ut=!0,st=0;st<tt;st++)if(et(n,z+st)!==et(l,st)){ut=!1;break}if(ut)return z}return-1}function M(n,l,b,R){b=Number(b)||0;var U=n.length-b;R?(R=Number(R))>U&&(R=U):R=U;var z=l.length;R>z/2&&(R=z/2);for(var j=0;j<R;++j){var K=parseInt(l.substr(2*j,2),16);if(I(K))return j;n[b+j]=K}return j}function k(n,l,b,R){return Y(W(l,n.length-b),n,b,R)}function w(n,l,b,R){return Y(function(U){for(var z=[],j=0;j<U.length;++j)z.push(255&U.charCodeAt(j));return z}(l),n,b,R)}function _(n,l,b,R){return w(n,l,b,R)}function x(n,l,b,R){return Y(J(l),n,b,R)}function V(n,l,b,R){return Y(function(U,z){for(var j,K,tt,et=[],rt=0;rt<U.length&&!((z-=2)<0);++rt)K=(j=U.charCodeAt(rt))>>8,tt=j%256,et.push(tt),et.push(K);return et}(l,n.length-b),n,b,R)}function D(n,l,b){return l===0&&b===n.length?c.fromByteArray(n):c.fromByteArray(n.slice(l,b))}function d(n,l,b){b=Math.min(n.length,b);for(var R=[],U=l;U<b;){var z,j,K,tt,et=n[U],rt=null,ut=et>239?4:et>223?3:et>191?2:1;if(U+ut<=b)switch(ut){case 1:et<128&&(rt=et);break;case 2:(192&(z=n[U+1]))==128&&(tt=(31&et)<<6|63&z)>127&&(rt=tt);break;case 3:z=n[U+1],j=n[U+2],(192&z)==128&&(192&j)==128&&(tt=(15&et)<<12|(63&z)<<6|63&j)>2047&&(tt<55296||tt>57343)&&(rt=tt);break;case 4:z=n[U+1],j=n[U+2],K=n[U+3],(192&z)==128&&(192&j)==128&&(192&K)==128&&(tt=(15&et)<<18|(63&z)<<12|(63&j)<<6|63&K)>65535&&tt<1114112&&(rt=tt)}rt===null?(rt=65533,ut=1):rt>65535&&(rt-=65536,R.push(rt>>>10&1023|55296),rt=56320|1023&rt),R.push(rt),U+=ut}return function(st){var ot=st.length;if(ot<=T)return String.fromCharCode.apply(String,st);for(var N="",q=0;q<ot;)N+=String.fromCharCode.apply(String,st.slice(q,q+=T));return N}(R)}v.kMaxLength=u,o.TYPED_ARRAY_SUPPORT=function(){try{var n=new Uint8Array(1);return n.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},n.foo()===42}catch{return!1}}(),o.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&Symbol.species!=null&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),o.poolSize=8192,o.from=function(n,l,b){return s(n,l,b)},o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,o.alloc=function(n,l,b){return function(R,U,z){return t(R),R<=0?r(R):U!==void 0?typeof z=="string"?r(R).fill(U,z):r(R).fill(U):r(R)}(n,l,b)},o.allocUnsafe=function(n){return e(n)},o.allocUnsafeSlow=function(n){return e(n)},o.isBuffer=function(n){return n!=null&&n._isBuffer===!0&&n!==o.prototype},o.compare=function(n,l){if(Z(n,Uint8Array)&&(n=o.from(n,n.offset,n.byteLength)),Z(l,Uint8Array)&&(l=o.from(l,l.offset,l.byteLength)),!o.isBuffer(n)||!o.isBuffer(l))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(n===l)return 0;for(var b=n.length,R=l.length,U=0,z=Math.min(b,R);U<z;++U)if(n[U]!==l[U]){b=n[U],R=l[U];break}return b<R?-1:R<b?1:0},o.isEncoding=function(n){switch(String(n).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(n,l){if(!Array.isArray(n))throw new TypeError('"list" argument must be an Array of Buffers');if(n.length===0)return o.alloc(0);var b;if(l===void 0)for(l=0,b=0;b<n.length;++b)l+=n[b].length;var R=o.allocUnsafe(l),U=0;for(b=0;b<n.length;++b){var z=n[b];if(Z(z,Uint8Array)&&(z=o.from(z)),!o.isBuffer(z))throw new TypeError('"list" argument must be an Array of Buffers');z.copy(R,U),U+=z.length}return R},o.byteLength=h,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var n=this.length;if(n%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var l=0;l<n;l+=2)y(this,l,l+1);return this},o.prototype.swap32=function(){var n=this.length;if(n%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var l=0;l<n;l+=4)y(this,l,l+3),y(this,l+1,l+2);return this},o.prototype.swap64=function(){var n=this.length;if(n%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var l=0;l<n;l+=8)y(this,l,l+7),y(this,l+1,l+6),y(this,l+2,l+5),y(this,l+3,l+4);return this},o.prototype.toString=function(){var n=this.length;return n===0?"":arguments.length===0?d(this,0,n):m.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(n){if(!o.isBuffer(n))throw new TypeError("Argument must be a Buffer");return this===n||o.compare(this,n)===0},o.prototype.inspect=function(){var n="",l=v.INSPECT_MAX_BYTES;return n=this.toString("hex",0,l).replace(/(.{2})/g,"$1 ").trim(),this.length>l&&(n+=" ... "),"<Buffer "+n+">"},o.prototype.compare=function(n,l,b,R,U){if(Z(n,Uint8Array)&&(n=o.from(n,n.offset,n.byteLength)),!o.isBuffer(n))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof n);if(l===void 0&&(l=0),b===void 0&&(b=n?n.length:0),R===void 0&&(R=0),U===void 0&&(U=this.length),l<0||b>n.length||R<0||U>this.length)throw new RangeError("out of range index");if(R>=U&&l>=b)return 0;if(R>=U)return-1;if(l>=b)return 1;if(this===n)return 0;for(var z=(U>>>=0)-(R>>>=0),j=(b>>>=0)-(l>>>=0),K=Math.min(z,j),tt=this.slice(R,U),et=n.slice(l,b),rt=0;rt<K;++rt)if(tt[rt]!==et[rt]){z=tt[rt],j=et[rt];break}return z<j?-1:j<z?1:0},o.prototype.includes=function(n,l,b){return this.indexOf(n,l,b)!==-1},o.prototype.indexOf=function(n,l,b){return E(this,n,l,b,!0)},o.prototype.lastIndexOf=function(n,l,b){return E(this,n,l,b,!1)},o.prototype.write=function(n,l,b,R){if(l===void 0)R="utf8",b=this.length,l=0;else if(b===void 0&&typeof l=="string")R=l,b=this.length,l=0;else{if(!isFinite(l))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");l>>>=0,isFinite(b)?(b>>>=0,R===void 0&&(R="utf8")):(R=b,b=void 0)}var U=this.length-l;if((b===void 0||b>U)&&(b=U),n.length>0&&(b<0||l<0)||l>this.length)throw new RangeError("Attempt to write outside buffer bounds");R||(R="utf8");for(var z=!1;;)switch(R){case"hex":return M(this,n,l,b);case"utf8":case"utf-8":return k(this,n,l,b);case"ascii":return w(this,n,l,b);case"latin1":case"binary":return _(this,n,l,b);case"base64":return x(this,n,l,b);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return V(this,n,l,b);default:if(z)throw new TypeError("Unknown encoding: "+R);R=(""+R).toLowerCase(),z=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var T=4096;function A(n,l,b){var R="";b=Math.min(n.length,b);for(var U=l;U<b;++U)R+=String.fromCharCode(127&n[U]);return R}function G(n,l,b){var R="";b=Math.min(n.length,b);for(var U=l;U<b;++U)R+=String.fromCharCode(n[U]);return R}function Q(n,l,b){var R=n.length;(!l||l<0)&&(l=0),(!b||b<0||b>R)&&(b=R);for(var U="",z=l;z<b;++z)U+=F(n[z]);return U}function X(n,l,b){for(var R=n.slice(l,b),U="",z=0;z<R.length;z+=2)U+=String.fromCharCode(R[z]+256*R[z+1]);return U}function O(n,l,b){if(n%1!=0||n<0)throw new RangeError("offset is not uint");if(n+l>b)throw new RangeError("Trying to access beyond buffer length")}function S(n,l,b,R,U,z){if(!o.isBuffer(n))throw new TypeError('"buffer" argument must be a Buffer instance');if(l>U||l<z)throw new RangeError('"value" argument is out of bounds');if(b+R>n.length)throw new RangeError("Index out of range")}function C(n,l,b,R,U,z){if(b+R>n.length)throw new RangeError("Index out of range");if(b<0)throw new RangeError("Index out of range")}function $(n,l,b,R,U){return l=+l,b>>>=0,U||C(n,0,b,4),g.write(n,l,b,R,23,4),b+4}function B(n,l,b,R,U){return l=+l,b>>>=0,U||C(n,0,b,8),g.write(n,l,b,R,52,8),b+8}o.prototype.slice=function(n,l){var b=this.length;(n=~~n)<0?(n+=b)<0&&(n=0):n>b&&(n=b),(l=l===void 0?b:~~l)<0?(l+=b)<0&&(l=0):l>b&&(l=b),l<n&&(l=n);var R=this.subarray(n,l);return R.__proto__=o.prototype,R},o.prototype.readUIntLE=function(n,l,b){n>>>=0,l>>>=0,b||O(n,l,this.length);for(var R=this[n],U=1,z=0;++z<l&&(U*=256);)R+=this[n+z]*U;return R},o.prototype.readUIntBE=function(n,l,b){n>>>=0,l>>>=0,b||O(n,l,this.length);for(var R=this[n+--l],U=1;l>0&&(U*=256);)R+=this[n+--l]*U;return R},o.prototype.readUInt8=function(n,l){return n>>>=0,l||O(n,1,this.length),this[n]},o.prototype.readUInt16LE=function(n,l){return n>>>=0,l||O(n,2,this.length),this[n]|this[n+1]<<8},o.prototype.readUInt16BE=function(n,l){return n>>>=0,l||O(n,2,this.length),this[n]<<8|this[n+1]},o.prototype.readUInt32LE=function(n,l){return n>>>=0,l||O(n,4,this.length),(this[n]|this[n+1]<<8|this[n+2]<<16)+16777216*this[n+3]},o.prototype.readUInt32BE=function(n,l){return n>>>=0,l||O(n,4,this.length),16777216*this[n]+(this[n+1]<<16|this[n+2]<<8|this[n+3])},o.prototype.readIntLE=function(n,l,b){n>>>=0,l>>>=0,b||O(n,l,this.length);for(var R=this[n],U=1,z=0;++z<l&&(U*=256);)R+=this[n+z]*U;return R>=(U*=128)&&(R-=Math.pow(2,8*l)),R},o.prototype.readIntBE=function(n,l,b){n>>>=0,l>>>=0,b||O(n,l,this.length);for(var R=l,U=1,z=this[n+--R];R>0&&(U*=256);)z+=this[n+--R]*U;return z>=(U*=128)&&(z-=Math.pow(2,8*l)),z},o.prototype.readInt8=function(n,l){return n>>>=0,l||O(n,1,this.length),128&this[n]?-1*(255-this[n]+1):this[n]},o.prototype.readInt16LE=function(n,l){n>>>=0,l||O(n,2,this.length);var b=this[n]|this[n+1]<<8;return 32768&b?4294901760|b:b},o.prototype.readInt16BE=function(n,l){n>>>=0,l||O(n,2,this.length);var b=this[n+1]|this[n]<<8;return 32768&b?4294901760|b:b},o.prototype.readInt32LE=function(n,l){return n>>>=0,l||O(n,4,this.length),this[n]|this[n+1]<<8|this[n+2]<<16|this[n+3]<<24},o.prototype.readInt32BE=function(n,l){return n>>>=0,l||O(n,4,this.length),this[n]<<24|this[n+1]<<16|this[n+2]<<8|this[n+3]},o.prototype.readFloatLE=function(n,l){return n>>>=0,l||O(n,4,this.length),g.read(this,n,!0,23,4)},o.prototype.readFloatBE=function(n,l){return n>>>=0,l||O(n,4,this.length),g.read(this,n,!1,23,4)},o.prototype.readDoubleLE=function(n,l){return n>>>=0,l||O(n,8,this.length),g.read(this,n,!0,52,8)},o.prototype.readDoubleBE=function(n,l){return n>>>=0,l||O(n,8,this.length),g.read(this,n,!1,52,8)},o.prototype.writeUIntLE=function(n,l,b,R){n=+n,l>>>=0,b>>>=0,R||S(this,n,l,b,Math.pow(2,8*b)-1,0);var U=1,z=0;for(this[l]=255&n;++z<b&&(U*=256);)this[l+z]=n/U&255;return l+b},o.prototype.writeUIntBE=function(n,l,b,R){n=+n,l>>>=0,b>>>=0,R||S(this,n,l,b,Math.pow(2,8*b)-1,0);var U=b-1,z=1;for(this[l+U]=255&n;--U>=0&&(z*=256);)this[l+U]=n/z&255;return l+b},o.prototype.writeUInt8=function(n,l,b){return n=+n,l>>>=0,b||S(this,n,l,1,255,0),this[l]=255&n,l+1},o.prototype.writeUInt16LE=function(n,l,b){return n=+n,l>>>=0,b||S(this,n,l,2,65535,0),this[l]=255&n,this[l+1]=n>>>8,l+2},o.prototype.writeUInt16BE=function(n,l,b){return n=+n,l>>>=0,b||S(this,n,l,2,65535,0),this[l]=n>>>8,this[l+1]=255&n,l+2},o.prototype.writeUInt32LE=function(n,l,b){return n=+n,l>>>=0,b||S(this,n,l,4,4294967295,0),this[l+3]=n>>>24,this[l+2]=n>>>16,this[l+1]=n>>>8,this[l]=255&n,l+4},o.prototype.writeUInt32BE=function(n,l,b){return n=+n,l>>>=0,b||S(this,n,l,4,4294967295,0),this[l]=n>>>24,this[l+1]=n>>>16,this[l+2]=n>>>8,this[l+3]=255&n,l+4},o.prototype.writeIntLE=function(n,l,b,R){if(n=+n,l>>>=0,!R){var U=Math.pow(2,8*b-1);S(this,n,l,b,U-1,-U)}var z=0,j=1,K=0;for(this[l]=255&n;++z<b&&(j*=256);)n<0&&K===0&&this[l+z-1]!==0&&(K=1),this[l+z]=(n/j>>0)-K&255;return l+b},o.prototype.writeIntBE=function(n,l,b,R){if(n=+n,l>>>=0,!R){var U=Math.pow(2,8*b-1);S(this,n,l,b,U-1,-U)}var z=b-1,j=1,K=0;for(this[l+z]=255&n;--z>=0&&(j*=256);)n<0&&K===0&&this[l+z+1]!==0&&(K=1),this[l+z]=(n/j>>0)-K&255;return l+b},o.prototype.writeInt8=function(n,l,b){return n=+n,l>>>=0,b||S(this,n,l,1,127,-128),n<0&&(n=255+n+1),this[l]=255&n,l+1},o.prototype.writeInt16LE=function(n,l,b){return n=+n,l>>>=0,b||S(this,n,l,2,32767,-32768),this[l]=255&n,this[l+1]=n>>>8,l+2},o.prototype.writeInt16BE=function(n,l,b){return n=+n,l>>>=0,b||S(this,n,l,2,32767,-32768),this[l]=n>>>8,this[l+1]=255&n,l+2},o.prototype.writeInt32LE=function(n,l,b){return n=+n,l>>>=0,b||S(this,n,l,4,2147483647,-2147483648),this[l]=255&n,this[l+1]=n>>>8,this[l+2]=n>>>16,this[l+3]=n>>>24,l+4},o.prototype.writeInt32BE=function(n,l,b){return n=+n,l>>>=0,b||S(this,n,l,4,2147483647,-2147483648),n<0&&(n=4294967295+n+1),this[l]=n>>>24,this[l+1]=n>>>16,this[l+2]=n>>>8,this[l+3]=255&n,l+4},o.prototype.writeFloatLE=function(n,l,b){return $(this,n,l,!0,b)},o.prototype.writeFloatBE=function(n,l,b){return $(this,n,l,!1,b)},o.prototype.writeDoubleLE=function(n,l,b){return B(this,n,l,!0,b)},o.prototype.writeDoubleBE=function(n,l,b){return B(this,n,l,!1,b)},o.prototype.copy=function(n,l,b,R){if(!o.isBuffer(n))throw new TypeError("argument should be a Buffer");if(b||(b=0),R||R===0||(R=this.length),l>=n.length&&(l=n.length),l||(l=0),R>0&&R<b&&(R=b),R===b||n.length===0||this.length===0)return 0;if(l<0)throw new RangeError("targetStart out of bounds");if(b<0||b>=this.length)throw new RangeError("Index out of range");if(R<0)throw new RangeError("sourceEnd out of bounds");R>this.length&&(R=this.length),n.length-l<R-b&&(R=n.length-l+b);var U=R-b;if(this===n&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(l,b,R);else if(this===n&&b<l&&l<R)for(var z=U-1;z>=0;--z)n[z+l]=this[z+b];else Uint8Array.prototype.set.call(n,this.subarray(b,R),l);return U},o.prototype.fill=function(n,l,b,R){if(typeof n=="string"){if(typeof l=="string"?(R=l,l=0,b=this.length):typeof b=="string"&&(R=b,b=this.length),R!==void 0&&typeof R!="string")throw new TypeError("encoding must be a string");if(typeof R=="string"&&!o.isEncoding(R))throw new TypeError("Unknown encoding: "+R);if(n.length===1){var U=n.charCodeAt(0);(R==="utf8"&&U<128||R==="latin1")&&(n=U)}}else typeof n=="number"&&(n&=255);if(l<0||this.length<l||this.length<b)throw new RangeError("Out of range index");if(b<=l)return this;var z;if(l>>>=0,b=b===void 0?this.length:b>>>0,n||(n=0),typeof n=="number")for(z=l;z<b;++z)this[z]=n;else{var j=o.isBuffer(n)?n:o.from(n,R),K=j.length;if(K===0)throw new TypeError('The value "'+n+'" is invalid for argument "value"');for(z=0;z<b-l;++z)this[z+l]=j[z%K]}return this};var H=/[^+/0-9A-Za-z-_]/g;function F(n){return n<16?"0"+n.toString(16):n.toString(16)}function W(n,l){var b;l=l||1/0;for(var R=n.length,U=null,z=[],j=0;j<R;++j){if((b=n.charCodeAt(j))>55295&&b<57344){if(!U){if(b>56319){(l-=3)>-1&&z.push(239,191,189);continue}if(j+1===R){(l-=3)>-1&&z.push(239,191,189);continue}U=b;continue}if(b<56320){(l-=3)>-1&&z.push(239,191,189),U=b;continue}b=65536+(U-55296<<10|b-56320)}else U&&(l-=3)>-1&&z.push(239,191,189);if(U=null,b<128){if((l-=1)<0)break;z.push(b)}else if(b<2048){if((l-=2)<0)break;z.push(b>>6|192,63&b|128)}else if(b<65536){if((l-=3)<0)break;z.push(b>>12|224,b>>6&63|128,63&b|128)}else{if(!(b<1114112))throw new Error("Invalid code point");if((l-=4)<0)break;z.push(b>>18|240,b>>12&63|128,b>>6&63|128,63&b|128)}}return z}function J(n){return c.toByteArray(function(l){if((l=(l=l.split("=")[0]).trim().replace(H,"")).length<2)return"";for(;l.length%4!=0;)l+="=";return l}(n))}function Y(n,l,b,R){for(var U=0;U<R&&!(U+b>=l.length||U>=n.length);++U)l[U+b]=n[U];return U}function Z(n,l){return n instanceof l||n!=null&&n.constructor!=null&&n.constructor.name!=null&&n.constructor.name===l.name}function I(n){return n!=n}}).call(this)}).call(this,p("buffer").Buffer)},{"base64-js":25,buffer:29,ieee754:50}],30:[function(p,L,v){(function(a){(function(){v.formatArgs=function(g){if(g[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+g[0]+(this.useColors?"%c ":" ")+"+"+L.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;g.splice(1,0,u,"color: inherit");let r=0,o=0;g[0].replace(/%[a-zA-Z%]/g,s=>{s!=="%%"&&(r++,s==="%c"&&(o=r))}),g.splice(o,0,u)},v.save=function(g){try{g?v.storage.setItem("debug",g):v.storage.removeItem("debug")}catch{}},v.load=function(){let g;try{g=v.storage.getItem("debug")}catch{}return!g&&a!==void 0&&"env"in a&&(g=a.env.DEBUG),g},v.useColors=function(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},v.storage=function(){try{return localStorage}catch{}}(),v.destroy=(()=>{let g=!1;return()=>{g||(g=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),v.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],v.log=console.debug||console.log||(()=>{}),L.exports=p("./common")(v);const{formatters:c}=L.exports;c.j=function(g){try{return JSON.stringify(g)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}}).call(this)}).call(this,p("_process"))},{"./common":31,_process:102}],31:[function(p,L,v){L.exports=function(a){function c(r){let o,s,t,e=null;function i(...f){if(!i.enabled)return;const h=i,m=Number(new Date),y=m-(o||m);h.diff=y,h.prev=o,h.curr=m,o=m,f[0]=c.coerce(f[0]),typeof f[0]!="string"&&f.unshift("%O");let E=0;f[0]=f[0].replace(/%([a-zA-Z%])/g,(P,M)=>{if(P==="%%")return"%";E++;const k=c.formatters[M];if(typeof k=="function"){const w=f[E];P=k.call(h,w),f.splice(E,1),E--}return P}),c.formatArgs.call(h,f),(h.log||c.log).apply(h,f)}return i.namespace=r,i.useColors=c.useColors(),i.color=c.selectColor(r),i.extend=g,i.destroy=c.destroy,Object.defineProperty(i,"enabled",{enumerable:!0,configurable:!1,get:()=>e!==null?e:(s!==c.namespaces&&(s=c.namespaces,t=c.enabled(r)),t),set:f=>{e=f}}),typeof c.init=="function"&&c.init(i),i}function g(r,o){const s=c(this.namespace+(o===void 0?":":o)+r);return s.log=this.log,s}function u(r){return r.toString().substring(2,r.toString().length-2).replace(/\.\*\?$/,"*")}return c.debug=c,c.default=c,c.coerce=function(r){return r instanceof Error?r.stack||r.message:r},c.disable=function(){const r=[...c.names.map(u),...c.skips.map(u).map(o=>"-"+o)].join(",");return c.enable(""),r},c.enable=function(r){let o;c.save(r),c.namespaces=r,c.names=[],c.skips=[];const s=(typeof r=="string"?r:"").split(/[\s,]+/),t=s.length;for(o=0;o<t;o++)s[o]&&((r=s[o].replace(/\*/g,".*?"))[0]==="-"?c.skips.push(new RegExp("^"+r.slice(1)+"$")):c.names.push(new RegExp("^"+r+"$")))},c.enabled=function(r){if(r[r.length-1]==="*")return!0;let o,s;for(o=0,s=c.skips.length;o<s;o++)if(c.skips[o].test(r))return!1;for(o=0,s=c.names.length;o<s;o++)if(c.names[o].test(r))return!0;return!1},c.humanize=p("ms"),c.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(a).forEach(r=>{c[r]=a[r]}),c.names=[],c.skips=[],c.formatters={},c.selectColor=function(r){let o=0;for(let s=0;s<r.length;s++)o=(o<<5)-o+r.charCodeAt(s),o|=0;return c.colors[Math.abs(o)%c.colors.length]},c.enable(c.load()),c}},{ms:97}],32:[function(p,L,v){(function(a,c){(function(){var g=p("readable-stream"),u=p("end-of-stream"),r=p("inherits"),o=p("stream-shift"),s=c.from&&c.from!==Uint8Array.from?c.from([0]):new c([0]),t=function(h,m){h._corked?h.once("uncork",m):m()},e=function(h,m){return function(y){y?function(E,P){E._autoDestroy&&E.destroy(P)}(h,y.message==="premature close"?null:y):m&&!h._ended&&h.end()}},i=function(){},f=function(h,m,y){if(!(this instanceof f))return new f(h,m,y);g.Duplex.call(this,y),this._writable=null,this._readable=null,this._readable2=null,this._autoDestroy=!y||y.autoDestroy!==!1,this._forwardDestroy=!y||y.destroy!==!1,this._forwardEnd=!y||y.end!==!1,this._corked=1,this._ondrain=null,this._drained=!1,this._forwarding=!1,this._unwrite=null,this._unread=null,this._ended=!1,this.destroyed=!1,h&&this.setWritable(h),m&&this.setReadable(m)};r(f,g.Duplex),f.obj=function(h,m,y){return y||(y={}),y.objectMode=!0,y.highWaterMark=16,new f(h,m,y)},f.prototype.cork=function(){++this._corked==1&&this.emit("cork")},f.prototype.uncork=function(){this._corked&&--this._corked==0&&this.emit("uncork")},f.prototype.setWritable=function(h){if(this._unwrite&&this._unwrite(),this.destroyed)h&&h.destroy&&h.destroy();else if(h!==null&&h!==!1){var m=this,y=u(h,{writable:!0,readable:!1},e(this,this._forwardEnd)),E=function(){var P=m._ondrain;m._ondrain=null,P&&P()};this._unwrite&&a.nextTick(E),this._writable=h,this._writable.on("drain",E),this._unwrite=function(){m._writable.removeListener("drain",E),y()},this.uncork()}else this.end()},f.prototype.setReadable=function(h){if(this._unread&&this._unread(),this.destroyed)h&&h.destroy&&h.destroy();else{if(h===null||h===!1)return this.push(null),void this.resume();var m,y=this,E=u(h,{writable:!1,readable:!0},e(this)),P=function(){y._forward()},M=function(){y.push(null)};this._drained=!0,this._readable=h,this._readable2=h._readableState?h:(m=h,new g.Readable({objectMode:!0,highWaterMark:16}).wrap(m)),this._readable2.on("readable",P),this._readable2.on("end",M),this._unread=function(){y._readable2.removeListener("readable",P),y._readable2.removeListener("end",M),E()},this._forward()}},f.prototype._read=function(){this._drained=!0,this._forward()},f.prototype._forward=function(){if(!this._forwarding&&this._readable2&&this._drained){var h;for(this._forwarding=!0;this._drained&&(h=o(this._readable2))!==null;)this.destroyed||(this._drained=this.push(h));this._forwarding=!1}},f.prototype.destroy=function(h,m){if(m||(m=i),this.destroyed)return m(null);this.destroyed=!0;var y=this;a.nextTick(function(){y._destroy(h),m(null)})},f.prototype._destroy=function(h){if(h){var m=this._ondrain;this._ondrain=null,m?m(h):this.emit("error",h)}this._forwardDestroy&&(this._readable&&this._readable.destroy&&this._readable.destroy(),this._writable&&this._writable.destroy&&this._writable.destroy()),this.emit("close")},f.prototype._write=function(h,m,y){if(!this.destroyed)return this._corked?t(this,this._write.bind(this,h,m,y)):h===s?this._finish(y):this._writable?void(this._writable.write(h)===!1?this._ondrain=y:this.destroyed||y()):y()},f.prototype._finish=function(h){var m=this;this.emit("preend"),t(this,function(){var y,E;y=m._forwardEnd&&m._writable,E=function(){m._writableState.prefinished===!1&&(m._writableState.prefinished=!0),m.emit("prefinish"),t(m,h)},y?y._writableState&&y._writableState.finished?E():y._writableState?y.end(E):(y.end(),E()):E()})},f.prototype.end=function(h,m,y){return typeof h=="function"?this.end(null,null,h):typeof m=="function"?this.end(h,null,m):(this._ended=!0,h&&this.write(h),this._writableState.ending||this._writableState.destroyed||this.write(s),g.Writable.prototype.end.call(this,y))},L.exports=f}).call(this)}).call(this,p("_process"),p("buffer").Buffer)},{_process:102,buffer:29,"end-of-stream":48,inherits:51,"readable-stream":47,"stream-shift":135}],33:[function(p,L,v){var a={};function c(u,r,o){o||(o=Error);var s=function(t){var e,i;function f(h,m,y){return t.call(this,function(E,P,M){return typeof r=="string"?r:r(E,P,M)}(h,m,y))||this}return i=t,(e=f).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i,f}(o);s.prototype.name=o.name,s.prototype.code=u,a[u]=s}function g(u,r){if(Array.isArray(u)){var o=u.length;return u=u.map(function(s){return String(s)}),o>2?"one of ".concat(r," ").concat(u.slice(0,o-1).join(", "),", or ")+u[o-1]:o===2?"one of ".concat(r," ").concat(u[0]," or ").concat(u[1]):"of ".concat(r," ").concat(u[0])}return"of ".concat(r," ").concat(String(u))}c("ERR_INVALID_OPT_VALUE",function(u,r){return'The value "'+r+'" is invalid for option "'+u+'"'},TypeError),c("ERR_INVALID_ARG_TYPE",function(u,r,o){var s,t,e;if(typeof r=="string"&&(t="not ",r.substr(0,t.length)===t)?(s="must not be",r=r.replace(/^not /,"")):s="must be",function(f,h,m){return(m===void 0||m>f.length)&&(m=f.length),f.substring(m-h.length,m)===h}(u," argument"))e="The ".concat(u," ").concat(s," ").concat(g(r,"type"));else{var i=function(f,h,m){return typeof m!="number"&&(m=0),!(m+h.length>f.length)&&f.indexOf(h,m)!==-1}(u,".")?"property":"argument";e='The "'.concat(u,'" ').concat(i," ").concat(s," ").concat(g(r,"type"))}return e+=". Received type ".concat(typeof o)},TypeError),c("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),c("ERR_METHOD_NOT_IMPLEMENTED",function(u){return"The "+u+" method is not implemented"}),c("ERR_STREAM_PREMATURE_CLOSE","Premature close"),c("ERR_STREAM_DESTROYED",function(u){return"Cannot call "+u+" after a stream was destroyed"}),c("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),c("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),c("ERR_STREAM_WRITE_AFTER_END","write after end"),c("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),c("ERR_UNKNOWN_ENCODING",function(u){return"Unknown encoding: "+u},TypeError),c("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),L.exports.codes=a},{}],34:[function(p,L,v){(function(a){(function(){var c=Object.keys||function(f){var h=[];for(var m in f)h.push(m);return h};L.exports=t;var g=p("./_stream_readable"),u=p("./_stream_writable");p("inherits")(t,g);for(var r=c(u.prototype),o=0;o<r.length;o++){var s=r[o];t.prototype[s]||(t.prototype[s]=u.prototype[s])}function t(f){if(!(this instanceof t))return new t(f);g.call(this,f),u.call(this,f),this.allowHalfOpen=!0,f&&(f.readable===!1&&(this.readable=!1),f.writable===!1&&(this.writable=!1),f.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",e)))}function e(){this._writableState.ended||a.nextTick(i,this)}function i(f){f.end()}Object.defineProperty(t.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(t.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(t.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(t.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(f){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=f,this._writableState.destroyed=f)}})}).call(this)}).call(this,p("_process"))},{"./_stream_readable":36,"./_stream_writable":38,_process:102,inherits:51}],35:[function(p,L,v){L.exports=c;var a=p("./_stream_transform");function c(g){if(!(this instanceof c))return new c(g);a.call(this,g)}p("inherits")(c,a),c.prototype._transform=function(g,u,r){r(null,g)}},{"./_stream_transform":37,inherits:51}],36:[function(p,L,v){(function(a,c){(function(){var g;L.exports=d,d.ReadableState=D,p("events").EventEmitter;var u=function(I,n){return I.listeners(n).length},r=p("./internal/streams/stream"),o=p("buffer").Buffer,s=c.Uint8Array||function(){},t,e=p("util");t=e&&e.debuglog?e.debuglog("stream"):function(){};var i,f,h,m=p("./internal/streams/buffer_list"),y=p("./internal/streams/destroy"),E=p("./internal/streams/state").getHighWaterMark,P=p("../errors").codes,M=P.ERR_INVALID_ARG_TYPE,k=P.ERR_STREAM_PUSH_AFTER_EOF,w=P.ERR_METHOD_NOT_IMPLEMENTED,_=P.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;p("inherits")(d,r);var x=y.errorOrDestroy,V=["error","close","destroy","pause","resume"];function D(I,n,l){g=g||p("./_stream_duplex"),I=I||{},typeof l!="boolean"&&(l=n instanceof g),this.objectMode=!!I.objectMode,l&&(this.objectMode=this.objectMode||!!I.readableObjectMode),this.highWaterMark=E(this,I,"readableHighWaterMark",l),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=I.emitClose!==!1,this.autoDestroy=!!I.autoDestroy,this.destroyed=!1,this.defaultEncoding=I.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,I.encoding&&(i||(i=p("string_decoder/").StringDecoder),this.decoder=new i(I.encoding),this.encoding=I.encoding)}function d(I){if(g=g||p("./_stream_duplex"),!(this instanceof d))return new d(I);var n=this instanceof g;this._readableState=new D(I,this,n),this.readable=!0,I&&(typeof I.read=="function"&&(this._read=I.read),typeof I.destroy=="function"&&(this._destroy=I.destroy)),r.call(this)}function T(I,n,l,b,R){t("readableAddChunk",n);var U,z=I._readableState;if(n===null)z.reading=!1,function(j,K){if(t("onEofChunk"),!K.ended){if(K.decoder){var tt=K.decoder.end();tt&&tt.length&&(K.buffer.push(tt),K.length+=K.objectMode?1:tt.length)}K.ended=!0,K.sync?X(j):(K.needReadable=!1,K.emittedReadable||(K.emittedReadable=!0,O(j)))}}(I,z);else if(R||(U=function(j,K){var tt;et=K,o.isBuffer(et)||et instanceof s||typeof K=="string"||K===void 0||j.objectMode||(tt=new M("chunk",["string","Buffer","Uint8Array"],K));var et;return tt}(z,n)),U)x(I,U);else if(z.objectMode||n&&n.length>0)if(typeof n=="string"||z.objectMode||Object.getPrototypeOf(n)===o.prototype||(n=function(j){return o.from(j)}(n)),b)z.endEmitted?x(I,new _):A(I,z,n,!0);else if(z.ended)x(I,new k);else{if(z.destroyed)return!1;z.reading=!1,z.decoder&&!l?(n=z.decoder.write(n),z.objectMode||n.length!==0?A(I,z,n,!1):S(I,z)):A(I,z,n,!1)}else b||(z.reading=!1,S(I,z));return!z.ended&&(z.length<z.highWaterMark||z.length===0)}function A(I,n,l,b){n.flowing&&n.length===0&&!n.sync?(n.awaitDrain=0,I.emit("data",l)):(n.length+=n.objectMode?1:l.length,b?n.buffer.unshift(l):n.buffer.push(l),n.needReadable&&X(I)),S(I,n)}Object.defineProperty(d.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(I){this._readableState&&(this._readableState.destroyed=I)}}),d.prototype.destroy=y.destroy,d.prototype._undestroy=y.undestroy,d.prototype._destroy=function(I,n){n(I)},d.prototype.push=function(I,n){var l,b=this._readableState;return b.objectMode?l=!0:typeof I=="string"&&((n=n||b.defaultEncoding)!==b.encoding&&(I=o.from(I,n),n=""),l=!0),T(this,I,n,!1,l)},d.prototype.unshift=function(I){return T(this,I,null,!0,!1)},d.prototype.isPaused=function(){return this._readableState.flowing===!1},d.prototype.setEncoding=function(I){i||(i=p("string_decoder/").StringDecoder);var n=new i(I);this._readableState.decoder=n,this._readableState.encoding=this._readableState.decoder.encoding;for(var l=this._readableState.buffer.head,b="";l!==null;)b+=n.write(l.data),l=l.next;return this._readableState.buffer.clear(),b!==""&&this._readableState.buffer.push(b),this._readableState.length=b.length,this};var G=1073741824;function Q(I,n){return I<=0||n.length===0&&n.ended?0:n.objectMode?1:I!=I?n.flowing&&n.length?n.buffer.head.data.length:n.length:(I>n.highWaterMark&&(n.highWaterMark=function(l){return l>=G?l=G:(l--,l|=l>>>1,l|=l>>>2,l|=l>>>4,l|=l>>>8,l|=l>>>16,l++),l}(I)),I<=n.length?I:n.ended?n.length:(n.needReadable=!0,0))}function X(I){var n=I._readableState;t("emitReadable",n.needReadable,n.emittedReadable),n.needReadable=!1,n.emittedReadable||(t("emitReadable",n.flowing),n.emittedReadable=!0,a.nextTick(O,I))}function O(I){var n=I._readableState;t("emitReadable_",n.destroyed,n.length,n.ended),n.destroyed||!n.length&&!n.ended||(I.emit("readable"),n.emittedReadable=!1),n.needReadable=!n.flowing&&!n.ended&&n.length<=n.highWaterMark,F(I)}function S(I,n){n.readingMore||(n.readingMore=!0,a.nextTick(C,I,n))}function C(I,n){for(;!n.reading&&!n.ended&&(n.length<n.highWaterMark||n.flowing&&n.length===0);){var l=n.length;if(t("maybeReadMore read 0"),I.read(0),l===n.length)break}n.readingMore=!1}function $(I){var n=I._readableState;n.readableListening=I.listenerCount("readable")>0,n.resumeScheduled&&!n.paused?n.flowing=!0:I.listenerCount("data")>0&&I.resume()}function B(I){t("readable nexttick read 0"),I.read(0)}function H(I,n){t("resume",n.reading),n.reading||I.read(0),n.resumeScheduled=!1,I.emit("resume"),F(I),n.flowing&&!n.reading&&I.read(0)}function F(I){var n=I._readableState;for(t("flow",n.flowing);n.flowing&&I.read()!==null;);}function W(I,n){return n.length===0?null:(n.objectMode?l=n.buffer.shift():!I||I>=n.length?(l=n.decoder?n.buffer.join(""):n.buffer.length===1?n.buffer.first():n.buffer.concat(n.length),n.buffer.clear()):l=n.buffer.consume(I,n.decoder),l);var l}function J(I){var n=I._readableState;t("endReadable",n.endEmitted),n.endEmitted||(n.ended=!0,a.nextTick(Y,n,I))}function Y(I,n){if(t("endReadableNT",I.endEmitted,I.length),!I.endEmitted&&I.length===0&&(I.endEmitted=!0,n.readable=!1,n.emit("end"),I.autoDestroy)){var l=n._writableState;(!l||l.autoDestroy&&l.finished)&&n.destroy()}}function Z(I,n){for(var l=0,b=I.length;l<b;l++)if(I[l]===n)return l;return-1}d.prototype.read=function(I){t("read",I),I=parseInt(I,10);var n=this._readableState,l=I;if(I!==0&&(n.emittedReadable=!1),I===0&&n.needReadable&&((n.highWaterMark!==0?n.length>=n.highWaterMark:n.length>0)||n.ended))return t("read: emitReadable",n.length,n.ended),n.length===0&&n.ended?J(this):X(this),null;if((I=Q(I,n))===0&&n.ended)return n.length===0&&J(this),null;var b,R=n.needReadable;return t("need readable",R),(n.length===0||n.length-I<n.highWaterMark)&&t("length less than watermark",R=!0),n.ended||n.reading?t("reading or ended",R=!1):R&&(t("do read"),n.reading=!0,n.sync=!0,n.length===0&&(n.needReadable=!0),this._read(n.highWaterMark),n.sync=!1,n.reading||(I=Q(l,n))),(b=I>0?W(I,n):null)===null?(n.needReadable=n.length<=n.highWaterMark,I=0):(n.length-=I,n.awaitDrain=0),n.length===0&&(n.ended||(n.needReadable=!0),l!==I&&n.ended&&J(this)),b!==null&&this.emit("data",b),b},d.prototype._read=function(I){x(this,new w("_read()"))},d.prototype.pipe=function(I,n){var l=this,b=this._readableState;switch(b.pipesCount){case 0:b.pipes=I;break;case 1:b.pipes=[b.pipes,I];break;default:b.pipes.push(I)}b.pipesCount+=1,t("pipe count=%d opts=%j",b.pipesCount,n);var R=(!n||n.end!==!1)&&I!==a.stdout&&I!==a.stderr?z:st;function U(ot,N){t("onunpipe"),ot===l&&N&&N.hasUnpiped===!1&&(N.hasUnpiped=!0,t("cleanup"),I.removeListener("close",rt),I.removeListener("finish",ut),I.removeListener("drain",j),I.removeListener("error",et),I.removeListener("unpipe",U),l.removeListener("end",z),l.removeListener("end",st),l.removeListener("data",tt),K=!0,!b.awaitDrain||I._writableState&&!I._writableState.needDrain||j())}function z(){t("onend"),I.end()}b.endEmitted?a.nextTick(R):l.once("end",R),I.on("unpipe",U);var j=function(ot){return function(){var N=ot._readableState;t("pipeOnDrain",N.awaitDrain),N.awaitDrain&&N.awaitDrain--,N.awaitDrain===0&&u(ot,"data")&&(N.flowing=!0,F(ot))}}(l);I.on("drain",j);var K=!1;function tt(ot){t("ondata");var N=I.write(ot);t("dest.write",N),N===!1&&((b.pipesCount===1&&b.pipes===I||b.pipesCount>1&&Z(b.pipes,I)!==-1)&&!K&&(t("false write response, pause",b.awaitDrain),b.awaitDrain++),l.pause())}function et(ot){t("onerror",ot),st(),I.removeListener("error",et),u(I,"error")===0&&x(I,ot)}function rt(){I.removeListener("finish",ut),st()}function ut(){t("onfinish"),I.removeListener("close",rt),st()}function st(){t("unpipe"),l.unpipe(I)}return l.on("data",tt),function(ot,N,q){if(typeof ot.prependListener=="function")return ot.prependListener(N,q);ot._events&&ot._events[N]?Array.isArray(ot._events[N])?ot._events[N].unshift(q):ot._events[N]=[q,ot._events[N]]:ot.on(N,q)}(I,"error",et),I.once("close",rt),I.once("finish",ut),I.emit("pipe",l),b.flowing||(t("pipe resume"),l.resume()),I},d.prototype.unpipe=function(I){var n=this._readableState,l={hasUnpiped:!1};if(n.pipesCount===0)return this;if(n.pipesCount===1)return I&&I!==n.pipes||(I||(I=n.pipes),n.pipes=null,n.pipesCount=0,n.flowing=!1,I&&I.emit("unpipe",this,l)),this;if(!I){var b=n.pipes,R=n.pipesCount;n.pipes=null,n.pipesCount=0,n.flowing=!1;for(var U=0;U<R;U++)b[U].emit("unpipe",this,{hasUnpiped:!1});return this}var z=Z(n.pipes,I);return z===-1||(n.pipes.splice(z,1),n.pipesCount-=1,n.pipesCount===1&&(n.pipes=n.pipes[0]),I.emit("unpipe",this,l)),this},d.prototype.on=function(I,n){var l=r.prototype.on.call(this,I,n),b=this._readableState;return I==="data"?(b.readableListening=this.listenerCount("readable")>0,b.flowing!==!1&&this.resume()):I==="readable"&&(b.endEmitted||b.readableListening||(b.readableListening=b.needReadable=!0,b.flowing=!1,b.emittedReadable=!1,t("on readable",b.length,b.reading),b.length?X(this):b.reading||a.nextTick(B,this))),l},d.prototype.addListener=d.prototype.on,d.prototype.removeListener=function(I,n){var l=r.prototype.removeListener.call(this,I,n);return I==="readable"&&a.nextTick($,this),l},d.prototype.removeAllListeners=function(I){var n=r.prototype.removeAllListeners.apply(this,arguments);return I!=="readable"&&I!==void 0||a.nextTick($,this),n},d.prototype.resume=function(){var I=this._readableState;return I.flowing||(t("resume"),I.flowing=!I.readableListening,function(n,l){l.resumeScheduled||(l.resumeScheduled=!0,a.nextTick(H,n,l))}(this,I)),I.paused=!1,this},d.prototype.pause=function(){return t("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(t("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},d.prototype.wrap=function(I){var n=this,l=this._readableState,b=!1;for(var R in I.on("end",function(){if(t("wrapped end"),l.decoder&&!l.ended){var z=l.decoder.end();z&&z.length&&n.push(z)}n.push(null)}),I.on("data",function(z){t("wrapped data"),l.decoder&&(z=l.decoder.write(z)),l.objectMode&&z==null||(l.objectMode||z&&z.length)&&(n.push(z)||(b=!0,I.pause()))}),I)this[R]===void 0&&typeof I[R]=="function"&&(this[R]=function(z){return function(){return I[z].apply(I,arguments)}}(R));for(var U=0;U<V.length;U++)I.on(V[U],this.emit.bind(this,V[U]));return this._read=function(z){t("wrapped _read",z),b&&(b=!1,I.resume())},this},typeof Symbol=="function"&&(d.prototype[Symbol.asyncIterator]=function(){return f===void 0&&(f=p("./internal/streams/async_iterator")),f(this)}),Object.defineProperty(d.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(d.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(d.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(I){this._readableState&&(this._readableState.flowing=I)}}),d._fromList=W,Object.defineProperty(d.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(d.from=function(I,n){return h===void 0&&(h=p("./internal/streams/from")),h(d,I,n)})}).call(this)}).call(this,p("_process"),typeof wt<"u"?wt:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":33,"./_stream_duplex":34,"./internal/streams/async_iterator":39,"./internal/streams/buffer_list":40,"./internal/streams/destroy":41,"./internal/streams/from":43,"./internal/streams/state":45,"./internal/streams/stream":46,_process:102,buffer:29,events:49,inherits:51,"string_decoder/":136,util:26}],37:[function(p,L,v){L.exports=t;var a=p("../errors").codes,c=a.ERR_METHOD_NOT_IMPLEMENTED,g=a.ERR_MULTIPLE_CALLBACK,u=a.ERR_TRANSFORM_ALREADY_TRANSFORMING,r=a.ERR_TRANSFORM_WITH_LENGTH_0,o=p("./_stream_duplex");function s(f,h){var m=this._transformState;m.transforming=!1;var y=m.writecb;if(y===null)return this.emit("error",new g);m.writechunk=null,m.writecb=null,h!=null&&this.push(h),y(f);var E=this._readableState;E.reading=!1,(E.needReadable||E.length<E.highWaterMark)&&this._read(E.highWaterMark)}function t(f){if(!(this instanceof t))return new t(f);o.call(this,f),this._transformState={afterTransform:s.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,f&&(typeof f.transform=="function"&&(this._transform=f.transform),typeof f.flush=="function"&&(this._flush=f.flush)),this.on("prefinish",e)}function e(){var f=this;typeof this._flush!="function"||this._readableState.destroyed?i(this,null,null):this._flush(function(h,m){i(f,h,m)})}function i(f,h,m){if(h)return f.emit("error",h);if(m!=null&&f.push(m),f._writableState.length)throw new r;if(f._transformState.transforming)throw new u;return f.push(null)}p("inherits")(t,o),t.prototype.push=function(f,h){return this._transformState.needTransform=!1,o.prototype.push.call(this,f,h)},t.prototype._transform=function(f,h,m){m(new c("_transform()"))},t.prototype._write=function(f,h,m){var y=this._transformState;if(y.writecb=m,y.writechunk=f,y.writeencoding=h,!y.transforming){var E=this._readableState;(y.needTransform||E.needReadable||E.length<E.highWaterMark)&&this._read(E.highWaterMark)}},t.prototype._read=function(f){var h=this._transformState;h.writechunk===null||h.transforming?h.needTransform=!0:(h.transforming=!0,this._transform(h.writechunk,h.writeencoding,h.afterTransform))},t.prototype._destroy=function(f,h){o.prototype._destroy.call(this,f,function(m){h(m)})}},{"../errors":33,"./_stream_duplex":34,inherits:51}],38:[function(p,L,v){(function(a,c){(function(){function g(S){var C=this;this.next=null,this.entry=null,this.finish=function(){(function($,B,H){var F=$.entry;for($.entry=null;F;){var W=F.callback;B.pendingcb--,W(H),F=F.next}B.corkedRequestsFree.next=$})(C,S)}}var u;L.exports=d,d.WritableState=D;var r={deprecate:p("util-deprecate")},o=p("./internal/streams/stream"),s=p("buffer").Buffer,t=c.Uint8Array||function(){},e,i=p("./internal/streams/destroy"),f=p("./internal/streams/state").getHighWaterMark,h=p("../errors").codes,m=h.ERR_INVALID_ARG_TYPE,y=h.ERR_METHOD_NOT_IMPLEMENTED,E=h.ERR_MULTIPLE_CALLBACK,P=h.ERR_STREAM_CANNOT_PIPE,M=h.ERR_STREAM_DESTROYED,k=h.ERR_STREAM_NULL_VALUES,w=h.ERR_STREAM_WRITE_AFTER_END,_=h.ERR_UNKNOWN_ENCODING,x=i.errorOrDestroy;function V(){}function D(S,C,$){u=u||p("./_stream_duplex"),S=S||{},typeof $!="boolean"&&($=C instanceof u),this.objectMode=!!S.objectMode,$&&(this.objectMode=this.objectMode||!!S.writableObjectMode),this.highWaterMark=f(this,S,"writableHighWaterMark",$),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var B=S.decodeStrings===!1;this.decodeStrings=!B,this.defaultEncoding=S.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(H){(function(F,W){var J=F._writableState,Y=J.sync,Z=J.writecb;if(typeof Z!="function")throw new E;if(function(n){n.writing=!1,n.writecb=null,n.length-=n.writelen,n.writelen=0}(J),W)(function(n,l,b,R,U){--l.pendingcb,b?(a.nextTick(U,R),a.nextTick(O,n,l),n._writableState.errorEmitted=!0,x(n,R)):(U(R),n._writableState.errorEmitted=!0,x(n,R),O(n,l))})(F,J,Y,W,Z);else{var I=Q(J)||F.destroyed;I||J.corked||J.bufferProcessing||!J.bufferedRequest||G(F,J),Y?a.nextTick(A,F,J,I,Z):A(F,J,I,Z)}})(C,H)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=S.emitClose!==!1,this.autoDestroy=!!S.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new g(this)}function d(S){var C=this instanceof(u=u||p("./_stream_duplex"));if(!C&&!e.call(d,this))return new d(S);this._writableState=new D(S,this,C),this.writable=!0,S&&(typeof S.write=="function"&&(this._write=S.write),typeof S.writev=="function"&&(this._writev=S.writev),typeof S.destroy=="function"&&(this._destroy=S.destroy),typeof S.final=="function"&&(this._final=S.final)),o.call(this)}function T(S,C,$,B,H,F,W){C.writelen=B,C.writecb=W,C.writing=!0,C.sync=!0,C.destroyed?C.onwrite(new M("write")):$?S._writev(H,C.onwrite):S._write(H,F,C.onwrite),C.sync=!1}function A(S,C,$,B){$||function(H,F){F.length===0&&F.needDrain&&(F.needDrain=!1,H.emit("drain"))}(S,C),C.pendingcb--,B(),O(S,C)}function G(S,C){C.bufferProcessing=!0;var $=C.bufferedRequest;if(S._writev&&$&&$.next){var B=C.bufferedRequestCount,H=new Array(B),F=C.corkedRequestsFree;F.entry=$;for(var W=0,J=!0;$;)H[W]=$,$.isBuf||(J=!1),$=$.next,W+=1;H.allBuffers=J,T(S,C,!0,C.length,H,"",F.finish),C.pendingcb++,C.lastBufferedRequest=null,F.next?(C.corkedRequestsFree=F.next,F.next=null):C.corkedRequestsFree=new g(C),C.bufferedRequestCount=0}else{for(;$;){var Y=$.chunk,Z=$.encoding,I=$.callback;if(T(S,C,!1,C.objectMode?1:Y.length,Y,Z,I),$=$.next,C.bufferedRequestCount--,C.writing)break}$===null&&(C.lastBufferedRequest=null)}C.bufferedRequest=$,C.bufferProcessing=!1}function Q(S){return S.ending&&S.length===0&&S.bufferedRequest===null&&!S.finished&&!S.writing}function X(S,C){S._final(function($){C.pendingcb--,$&&x(S,$),C.prefinished=!0,S.emit("prefinish"),O(S,C)})}function O(S,C){var $=Q(C);if($&&(function(H,F){F.prefinished||F.finalCalled||(typeof H._final!="function"||F.destroyed?(F.prefinished=!0,H.emit("prefinish")):(F.pendingcb++,F.finalCalled=!0,a.nextTick(X,H,F)))}(S,C),C.pendingcb===0&&(C.finished=!0,S.emit("finish"),C.autoDestroy))){var B=S._readableState;(!B||B.autoDestroy&&B.endEmitted)&&S.destroy()}return $}p("inherits")(d,o),D.prototype.getBuffer=function(){for(var S=this.bufferedRequest,C=[];S;)C.push(S),S=S.next;return C},function(){try{Object.defineProperty(D.prototype,"buffer",{get:r.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(e=Function.prototype[Symbol.hasInstance],Object.defineProperty(d,Symbol.hasInstance,{value:function(S){return!!e.call(this,S)||this===d&&S&&S._writableState instanceof D}})):e=function(S){return S instanceof this},d.prototype.pipe=function(){x(this,new P)},d.prototype.write=function(S,C,$){var B,H=this._writableState,F=!1,W=!H.objectMode&&(B=S,s.isBuffer(B)||B instanceof t);return W&&!s.isBuffer(S)&&(S=function(J){return s.from(J)}(S)),typeof C=="function"&&($=C,C=null),W?C="buffer":C||(C=H.defaultEncoding),typeof $!="function"&&($=V),H.ending?function(J,Y){var Z=new w;x(J,Z),a.nextTick(Y,Z)}(this,$):(W||function(J,Y,Z,I){var n;return Z===null?n=new k:typeof Z=="string"||Y.objectMode||(n=new m("chunk",["string","Buffer"],Z)),!n||(x(J,n),a.nextTick(I,n),!1)}(this,H,S,$))&&(H.pendingcb++,F=function(J,Y,Z,I,n,l){if(!Z){var b=function(j,K,tt){return j.objectMode||j.decodeStrings===!1||typeof K!="string"||(K=s.from(K,tt)),K}(Y,I,n);I!==b&&(Z=!0,n="buffer",I=b)}var R=Y.objectMode?1:I.length;Y.length+=R;var U=Y.length<Y.highWaterMark;if(U||(Y.needDrain=!0),Y.writing||Y.corked){var z=Y.lastBufferedRequest;Y.lastBufferedRequest={chunk:I,encoding:n,isBuf:Z,callback:l,next:null},z?z.next=Y.lastBufferedRequest:Y.bufferedRequest=Y.lastBufferedRequest,Y.bufferedRequestCount+=1}else T(J,Y,!1,R,I,n,l);return U}(this,H,W,S,C,$)),F},d.prototype.cork=function(){this._writableState.corked++},d.prototype.uncork=function(){var S=this._writableState;S.corked&&(S.corked--,S.writing||S.corked||S.bufferProcessing||!S.bufferedRequest||G(this,S))},d.prototype.setDefaultEncoding=function(S){if(typeof S=="string"&&(S=S.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((S+"").toLowerCase())>-1))throw new _(S);return this._writableState.defaultEncoding=S,this},Object.defineProperty(d.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),d.prototype._write=function(S,C,$){$(new y("_write()"))},d.prototype._writev=null,d.prototype.end=function(S,C,$){var B=this._writableState;return typeof S=="function"?($=S,S=null,C=null):typeof C=="function"&&($=C,C=null),S!=null&&this.write(S,C),B.corked&&(B.corked=1,this.uncork()),B.ending||function(H,F,W){F.ending=!0,O(H,F),W&&(F.finished?a.nextTick(W):H.once("finish",W)),F.ended=!0,H.writable=!1}(this,B,$),this},Object.defineProperty(d.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(d.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(S){this._writableState&&(this._writableState.destroyed=S)}}),d.prototype.destroy=i.destroy,d.prototype._undestroy=i.undestroy,d.prototype._destroy=function(S,C){C(S)}}).call(this)}).call(this,p("_process"),typeof wt<"u"?wt:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":33,"./_stream_duplex":34,"./internal/streams/destroy":41,"./internal/streams/state":45,"./internal/streams/stream":46,_process:102,buffer:29,inherits:51,"util-deprecate":139}],39:[function(p,L,v){(function(a){(function(){var c;function g(M,k,w){return k in M?Object.defineProperty(M,k,{value:w,enumerable:!0,configurable:!0,writable:!0}):M[k]=w,M}var u=p("./end-of-stream"),r=Symbol("lastResolve"),o=Symbol("lastReject"),s=Symbol("error"),t=Symbol("ended"),e=Symbol("lastPromise"),i=Symbol("handlePromise"),f=Symbol("stream");function h(M,k){return{value:M,done:k}}function m(M){var k=M[r];if(k!==null){var w=M[f].read();w!==null&&(M[e]=null,M[r]=null,M[o]=null,k(h(w,!1)))}}function y(M){a.nextTick(m,M)}var E=Object.getPrototypeOf(function(){}),P=Object.setPrototypeOf((g(c={get stream(){return this[f]},next:function(){var M=this,k=this[s];if(k!==null)return Promise.reject(k);if(this[t])return Promise.resolve(h(void 0,!0));if(this[f].destroyed)return new Promise(function(V,D){a.nextTick(function(){M[s]?D(M[s]):V(h(void 0,!0))})});var w,_=this[e];if(_)w=new Promise(function(V,D){return function(d,T){V.then(function(){D[t]?d(h(void 0,!0)):D[i](d,T)},T)}}(_,this));else{var x=this[f].read();if(x!==null)return Promise.resolve(h(x,!1));w=new Promise(this[i])}return this[e]=w,w}},Symbol.asyncIterator,function(){return this}),g(c,"return",function(){var M=this;return new Promise(function(k,w){M[f].destroy(null,function(_){_?w(_):k(h(void 0,!0))})})}),c),E);L.exports=function(M){var k,w=Object.create(P,(g(k={},f,{value:M,writable:!0}),g(k,r,{value:null,writable:!0}),g(k,o,{value:null,writable:!0}),g(k,s,{value:null,writable:!0}),g(k,t,{value:M._readableState.endEmitted,writable:!0}),g(k,i,{value:function(_,x){var V=w[f].read();V?(w[e]=null,w[r]=null,w[o]=null,_(h(V,!1))):(w[r]=_,w[o]=x)},writable:!0}),k));return w[e]=null,u(M,function(_){if(_&&_.code!=="ERR_STREAM_PREMATURE_CLOSE"){var x=w[o];return x!==null&&(w[e]=null,w[r]=null,w[o]=null,x(_)),void(w[s]=_)}var V=w[r];V!==null&&(w[e]=null,w[r]=null,w[o]=null,V(h(void 0,!0))),w[t]=!0}),M.on("readable",y.bind(null,w)),w}}).call(this)}).call(this,p("_process"))},{"./end-of-stream":42,_process:102}],40:[function(p,L,v){function a(s,t){var e=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);t&&(i=i.filter(function(f){return Object.getOwnPropertyDescriptor(s,f).enumerable})),e.push.apply(e,i)}return e}function c(s,t,e){return t in s?Object.defineProperty(s,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):s[t]=e,s}function g(s,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(s,i.key,i)}}var u=p("buffer").Buffer,r=p("util").inspect,o=r&&r.custom||"inspect";L.exports=function(){function s(){(function(i,f){if(!(i instanceof f))throw new TypeError("Cannot call a class as a function")})(this,s),this.head=null,this.tail=null,this.length=0}var t,e;return t=s,e=[{key:"push",value:function(i){var f={data:i,next:null};this.length>0?this.tail.next=f:this.head=f,this.tail=f,++this.length}},{key:"unshift",value:function(i){var f={data:i,next:this.head};this.length===0&&(this.tail=f),this.head=f,++this.length}},{key:"shift",value:function(){if(this.length!==0){var i=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,i}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(i){if(this.length===0)return"";for(var f=this.head,h=""+f.data;f=f.next;)h+=i+f.data;return h}},{key:"concat",value:function(i){if(this.length===0)return u.alloc(0);for(var f,h,m,y=u.allocUnsafe(i>>>0),E=this.head,P=0;E;)f=E.data,h=y,m=P,u.prototype.copy.call(f,h,m),P+=E.data.length,E=E.next;return y}},{key:"consume",value:function(i,f){var h;return i<this.head.data.length?(h=this.head.data.slice(0,i),this.head.data=this.head.data.slice(i)):h=i===this.head.data.length?this.shift():f?this._getString(i):this._getBuffer(i),h}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(i){var f=this.head,h=1,m=f.data;for(i-=m.length;f=f.next;){var y=f.data,E=i>y.length?y.length:i;if(E===y.length?m+=y:m+=y.slice(0,i),(i-=E)==0){E===y.length?(++h,f.next?this.head=f.next:this.head=this.tail=null):(this.head=f,f.data=y.slice(E));break}++h}return this.length-=h,m}},{key:"_getBuffer",value:function(i){var f=u.allocUnsafe(i),h=this.head,m=1;for(h.data.copy(f),i-=h.data.length;h=h.next;){var y=h.data,E=i>y.length?y.length:i;if(y.copy(f,f.length-i,0,E),(i-=E)==0){E===y.length?(++m,h.next?this.head=h.next:this.head=this.tail=null):(this.head=h,h.data=y.slice(E));break}++m}return this.length-=m,f}},{key:o,value:function(i,f){return r(this,function(h){for(var m=1;m<arguments.length;m++){var y=arguments[m]!=null?arguments[m]:{};m%2?a(Object(y),!0).forEach(function(E){c(h,E,y[E])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(y)):a(Object(y)).forEach(function(E){Object.defineProperty(h,E,Object.getOwnPropertyDescriptor(y,E))})}return h}({},f,{depth:0,customInspect:!1}))}}],e&&g(t.prototype,e),s}()},{buffer:29,util:26}],41:[function(p,L,v){(function(a){(function(){function c(r,o){u(r,o),g(r)}function g(r){r._writableState&&!r._writableState.emitClose||r._readableState&&!r._readableState.emitClose||r.emit("close")}function u(r,o){r.emit("error",o)}L.exports={destroy:function(r,o){var s=this,t=this._readableState&&this._readableState.destroyed,e=this._writableState&&this._writableState.destroyed;return t||e?(o?o(r):r&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,a.nextTick(u,this,r)):a.nextTick(u,this,r)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(r||null,function(i){!o&&i?s._writableState?s._writableState.errorEmitted?a.nextTick(g,s):(s._writableState.errorEmitted=!0,a.nextTick(c,s,i)):a.nextTick(c,s,i):o?(a.nextTick(g,s),o(i)):a.nextTick(g,s)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(r,o){var s=r._readableState,t=r._writableState;s&&s.autoDestroy||t&&t.autoDestroy?r.destroy(o):r.emit("error",o)}}}).call(this)}).call(this,p("_process"))},{_process:102}],42:[function(p,L,v){var a=p("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function c(){}L.exports=function g(u,r,o){if(typeof r=="function")return g(u,null,r);r||(r={}),o=function(M){var k=!1;return function(){if(!k){k=!0;for(var w=arguments.length,_=new Array(w),x=0;x<w;x++)_[x]=arguments[x];M.apply(this,_)}}}(o||c);var s=r.readable||r.readable!==!1&&u.readable,t=r.writable||r.writable!==!1&&u.writable,e=function(){u.writable||f()},i=u._writableState&&u._writableState.finished,f=function(){t=!1,i=!0,s||o.call(u)},h=u._readableState&&u._readableState.endEmitted,m=function(){s=!1,h=!0,t||o.call(u)},y=function(M){o.call(u,M)},E=function(){var M;return s&&!h?(u._readableState&&u._readableState.ended||(M=new a),o.call(u,M)):t&&!i?(u._writableState&&u._writableState.ended||(M=new a),o.call(u,M)):void 0},P=function(){u.req.on("finish",f)};return function(M){return M.setHeader&&typeof M.abort=="function"}(u)?(u.on("complete",f),u.on("abort",E),u.req?P():u.on("request",P)):t&&!u._writableState&&(u.on("end",e),u.on("close",e)),u.on("end",m),u.on("finish",f),r.error!==!1&&u.on("error",y),u.on("close",E),function(){u.removeListener("complete",f),u.removeListener("abort",E),u.removeListener("request",P),u.req&&u.req.removeListener("finish",f),u.removeListener("end",e),u.removeListener("close",e),u.removeListener("finish",f),u.removeListener("end",m),u.removeListener("error",y),u.removeListener("close",E)}}},{"../../../errors":33}],43:[function(p,L,v){L.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],44:[function(p,L,v){var a,c=p("../../../errors").codes,g=c.ERR_MISSING_ARGS,u=c.ERR_STREAM_DESTROYED;function r(t){if(t)throw t}function o(t){t()}function s(t,e){return t.pipe(e)}L.exports=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];var f,h=function(y){return y.length?typeof y[y.length-1]!="function"?r:y.pop():r}(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new g("streams");var m=e.map(function(y,E){var P=E<e.length-1;return function(M,k,w,_){_=function(D){var d=!1;return function(){d||(d=!0,D.apply(void 0,arguments))}}(_);var x=!1;M.on("close",function(){x=!0}),a===void 0&&(a=p("./end-of-stream")),a(M,{readable:k,writable:w},function(D){if(D)return _(D);x=!0,_()});var V=!1;return function(D){if(!x&&!V)return V=!0,function(d){return d.setHeader&&typeof d.abort=="function"}(M)?M.abort():typeof M.destroy=="function"?M.destroy():void _(D||new u("pipe"))}}(y,P,E>0,function(M){f||(f=M),M&&m.forEach(o),P||(m.forEach(o),h(f))})});return e.reduce(s)}},{"../../../errors":33,"./end-of-stream":42}],45:[function(p,L,v){var a=p("../../../errors").codes.ERR_INVALID_OPT_VALUE;L.exports={getHighWaterMark:function(c,g,u,r){var o=function(s,t,e){return s.highWaterMark!=null?s.highWaterMark:t?s[e]:null}(g,r,u);if(o!=null){if(!isFinite(o)||Math.floor(o)!==o||o<0)throw new a(r?u:"highWaterMark",o);return Math.floor(o)}return c.objectMode?16:16384}}},{"../../../errors":33}],46:[function(p,L,v){L.exports=p("events").EventEmitter},{events:49}],47:[function(p,L,v){(v=L.exports=p("./lib/_stream_readable.js")).Stream=v,v.Readable=v,v.Writable=p("./lib/_stream_writable.js"),v.Duplex=p("./lib/_stream_duplex.js"),v.Transform=p("./lib/_stream_transform.js"),v.PassThrough=p("./lib/_stream_passthrough.js"),v.finished=p("./lib/internal/streams/end-of-stream.js"),v.pipeline=p("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":34,"./lib/_stream_passthrough.js":35,"./lib/_stream_readable.js":36,"./lib/_stream_transform.js":37,"./lib/_stream_writable.js":38,"./lib/internal/streams/end-of-stream.js":42,"./lib/internal/streams/pipeline.js":44}],48:[function(p,L,v){(function(a){(function(){var c=p("once"),g=function(){},u=function(r,o,s){if(typeof o=="function")return u(r,null,o);o||(o={}),s=c(s||g);var t=r._writableState,e=r._readableState,i=o.readable||o.readable!==!1&&r.readable,f=o.writable||o.writable!==!1&&r.writable,h=!1,m=function(){r.writable||y()},y=function(){f=!1,i||s.call(r)},E=function(){i=!1,f||s.call(r)},P=function(x){s.call(r,x?new Error("exited with error code: "+x):null)},M=function(x){s.call(r,x)},k=function(){a.nextTick(w)},w=function(){if(!h)return(!i||e&&e.ended&&!e.destroyed)&&(!f||t&&t.ended&&!t.destroyed)?void 0:s.call(r,new Error("premature close"))},_=function(){r.req.on("finish",y)};return function(x){return x.setHeader&&typeof x.abort=="function"}(r)?(r.on("complete",y),r.on("abort",k),r.req?_():r.on("request",_)):f&&!t&&(r.on("end",m),r.on("close",m)),function(x){return x.stdio&&Array.isArray(x.stdio)&&x.stdio.length===3}(r)&&r.on("exit",P),r.on("end",E),r.on("finish",y),o.error!==!1&&r.on("error",M),r.on("close",k),function(){h=!0,r.removeListener("complete",y),r.removeListener("abort",k),r.removeListener("request",_),r.req&&r.req.removeListener("finish",y),r.removeListener("end",m),r.removeListener("close",m),r.removeListener("finish",y),r.removeListener("exit",P),r.removeListener("end",E),r.removeListener("error",M),r.removeListener("close",k)}};L.exports=u}).call(this)}).call(this,p("_process"))},{_process:102,once:100}],49:[function(p,L,v){var a,c=typeof Reflect=="object"?Reflect:null,g=c&&typeof c.apply=="function"?c.apply:function(P,M,k){return Function.prototype.apply.call(P,M,k)};a=c&&typeof c.ownKeys=="function"?c.ownKeys:Object.getOwnPropertySymbols?function(P){return Object.getOwnPropertyNames(P).concat(Object.getOwnPropertySymbols(P))}:function(P){return Object.getOwnPropertyNames(P)};var u=Number.isNaN||function(P){return P!=P};function r(){r.init.call(this)}L.exports=r,L.exports.once=function(P,M){return new Promise(function(k,w){function _(V){P.removeListener(M,x),w(V)}function x(){typeof P.removeListener=="function"&&P.removeListener("error",_),k([].slice.call(arguments))}E(P,M,x,{once:!0}),M!=="error"&&function(V,D,d){typeof V.on=="function"&&E(V,"error",D,d)}(P,_,{once:!0})})},r.EventEmitter=r,r.prototype._events=void 0,r.prototype._eventsCount=0,r.prototype._maxListeners=void 0;var o=10;function s(P){if(typeof P!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof P)}function t(P){return P._maxListeners===void 0?r.defaultMaxListeners:P._maxListeners}function e(P,M,k,w){var _,x,V,D;if(s(k),(x=P._events)===void 0?(x=P._events=Object.create(null),P._eventsCount=0):(x.newListener!==void 0&&(P.emit("newListener",M,k.listener?k.listener:k),x=P._events),V=x[M]),V===void 0)V=x[M]=k,++P._eventsCount;else if(typeof V=="function"?V=x[M]=w?[k,V]:[V,k]:w?V.unshift(k):V.push(k),(_=t(P))>0&&V.length>_&&!V.warned){V.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+V.length+" "+String(M)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=P,d.type=M,d.count=V.length,D=d,console&&console.warn&&console.warn(D)}return P}function i(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(P,M,k){var w={fired:!1,wrapFn:void 0,target:P,type:M,listener:k},_=i.bind(w);return _.listener=k,w.wrapFn=_,_}function h(P,M,k){var w=P._events;if(w===void 0)return[];var _=w[M];return _===void 0?[]:typeof _=="function"?k?[_.listener||_]:[_]:k?function(x){for(var V=new Array(x.length),D=0;D<V.length;++D)V[D]=x[D].listener||x[D];return V}(_):y(_,_.length)}function m(P){var M=this._events;if(M!==void 0){var k=M[P];if(typeof k=="function")return 1;if(k!==void 0)return k.length}return 0}function y(P,M){for(var k=new Array(M),w=0;w<M;++w)k[w]=P[w];return k}function E(P,M,k,w){if(typeof P.on=="function")w.once?P.once(M,k):P.on(M,k);else{if(typeof P.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof P);P.addEventListener(M,function _(x){w.once&&P.removeEventListener(M,_),k(x)})}}Object.defineProperty(r,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(P){if(typeof P!="number"||P<0||u(P))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+P+".");o=P}}),r.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},r.prototype.setMaxListeners=function(P){if(typeof P!="number"||P<0||u(P))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+P+".");return this._maxListeners=P,this},r.prototype.getMaxListeners=function(){return t(this)},r.prototype.emit=function(P){for(var M=[],k=1;k<arguments.length;k++)M.push(arguments[k]);var w=P==="error",_=this._events;if(_!==void 0)w=w&&_.error===void 0;else if(!w)return!1;if(w){var x;if(M.length>0&&(x=M[0]),x instanceof Error)throw x;var V=new Error("Unhandled error."+(x?" ("+x.message+")":""));throw V.context=x,V}var D=_[P];if(D===void 0)return!1;if(typeof D=="function")g(D,this,M);else{var d=D.length,T=y(D,d);for(k=0;k<d;++k)g(T[k],this,M)}return!0},r.prototype.addListener=function(P,M){return e(this,P,M,!1)},r.prototype.on=r.prototype.addListener,r.prototype.prependListener=function(P,M){return e(this,P,M,!0)},r.prototype.once=function(P,M){return s(M),this.on(P,f(this,P,M)),this},r.prototype.prependOnceListener=function(P,M){return s(M),this.prependListener(P,f(this,P,M)),this},r.prototype.removeListener=function(P,M){var k,w,_,x,V;if(s(M),(w=this._events)===void 0)return this;if((k=w[P])===void 0)return this;if(k===M||k.listener===M)--this._eventsCount==0?this._events=Object.create(null):(delete w[P],w.removeListener&&this.emit("removeListener",P,k.listener||M));else if(typeof k!="function"){for(_=-1,x=k.length-1;x>=0;x--)if(k[x]===M||k[x].listener===M){V=k[x].listener,_=x;break}if(_<0)return this;_===0?k.shift():function(D,d){for(;d+1<D.length;d++)D[d]=D[d+1];D.pop()}(k,_),k.length===1&&(w[P]=k[0]),w.removeListener!==void 0&&this.emit("removeListener",P,V||M)}return this},r.prototype.off=r.prototype.removeListener,r.prototype.removeAllListeners=function(P){var M,k,w;if((k=this._events)===void 0)return this;if(k.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):k[P]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete k[P]),this;if(arguments.length===0){var _,x=Object.keys(k);for(w=0;w<x.length;++w)(_=x[w])!=="removeListener"&&this.removeAllListeners(_);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(M=k[P])=="function")this.removeListener(P,M);else if(M!==void 0)for(w=M.length-1;w>=0;w--)this.removeListener(P,M[w]);return this},r.prototype.listeners=function(P){return h(this,P,!0)},r.prototype.rawListeners=function(P){return h(this,P,!1)},r.listenerCount=function(P,M){return typeof P.listenerCount=="function"?P.listenerCount(M):m.call(P,M)},r.prototype.listenerCount=m,r.prototype.eventNames=function(){return this._eventsCount>0?a(this._events):[]}},{}],50:[function(p,L,v){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */v.read=function(a,c,g,u,r){var o,s,t=8*r-u-1,e=(1<<t)-1,i=e>>1,f=-7,h=g?r-1:0,m=g?-1:1,y=a[c+h];for(h+=m,o=y&(1<<-f)-1,y>>=-f,f+=t;f>0;o=256*o+a[c+h],h+=m,f-=8);for(s=o&(1<<-f)-1,o>>=-f,f+=u;f>0;s=256*s+a[c+h],h+=m,f-=8);if(o===0)o=1-i;else{if(o===e)return s?NaN:1/0*(y?-1:1);s+=Math.pow(2,u),o-=i}return(y?-1:1)*s*Math.pow(2,o-u)},v.write=function(a,c,g,u,r,o){var s,t,e,i=8*o-r-1,f=(1<<i)-1,h=f>>1,m=r===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=u?0:o-1,E=u?1:-1,P=c<0||c===0&&1/c<0?1:0;for(c=Math.abs(c),isNaN(c)||c===1/0?(t=isNaN(c)?1:0,s=f):(s=Math.floor(Math.log(c)/Math.LN2),c*(e=Math.pow(2,-s))<1&&(s--,e*=2),(c+=s+h>=1?m/e:m*Math.pow(2,1-h))*e>=2&&(s++,e/=2),s+h>=f?(t=0,s=f):s+h>=1?(t=(c*e-1)*Math.pow(2,r),s+=h):(t=c*Math.pow(2,h-1)*Math.pow(2,r),s=0));r>=8;a[g+y]=255&t,y+=E,t/=256,r-=8);for(s=s<<r|t,i+=r;i>0;a[g+y]=255&s,y+=E,s/=256,i-=8);a[g+y-E]|=128*P}},{}],51:[function(p,L,v){typeof Object.create=="function"?L.exports=function(a,c){c&&(a.super_=c,a.prototype=Object.create(c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}))}:L.exports=function(a,c){if(c){a.super_=c;var g=function(){};g.prototype=c.prototype,a.prototype=new g,a.prototype.constructor=a}}},{}],52:[function(p,L,v){Object.defineProperty(v,"t",{value:!0}),v.ContainerIterator=v.Container=v.Base=void 0,v.ContainerIterator=class{constructor(c=0){this.iteratorType=c}equals(c){return this.o===c.o}};class a{constructor(){this.i=0}get length(){return this.i}size(){return this.i}empty(){return this.i===0}}v.Base=a,v.Container=class extends a{}},{}],53:[function(p,L,v){Object.defineProperty(v,"t",{value:!0}),v.HashContainerIterator=v.HashContainer=void 0;var a,c=p("../../ContainerBase"),g=(a=p("../../../utils/checkObject"))&&a.t?a:{default:a},u=p("../../../utils/throwError");class r extends c.ContainerIterator{constructor(t,e,i){super(i),this.o=t,this.h=e,this.iteratorType===0?(this.pre=function(){return this.o.L===this.h&&(0,u.throwIteratorAccessError)(),this.o=this.o.L,this},this.next=function(){return this.o===this.h&&(0,u.throwIteratorAccessError)(),this.o=this.o.B,this}):(this.pre=function(){return this.o.B===this.h&&(0,u.throwIteratorAccessError)(),this.o=this.o.B,this},this.next=function(){return this.o===this.h&&(0,u.throwIteratorAccessError)(),this.o=this.o.L,this})}}v.HashContainerIterator=r;class o extends c.Container{constructor(){super(),this.H=[],this.g={},this.HASH_TAG=Symbol("@@HASH_TAG"),Object.setPrototypeOf(this.g,null),this.h={},this.h.L=this.h.B=this.p=this._=this.h}V(t){const{L:e,B:i}=t;e.B=i,i.L=e,t===this.p&&(this.p=i),t===this._&&(this._=e),this.i-=1}M(t,e,i){let f;if(i===void 0&&(i=(0,g.default)(t)),i){const h=t[this.HASH_TAG];if(h!==void 0)return this.H[h].l=e,this.i;Object.defineProperty(t,this.HASH_TAG,{value:this.H.length,configurable:!0}),f={u:t,l:e,L:this._,B:this.h},this.H.push(f)}else{const h=this.g[t];if(h)return h.l=e,this.i;f={u:t,l:e,L:this._,B:this.h},this.g[t]=f}return this.i===0?(this.p=f,this.h.B=f):this._.B=f,this._=f,this.h.L=f,++this.i}I(t,e){if(e===void 0&&(e=(0,g.default)(t)),e){const i=t[this.HASH_TAG];return i===void 0?this.h:this.H[i]}return this.g[t]||this.h}clear(){const t=this.HASH_TAG;this.H.forEach(function(e){delete e.u[t]}),this.H=[],this.g={},Object.setPrototypeOf(this.g,null),this.i=0,this.p=this._=this.h.L=this.h.B=this.h}eraseElementByKey(t,e){let i;if(e===void 0&&(e=(0,g.default)(t)),e){const f=t[this.HASH_TAG];if(f===void 0)return!1;delete t[this.HASH_TAG],i=this.H[f],delete this.H[f]}else{if(i=this.g[t],i===void 0)return!1;delete this.g[t]}return this.V(i),!0}eraseElementByIterator(t){const e=t.o;return e===this.h&&(0,u.throwIteratorAccessError)(),this.V(e),t.next()}eraseElementByPos(t){if(t<0||t>this.i-1)throw new RangeError;let e=this.p;for(;t--;)e=e.B;return this.V(e),this.i}}v.HashContainer=o},{"../../../utils/checkObject":70,"../../../utils/throwError":71,"../../ContainerBase":52}],54:[function(p,L,v){Object.defineProperty(v,"t",{value:!0}),v.default=void 0;var a,c=p("./Base"),g=(a=p("../../utils/checkObject"))&&a.t?a:{default:a},u=p("../../utils/throwError");class r extends c.HashContainerIterator{constructor(e,i,f,h){super(e,i,h),this.container=f}get pointer(){this.o===this.h&&(0,u.throwIteratorAccessError)();const e=this;return new Proxy([],{get:(i,f)=>f==="0"?e.o.u:f==="1"?e.o.l:void 0,set(i,f,h){if(f!=="1")throw new TypeError("props must be 1");return e.o.l=h,!0}})}copy(){return new r(this.o,this.h,this.container,this.iteratorType)}}class o extends c.HashContainer{constructor(e=[]){super();const i=this;e.forEach(function(f){i.setElement(f[0],f[1])})}begin(){return new r(this.p,this.h,this)}end(){return new r(this.h,this.h,this)}rBegin(){return new r(this._,this.h,this,1)}rEnd(){return new r(this.h,this.h,this,1)}front(){if(this.i!==0)return[this.p.u,this.p.l]}back(){if(this.i!==0)return[this._.u,this._.l]}setElement(e,i,f){return this.M(e,i,f)}getElementByKey(e,i){if(i===void 0&&(i=(0,g.default)(e)),i){const h=e[this.HASH_TAG];return h!==void 0?this.H[h].l:void 0}const f=this.g[e];return f?f.l:void 0}getElementByPos(e){if(e<0||e>this.i-1)throw new RangeError;let i=this.p;for(;e--;)i=i.B;return[i.u,i.l]}find(e,i){const f=this.I(e,i);return new r(f,this.h,this)}forEach(e){let i=0,f=this.p;for(;f!==this.h;)e([f.u,f.l],i++,this),f=f.B}[Symbol.iterator](){return(function*(){let e=this.p;for(;e!==this.h;)yield[e.u,e.l],e=e.B}).bind(this)()}}var s=o;v.default=s},{"../../utils/checkObject":70,"../../utils/throwError":71,"./Base":53}],55:[function(p,L,v){Object.defineProperty(v,"t",{value:!0}),v.default=void 0;var a=p("./Base"),c=p("../../utils/throwError");class g extends a.HashContainerIterator{constructor(s,t,e,i){super(s,t,i),this.container=e}get pointer(){return this.o===this.h&&(0,c.throwIteratorAccessError)(),this.o.u}copy(){return new g(this.o,this.h,this.container,this.iteratorType)}}class u extends a.HashContainer{constructor(s=[]){super();const t=this;s.forEach(function(e){t.insert(e)})}begin(){return new g(this.p,this.h,this)}end(){return new g(this.h,this.h,this)}rBegin(){return new g(this._,this.h,this,1)}rEnd(){return new g(this.h,this.h,this,1)}front(){return this.p.u}back(){return this._.u}insert(s,t){return this.M(s,void 0,t)}getElementByPos(s){if(s<0||s>this.i-1)throw new RangeError;let t=this.p;for(;s--;)t=t.B;return t.u}find(s,t){const e=this.I(s,t);return new g(e,this.h,this)}forEach(s){let t=0,e=this.p;for(;e!==this.h;)s(e.u,t++,this),e=e.B}[Symbol.iterator](){return(function*(){let s=this.p;for(;s!==this.h;)yield s.u,s=s.B}).bind(this)()}}var r=u;v.default=r},{"../../utils/throwError":71,"./Base":53}],56:[function(p,L,v){Object.defineProperty(v,"t",{value:!0}),v.default=void 0;var a=p("../ContainerBase");class c extends a.Base{constructor(r=[],o=function(t,e){return t>e?-1:t<e?1:0},s=!0){if(super(),this.v=o,Array.isArray(r))this.C=s?[...r]:r;else{this.C=[];const e=this;r.forEach(function(i){e.C.push(i)})}this.i=this.C.length;const t=this.i>>1;for(let e=this.i-1>>1;e>=0;--e)this.k(e,t)}m(r){const o=this.C[r];for(;r>0;){const s=r-1>>1,t=this.C[s];if(this.v(t,o)<=0)break;this.C[r]=t,r=s}this.C[r]=o}k(r,o){const s=this.C[r];for(;r<o;){let t=r<<1|1;const e=t+1;let i=this.C[t];if(e<this.i&&this.v(i,this.C[e])>0&&(t=e,i=this.C[e]),this.v(i,s)>=0)break;this.C[r]=i,r=t}this.C[r]=s}clear(){this.i=0,this.C.length=0}push(r){this.C.push(r),this.m(this.i),this.i+=1}pop(){if(this.i===0)return;const r=this.C[0],o=this.C.pop();return this.i-=1,this.i&&(this.C[0]=o,this.k(0,this.i>>1)),r}top(){return this.C[0]}find(r){return this.C.indexOf(r)>=0}remove(r){const o=this.C.indexOf(r);return!(o<0)&&(o===0?this.pop():o===this.i-1?(this.C.pop(),this.i-=1):(this.C.splice(o,1,this.C.pop()),this.i-=1,this.m(o),this.k(o,this.i>>1)),!0)}updateItem(r){const o=this.C.indexOf(r);return!(o<0)&&(this.m(o),this.k(o,this.i>>1),!0)}toArray(){return[...this.C]}}var g=c;v.default=g},{"../ContainerBase":52}],57:[function(p,L,v){Object.defineProperty(v,"t",{value:!0}),v.default=void 0;var a=p("../ContainerBase");class c extends a.Base{constructor(r=[]){super(),this.j=0,this.q=[];const o=this;r.forEach(function(s){o.push(s)})}clear(){this.q=[],this.i=this.j=0}push(r){const o=this.q.length;if(this.j/o>.5&&this.j+this.i>=o&&o>4096){const s=this.i;for(let t=0;t<s;++t)this.q[t]=this.q[this.j+t];this.j=0,this.q[this.i]=r}else this.q[this.j+this.i]=r;return++this.i}pop(){if(this.i===0)return;const r=this.q[this.j++];return this.i-=1,r}front(){if(this.i!==0)return this.q[this.j]}}var g=c;v.default=g},{"../ContainerBase":52}],58:[function(p,L,v){Object.defineProperty(v,"t",{value:!0}),v.default=void 0;var a=p("../ContainerBase");class c extends a.Base{constructor(r=[]){super(),this.S=[];const o=this;r.forEach(function(s){o.push(s)})}clear(){this.i=0,this.S=[]}push(r){return this.S.push(r),this.i+=1,this.i}pop(){if(this.i!==0)return this.i-=1,this.S.pop()}top(){return this.S[this.i-1]}}var g=c;v.default=g},{"../ContainerBase":52}],59:[function(p,L,v){Object.defineProperty(v,"t",{value:!0}),v.RandomIterator=void 0;var a=p("../../ContainerBase"),c=p("../../../utils/throwError");class g extends a.ContainerIterator{constructor(r,o){super(o),this.o=r,this.iteratorType===0?(this.pre=function(){return this.o===0&&(0,c.throwIteratorAccessError)(),this.o-=1,this},this.next=function(){return this.o===this.container.size()&&(0,c.throwIteratorAccessError)(),this.o+=1,this}):(this.pre=function(){return this.o===this.container.size()-1&&(0,c.throwIteratorAccessError)(),this.o+=1,this},this.next=function(){return this.o===-1&&(0,c.throwIteratorAccessError)(),this.o-=1,this})}get pointer(){return this.container.getElementByPos(this.o)}set pointer(r){this.container.setElementByPos(this.o,r)}}v.RandomIterator=g},{"../../../utils/throwError":71,"../../ContainerBase":52}],60:[function(p,L,v){Object.defineProperty(v,"t",{value:!0}),v.default=void 0;var a=p("../../ContainerBase");class c extends a.Container{}var g=c;v.default=g},{"../../ContainerBase":52}],61:[function(p,L,v){Object.defineProperty(v,"t",{value:!0}),v.default=void 0;var a,c=(a=p("./Base"))&&a.t?a:{default:a},g=p("./Base/RandomIterator");class u extends g.RandomIterator{constructor(t,e,i){super(t,i),this.container=e}copy(){return new u(this.o,this.container,this.iteratorType)}}class r extends c.default{constructor(t=[],e=4096){super(),this.j=0,this.D=0,this.R=0,this.N=0,this.P=0,this.A=[];const i=(()=>{if(typeof t.length=="number")return t.length;if(typeof t.size=="number")return t.size;if(typeof t.size=="function")return t.size();throw new TypeError("Cannot get the length or size of the container")})();this.F=e,this.P=Math.max(Math.ceil(i/this.F),1);for(let m=0;m<this.P;++m)this.A.push(new Array(this.F));const f=Math.ceil(i/this.F);this.j=this.R=(this.P>>1)-(f>>1),this.D=this.N=this.F-i%this.F>>1;const h=this;t.forEach(function(m){h.pushBack(m)})}T(){const t=[],e=Math.max(this.P>>1,1);for(let i=0;i<e;++i)t[i]=new Array(this.F);for(let i=this.j;i<this.P;++i)t[t.length]=this.A[i];for(let i=0;i<this.R;++i)t[t.length]=this.A[i];t[t.length]=[...this.A[this.R]],this.j=e,this.R=t.length-1;for(let i=0;i<e;++i)t[t.length]=new Array(this.F);this.A=t,this.P=t.length}O(t){const e=this.D+t+1,i=e%this.F;let f=i-1,h=this.j+(e-i)/this.F;return i===0&&(h-=1),h%=this.P,f<0&&(f+=this.F),{curNodeBucketIndex:h,curNodePointerIndex:f}}clear(){this.A=[new Array(this.F)],this.P=1,this.j=this.R=this.i=0,this.D=this.N=this.F>>1}begin(){return new u(0,this)}end(){return new u(this.i,this)}rBegin(){return new u(this.i-1,this,1)}rEnd(){return new u(-1,this,1)}front(){if(this.i!==0)return this.A[this.j][this.D]}back(){if(this.i!==0)return this.A[this.R][this.N]}pushBack(t){return this.i&&(this.N<this.F-1?this.N+=1:this.R<this.P-1?(this.R+=1,this.N=0):(this.R=0,this.N=0),this.R===this.j&&this.N===this.D&&this.T()),this.i+=1,this.A[this.R][this.N]=t,this.i}popBack(){if(this.i===0)return;const t=this.A[this.R][this.N];return this.i!==1&&(this.N>0?this.N-=1:this.R>0?(this.R-=1,this.N=this.F-1):(this.R=this.P-1,this.N=this.F-1)),this.i-=1,t}pushFront(t){return this.i&&(this.D>0?this.D-=1:this.j>0?(this.j-=1,this.D=this.F-1):(this.j=this.P-1,this.D=this.F-1),this.j===this.R&&this.D===this.N&&this.T()),this.i+=1,this.A[this.j][this.D]=t,this.i}popFront(){if(this.i===0)return;const t=this.A[this.j][this.D];return this.i!==1&&(this.D<this.F-1?this.D+=1:this.j<this.P-1?(this.j+=1,this.D=0):(this.j=0,this.D=0)),this.i-=1,t}getElementByPos(t){if(t<0||t>this.i-1)throw new RangeError;const{curNodeBucketIndex:e,curNodePointerIndex:i}=this.O(t);return this.A[e][i]}setElementByPos(t,e){if(t<0||t>this.i-1)throw new RangeError;const{curNodeBucketIndex:i,curNodePointerIndex:f}=this.O(t);this.A[i][f]=e}insert(t,e,i=1){if(t<0||t>this.i)throw new RangeError;if(t===0)for(;i--;)this.pushFront(e);else if(t===this.i)for(;i--;)this.pushBack(e);else{const f=[];for(let h=t;h<this.i;++h)f.push(this.getElementByPos(h));this.cut(t-1);for(let h=0;h<i;++h)this.pushBack(e);for(let h=0;h<f.length;++h)this.pushBack(f[h])}return this.i}cut(t){if(t<0)return this.clear(),0;const{curNodeBucketIndex:e,curNodePointerIndex:i}=this.O(t);return this.R=e,this.N=i,this.i=t+1,this.i}eraseElementByPos(t){if(t<0||t>this.i-1)throw new RangeError;if(t===0)this.popFront();else if(t===this.i-1)this.popBack();else{const e=[];for(let f=t+1;f<this.i;++f)e.push(this.getElementByPos(f));this.cut(t),this.popBack();const i=this;e.forEach(function(f){i.pushBack(f)})}return this.i}eraseElementByValue(t){if(this.i===0)return 0;const e=[];for(let f=0;f<this.i;++f){const h=this.getElementByPos(f);h!==t&&e.push(h)}const i=e.length;for(let f=0;f<i;++f)this.setElementByPos(f,e[f]);return this.cut(i-1)}eraseElementByIterator(t){const e=t.o;return this.eraseElementByPos(e),t=t.next()}find(t){for(let e=0;e<this.i;++e)if(this.getElementByPos(e)===t)return new u(e,this);return this.end()}reverse(){let t=0,e=this.i-1;for(;t<e;){const i=this.getElementByPos(t);this.setElementByPos(t,this.getElementByPos(e)),this.setElementByPos(e,i),t+=1,e-=1}}unique(){if(this.i<=1)return this.i;let t=1,e=this.getElementByPos(0);for(let i=1;i<this.i;++i){const f=this.getElementByPos(i);f!==e&&(e=f,this.setElementByPos(t++,f))}for(;this.i>t;)this.popBack();return this.i}sort(t){const e=[];for(let i=0;i<this.i;++i)e.push(this.getElementByPos(i));e.sort(t);for(let i=0;i<this.i;++i)this.setElementByPos(i,e[i])}shrinkToFit(){if(this.i===0)return;const t=[];this.forEach(function(e){t.push(e)}),this.P=Math.max(Math.ceil(this.i/this.F),1),this.i=this.j=this.R=this.D=this.N=0,this.A=[];for(let e=0;e<this.P;++e)this.A.push(new Array(this.F));for(let e=0;e<t.length;++e)this.pushBack(t[e])}forEach(t){for(let e=0;e<this.i;++e)t(this.getElementByPos(e),e,this)}[Symbol.iterator](){return(function*(){for(let t=0;t<this.i;++t)yield this.getElementByPos(t)}).bind(this)()}}var o=r;v.default=o},{"./Base":60,"./Base/RandomIterator":59}],62:[function(p,L,v){Object.defineProperty(v,"t",{value:!0}),v.default=void 0;var a,c=(a=p("./Base"))&&a.t?a:{default:a},g=p("../ContainerBase"),u=p("../../utils/throwError");class r extends g.ContainerIterator{constructor(e,i,f,h){super(h),this.o=e,this.h=i,this.container=f,this.iteratorType===0?(this.pre=function(){return this.o.L===this.h&&(0,u.throwIteratorAccessError)(),this.o=this.o.L,this},this.next=function(){return this.o===this.h&&(0,u.throwIteratorAccessError)(),this.o=this.o.B,this}):(this.pre=function(){return this.o.B===this.h&&(0,u.throwIteratorAccessError)(),this.o=this.o.B,this},this.next=function(){return this.o===this.h&&(0,u.throwIteratorAccessError)(),this.o=this.o.L,this})}get pointer(){return this.o===this.h&&(0,u.throwIteratorAccessError)(),this.o.l}set pointer(e){this.o===this.h&&(0,u.throwIteratorAccessError)(),this.o.l=e}copy(){return new r(this.o,this.h,this.container,this.iteratorType)}}class o extends c.default{constructor(e=[]){super(),this.h={},this.p=this._=this.h.L=this.h.B=this.h;const i=this;e.forEach(function(f){i.pushBack(f)})}V(e){const{L:i,B:f}=e;i.B=f,f.L=i,e===this.p&&(this.p=f),e===this._&&(this._=i),this.i-=1}G(e,i){const f=i.B,h={l:e,L:i,B:f};i.B=h,f.L=h,i===this.h&&(this.p=h),f===this.h&&(this._=h),this.i+=1}clear(){this.i=0,this.p=this._=this.h.L=this.h.B=this.h}begin(){return new r(this.p,this.h,this)}end(){return new r(this.h,this.h,this)}rBegin(){return new r(this._,this.h,this,1)}rEnd(){return new r(this.h,this.h,this,1)}front(){return this.p.l}back(){return this._.l}getElementByPos(e){if(e<0||e>this.i-1)throw new RangeError;let i=this.p;for(;e--;)i=i.B;return i.l}eraseElementByPos(e){if(e<0||e>this.i-1)throw new RangeError;let i=this.p;for(;e--;)i=i.B;return this.V(i),this.i}eraseElementByValue(e){let i=this.p;for(;i!==this.h;)i.l===e&&this.V(i),i=i.B;return this.i}eraseElementByIterator(e){const i=e.o;return i===this.h&&(0,u.throwIteratorAccessError)(),e=e.next(),this.V(i),e}pushBack(e){return this.G(e,this._),this.i}popBack(){if(this.i===0)return;const e=this._.l;return this.V(this._),e}pushFront(e){return this.G(e,this.h),this.i}popFront(){if(this.i===0)return;const e=this.p.l;return this.V(this.p),e}setElementByPos(e,i){if(e<0||e>this.i-1)throw new RangeError;let f=this.p;for(;e--;)f=f.B;f.l=i}insert(e,i,f=1){if(e<0||e>this.i)throw new RangeError;if(f<=0)return this.i;if(e===0)for(;f--;)this.pushFront(i);else if(e===this.i)for(;f--;)this.pushBack(i);else{let h=this.p;for(let y=1;y<e;++y)h=h.B;const m=h.B;for(this.i+=f;f--;)h.B={l:i,L:h},h.B.L=h,h=h.B;h.B=m,m.L=h}return this.i}find(e){let i=this.p;for(;i!==this.h;){if(i.l===e)return new r(i,this.h,this);i=i.B}return this.end()}reverse(){if(this.i<=1)return;let e=this.p,i=this._,f=0;for(;f<<1<this.i;){const h=e.l;e.l=i.l,i.l=h,e=e.B,i=i.L,f+=1}}unique(){if(this.i<=1)return this.i;let e=this.p;for(;e!==this.h;){let i=e;for(;i.B!==this.h&&i.l===i.B.l;)i=i.B,this.i-=1;e.B=i.B,e.B.L=e,e=e.B}return this.i}sort(e){if(this.i<=1)return;const i=[];this.forEach(function(h){i.push(h)}),i.sort(e);let f=this.p;i.forEach(function(h){f.l=h,f=f.B})}merge(e){const i=this;if(this.i===0)e.forEach(function(f){i.pushBack(f)});else{let f=this.p;e.forEach(function(h){for(;f!==i.h&&f.l<=h;)f=f.B;i.G(h,f.L)})}return this.i}forEach(e){let i=this.p,f=0;for(;i!==this.h;)e(i.l,f++,this),i=i.B}[Symbol.iterator](){return(function*(){if(this.i===0)return;let e=this.p;for(;e!==this.h;)yield e.l,e=e.B}).bind(this)()}}var s=o;v.default=s},{"../../utils/throwError":71,"../ContainerBase":52,"./Base":60}],63:[function(p,L,v){Object.defineProperty(v,"t",{value:!0}),v.default=void 0;var a,c=(a=p("./Base"))&&a.t?a:{default:a},g=p("./Base/RandomIterator");class u extends g.RandomIterator{constructor(t,e,i){super(t,i),this.container=e}copy(){return new u(this.o,this.container,this.iteratorType)}}class r extends c.default{constructor(t=[],e=!0){if(super(),Array.isArray(t))this.J=e?[...t]:t,this.i=t.length;else{this.J=[];const i=this;t.forEach(function(f){i.pushBack(f)})}}clear(){this.i=0,this.J.length=0}begin(){return new u(0,this)}end(){return new u(this.i,this)}rBegin(){return new u(this.i-1,this,1)}rEnd(){return new u(-1,this,1)}front(){return this.J[0]}back(){return this.J[this.i-1]}getElementByPos(t){if(t<0||t>this.i-1)throw new RangeError;return this.J[t]}eraseElementByPos(t){if(t<0||t>this.i-1)throw new RangeError;return this.J.splice(t,1),this.i-=1,this.i}eraseElementByValue(t){let e=0;for(let i=0;i<this.i;++i)this.J[i]!==t&&(this.J[e++]=this.J[i]);return this.i=this.J.length=e,this.i}eraseElementByIterator(t){const e=t.o;return t=t.next(),this.eraseElementByPos(e),t}pushBack(t){return this.J.push(t),this.i+=1,this.i}popBack(){if(this.i!==0)return this.i-=1,this.J.pop()}setElementByPos(t,e){if(t<0||t>this.i-1)throw new RangeError;this.J[t]=e}insert(t,e,i=1){if(t<0||t>this.i)throw new RangeError;return this.J.splice(t,0,...new Array(i).fill(e)),this.i+=i,this.i}find(t){for(let e=0;e<this.i;++e)if(this.J[e]===t)return new u(e,this);return this.end()}reverse(){this.J.reverse()}unique(){let t=1;for(let e=1;e<this.i;++e)this.J[e]!==this.J[e-1]&&(this.J[t++]=this.J[e]);return this.i=this.J.length=t,this.i}sort(t){this.J.sort(t)}forEach(t){for(let e=0;e<this.i;++e)t(this.J[e],e,this)}[Symbol.iterator](){return(function*(){yield*this.J}).bind(this)()}}var o=r;v.default=o},{"./Base":60,"./Base/RandomIterator":59}],64:[function(p,L,v){Object.defineProperty(v,"t",{value:!0}),v.default=void 0;var a=p("../../ContainerBase"),c=p("../../../utils/throwError");class g extends a.ContainerIterator{constructor(o,s,t){super(t),this.o=o,this.h=s,this.iteratorType===0?(this.pre=function(){return this.o===this.h.U&&(0,c.throwIteratorAccessError)(),this.o=this.o.L(),this},this.next=function(){return this.o===this.h&&(0,c.throwIteratorAccessError)(),this.o=this.o.B(),this}):(this.pre=function(){return this.o===this.h.W&&(0,c.throwIteratorAccessError)(),this.o=this.o.B(),this},this.next=function(){return this.o===this.h&&(0,c.throwIteratorAccessError)(),this.o=this.o.L(),this})}get index(){let o=this.o;const s=this.h.tt;if(o===this.h)return s?s.rt-1:0;let t=0;for(o.U&&(t+=o.U.rt);o!==s;){const e=o.tt;o===e.W&&(t+=1,e.U&&(t+=e.U.rt)),o=e}return t}}var u=g;v.default=u},{"../../../utils/throwError":71,"../../ContainerBase":52}],65:[function(p,L,v){Object.defineProperty(v,"t",{value:!0}),v.TreeNodeEnableIndex=v.TreeNode=void 0;class a{constructor(g,u){this.ee=1,this.u=void 0,this.l=void 0,this.U=void 0,this.W=void 0,this.tt=void 0,this.u=g,this.l=u}L(){let g=this;if(g.ee===1&&g.tt.tt===g)g=g.W;else if(g.U)for(g=g.U;g.W;)g=g.W;else{let u=g.tt;for(;u.U===g;)g=u,u=g.tt;g=u}return g}B(){let g=this;if(g.W){for(g=g.W;g.U;)g=g.U;return g}{let u=g.tt;for(;u.W===g;)g=u,u=g.tt;return g.W!==u?u:g}}te(){const g=this.tt,u=this.W,r=u.U;return g.tt===this?g.tt=u:g.U===this?g.U=u:g.W=u,u.tt=g,u.U=this,this.tt=u,this.W=r,r&&(r.tt=this),u}se(){const g=this.tt,u=this.U,r=u.W;return g.tt===this?g.tt=u:g.U===this?g.U=u:g.W=u,u.tt=g,u.W=this,this.tt=u,this.U=r,r&&(r.tt=this),u}}v.TreeNode=a,v.TreeNodeEnableIndex=class extends a{constructor(){super(...arguments),this.rt=1}te(){const c=super.te();return this.ie(),c.ie(),c}se(){const c=super.se();return this.ie(),c.ie(),c}ie(){this.rt=1,this.U&&(this.rt+=this.U.rt),this.W&&(this.rt+=this.W.rt)}}},{}],66:[function(p,L,v){Object.defineProperty(v,"t",{value:!0}),v.default=void 0;var a=p("./TreeNode"),c=p("../../ContainerBase"),g=p("../../../utils/throwError");class u extends c.Container{constructor(s=function(e,i){return e<i?-1:e>i?1:0},t=!1){super(),this.Y=void 0,this.v=s,t?(this.re=a.TreeNodeEnableIndex,this.M=function(e,i,f){const h=this.ne(e,i,f);if(h){let m=h.tt;for(;m!==this.h;)m.rt+=1,m=m.tt;const y=this.he(h);if(y){const{parentNode:E,grandParent:P,curNode:M}=y;E.ie(),P.ie(),M.ie()}}return this.i},this.V=function(e){let i=this.fe(e);for(;i!==this.h;)i.rt-=1,i=i.tt}):(this.re=a.TreeNode,this.M=function(e,i,f){const h=this.ne(e,i,f);return h&&this.he(h),this.i},this.V=this.fe),this.h=new this.re}X(s,t){let e=this.h;for(;s;){const i=this.v(s.u,t);if(i<0)s=s.W;else{if(!(i>0))return s;e=s,s=s.U}}return e}Z(s,t){let e=this.h;for(;s;)this.v(s.u,t)<=0?s=s.W:(e=s,s=s.U);return e}$(s,t){let e=this.h;for(;s;){const i=this.v(s.u,t);if(i<0)e=s,s=s.W;else{if(!(i>0))return s;s=s.U}}return e}rr(s,t){let e=this.h;for(;s;)this.v(s.u,t)<0?(e=s,s=s.W):s=s.U;return e}ue(s){for(;;){const t=s.tt;if(t===this.h)return;if(s.ee===1)return void(s.ee=0);if(s===t.U){const e=t.W;if(e.ee===1)e.ee=0,t.ee=1,t===this.Y?this.Y=t.te():t.te();else{if(e.W&&e.W.ee===1)return e.ee=t.ee,t.ee=0,e.W.ee=0,void(t===this.Y?this.Y=t.te():t.te());e.U&&e.U.ee===1?(e.ee=1,e.U.ee=0,e.se()):(e.ee=1,s=t)}}else{const e=t.U;if(e.ee===1)e.ee=0,t.ee=1,t===this.Y?this.Y=t.se():t.se();else{if(e.U&&e.U.ee===1)return e.ee=t.ee,t.ee=0,e.U.ee=0,void(t===this.Y?this.Y=t.se():t.se());e.W&&e.W.ee===1?(e.ee=1,e.W.ee=0,e.te()):(e.ee=1,s=t)}}}}fe(s){if(this.i===1)return this.clear(),this.h;let t=s;for(;t.U||t.W;){if(t.W)for(t=t.W;t.U;)t=t.U;else t=t.U;[s.u,t.u]=[t.u,s.u],[s.l,t.l]=[t.l,s.l],s=t}this.h.U===t?this.h.U=t.tt:this.h.W===t&&(this.h.W=t.tt),this.ue(t);const e=t.tt;return t===e.U?e.U=void 0:e.W=void 0,this.i-=1,this.Y.ee=0,e}oe(s,t){return s===void 0?!1:!!this.oe(s.U,t)||!!t(s)||this.oe(s.W,t)}he(s){for(;;){const t=s.tt;if(t.ee===0)return;const e=t.tt;if(t===e.U){const i=e.W;if(i&&i.ee===1){if(i.ee=t.ee=0,e===this.Y)return;e.ee=1,s=e;continue}if(s===t.W){if(s.ee=0,s.U&&(s.U.tt=t),s.W&&(s.W.tt=e),t.W=s.U,e.U=s.W,s.U=t,s.W=e,e===this.Y)this.Y=s,this.h.tt=s;else{const f=e.tt;f.U===e?f.U=s:f.W=s}return s.tt=e.tt,t.tt=s,e.tt=s,e.ee=1,{parentNode:t,grandParent:e,curNode:s}}t.ee=0,e===this.Y?this.Y=e.se():e.se(),e.ee=1}else{const i=e.U;if(i&&i.ee===1){if(i.ee=t.ee=0,e===this.Y)return;e.ee=1,s=e;continue}if(s===t.U){if(s.ee=0,s.U&&(s.U.tt=e),s.W&&(s.W.tt=t),e.W=s.U,t.U=s.W,s.U=e,s.W=t,e===this.Y)this.Y=s,this.h.tt=s;else{const f=e.tt;f.U===e?f.U=s:f.W=s}return s.tt=e.tt,t.tt=s,e.tt=s,e.ee=1,{parentNode:t,grandParent:e,curNode:s}}t.ee=0,e===this.Y?this.Y=e.te():e.te(),e.ee=1}return}}ne(s,t,e){if(this.Y===void 0)return this.i+=1,this.Y=new this.re(s,t),this.Y.ee=0,this.Y.tt=this.h,this.h.tt=this.Y,this.h.U=this.Y,void(this.h.W=this.Y);let i;const f=this.h.U,h=this.v(f.u,s);if(h!==0){if(h>0)f.U=new this.re(s,t),f.U.tt=f,i=f.U,this.h.U=i;else{const m=this.h.W,y=this.v(m.u,s);if(y===0)return void(m.l=t);if(y<0)m.W=new this.re(s,t),m.W.tt=m,i=m.W,this.h.W=i;else{if(e!==void 0){const E=e.o;if(E!==this.h){const P=this.v(E.u,s);if(P===0)return void(E.l=t);if(P>0){const M=E.L(),k=this.v(M.u,s);if(k===0)return void(M.l=t);k<0&&(i=new this.re(s,t),M.W===void 0?(M.W=i,i.tt=M):(E.U=i,i.tt=E))}}}if(i===void 0)for(i=this.Y;;){const E=this.v(i.u,s);if(E>0){if(i.U===void 0){i.U=new this.re(s,t),i.U.tt=i,i=i.U;break}i=i.U}else{if(!(E<0))return void(i.l=t);if(i.W===void 0){i.W=new this.re(s,t),i.W.tt=i,i=i.W;break}i=i.W}}}}return this.i+=1,i}f.l=t}I(s,t){for(;s;){const e=this.v(s.u,t);if(e<0)s=s.W;else{if(!(e>0))return s;s=s.U}}return s||this.h}clear(){this.i=0,this.Y=void 0,this.h.tt=void 0,this.h.U=this.h.W=void 0}updateKeyByIterator(s,t){const e=s.o;if(e===this.h&&(0,g.throwIteratorAccessError)(),this.i===1)return e.u=t,!0;if(e===this.h.U)return this.v(e.B().u,t)>0&&(e.u=t,!0);if(e===this.h.W)return this.v(e.L().u,t)<0&&(e.u=t,!0);const i=e.L().u;if(this.v(i,t)>=0)return!1;const f=e.B().u;return!(this.v(f,t)<=0)&&(e.u=t,!0)}eraseElementByPos(s){if(s<0||s>this.i-1)throw new RangeError;let t=0;const e=this;return this.oe(this.Y,function(i){return s===t?(e.V(i),!0):(t+=1,!1)}),this.i}eraseElementByKey(s){if(this.i===0)return!1;const t=this.I(this.Y,s);return t!==this.h&&(this.V(t),!0)}eraseElementByIterator(s){const t=s.o;t===this.h&&(0,g.throwIteratorAccessError)();const e=t.W===void 0;return s.iteratorType===0?e&&s.next():e&&t.U!==void 0||s.next(),this.V(t),s}forEach(s){let t=0;for(const e of this)s(e,t++,this)}getElementByPos(s){if(s<0||s>this.i-1)throw new RangeError;let t,e=0;for(const i of this){if(e===s){t=i;break}e+=1}return t}getHeight(){if(this.i===0)return 0;const s=function(t){return t?Math.max(s(t.U),s(t.W))+1:0};return s(this.Y)}}var r=u;v.default=r},{"../../../utils/throwError":71,"../../ContainerBase":52,"./TreeNode":65}],67:[function(p,L,v){Object.defineProperty(v,"t",{value:!0}),v.default=void 0;var a=u(p("./Base")),c=u(p("./Base/TreeIterator")),g=p("../../utils/throwError");function u(t){return t&&t.t?t:{default:t}}class r extends c.default{constructor(e,i,f,h){super(e,i,h),this.container=f}get pointer(){this.o===this.h&&(0,g.throwIteratorAccessError)();const e=this;return new Proxy([],{get:(i,f)=>f==="0"?e.o.u:f==="1"?e.o.l:void 0,set(i,f,h){if(f!=="1")throw new TypeError("props must be 1");return e.o.l=h,!0}})}copy(){return new r(this.o,this.h,this.container,this.iteratorType)}}class o extends a.default{constructor(e=[],i,f){super(i,f);const h=this;e.forEach(function(m){h.setElement(m[0],m[1])})}*K(e){e!==void 0&&(yield*this.K(e.U),yield[e.u,e.l],yield*this.K(e.W))}begin(){return new r(this.h.U||this.h,this.h,this)}end(){return new r(this.h,this.h,this)}rBegin(){return new r(this.h.W||this.h,this.h,this,1)}rEnd(){return new r(this.h,this.h,this,1)}front(){if(this.i===0)return;const e=this.h.U;return[e.u,e.l]}back(){if(this.i===0)return;const e=this.h.W;return[e.u,e.l]}lowerBound(e){const i=this.X(this.Y,e);return new r(i,this.h,this)}upperBound(e){const i=this.Z(this.Y,e);return new r(i,this.h,this)}reverseLowerBound(e){const i=this.$(this.Y,e);return new r(i,this.h,this)}reverseUpperBound(e){const i=this.rr(this.Y,e);return new r(i,this.h,this)}setElement(e,i,f){return this.M(e,i,f)}find(e){const i=this.I(this.Y,e);return new r(i,this.h,this)}getElementByKey(e){return this.I(this.Y,e).l}union(e){const i=this;return e.forEach(function(f){i.setElement(f[0],f[1])}),this.i}[Symbol.iterator](){return this.K(this.Y)}}var s=o;v.default=s},{"../../utils/throwError":71,"./Base":66,"./Base/TreeIterator":64}],68:[function(p,L,v){Object.defineProperty(v,"t",{value:!0}),v.default=void 0;var a=u(p("./Base")),c=u(p("./Base/TreeIterator")),g=p("../../utils/throwError");function u(t){return t&&t.t?t:{default:t}}class r extends c.default{constructor(e,i,f,h){super(e,i,h),this.container=f}get pointer(){return this.o===this.h&&(0,g.throwIteratorAccessError)(),this.o.u}copy(){return new r(this.o,this.h,this.container,this.iteratorType)}}class o extends a.default{constructor(e=[],i,f){super(i,f);const h=this;e.forEach(function(m){h.insert(m)})}*K(e){e!==void 0&&(yield*this.K(e.U),yield e.u,yield*this.K(e.W))}begin(){return new r(this.h.U||this.h,this.h,this)}end(){return new r(this.h,this.h,this)}rBegin(){return new r(this.h.W||this.h,this.h,this,1)}rEnd(){return new r(this.h,this.h,this,1)}front(){return this.h.U?this.h.U.u:void 0}back(){return this.h.W?this.h.W.u:void 0}insert(e,i){return this.M(e,void 0,i)}find(e){const i=this.I(this.Y,e);return new r(i,this.h,this)}lowerBound(e){const i=this.X(this.Y,e);return new r(i,this.h,this)}upperBound(e){const i=this.Z(this.Y,e);return new r(i,this.h,this)}reverseLowerBound(e){const i=this.$(this.Y,e);return new r(i,this.h,this)}reverseUpperBound(e){const i=this.rr(this.Y,e);return new r(i,this.h,this)}union(e){const i=this;return e.forEach(function(f){i.insert(f)}),this.i}[Symbol.iterator](){return this.K(this.Y)}}var s=o;v.default=s},{"../../utils/throwError":71,"./Base":66,"./Base/TreeIterator":64}],69:[function(p,L,v){Object.defineProperty(v,"t",{value:!0}),Object.defineProperty(v,"Deque",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(v,"HashMap",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(v,"HashSet",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(v,"LinkList",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(v,"OrderedMap",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(v,"OrderedSet",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(v,"PriorityQueue",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(v,"Queue",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(v,"Stack",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(v,"Vector",{enumerable:!0,get:function(){return u.default}});var a=f(p("./container/OtherContainer/Stack")),c=f(p("./container/OtherContainer/Queue")),g=f(p("./container/OtherContainer/PriorityQueue")),u=f(p("./container/SequentialContainer/Vector")),r=f(p("./container/SequentialContainer/LinkList")),o=f(p("./container/SequentialContainer/Deque")),s=f(p("./container/TreeContainer/OrderedSet")),t=f(p("./container/TreeContainer/OrderedMap")),e=f(p("./container/HashContainer/HashSet")),i=f(p("./container/HashContainer/HashMap"));function f(h){return h&&h.t?h:{default:h}}},{"./container/HashContainer/HashMap":54,"./container/HashContainer/HashSet":55,"./container/OtherContainer/PriorityQueue":56,"./container/OtherContainer/Queue":57,"./container/OtherContainer/Stack":58,"./container/SequentialContainer/Deque":61,"./container/SequentialContainer/LinkList":62,"./container/SequentialContainer/Vector":63,"./container/TreeContainer/OrderedMap":67,"./container/TreeContainer/OrderedSet":68}],70:[function(p,L,v){Object.defineProperty(v,"t",{value:!0}),v.default=function(a){const c=typeof a;return c==="object"&&a!==null||c==="function"}},{}],71:[function(p,L,v){Object.defineProperty(v,"t",{value:!0}),v.throwIteratorAccessError=function(){throw new RangeError("Iterator access denied!")}},{}],72:[function(p,L,v){(function(a){(function(){const c=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,g=typeof AbortController=="function"?AbortController:class{constructor(){this.signal=new o}abort(k=new Error("This operation was aborted")){this.signal.reason=this.signal.reason||k,this.signal.aborted=!0,this.signal.dispatchEvent({type:"abort",target:this.signal})}},u=typeof AbortSignal=="function",r=typeof g.AbortSignal=="function",o=u?AbortSignal:r?g.AbortController:class{constructor(){this.reason=void 0,this.aborted=!1,this._listeners=[]}dispatchEvent(k){k.type==="abort"&&(this.aborted=!0,this.onabort(k),this._listeners.forEach(w=>w(k),this))}onabort(){}addEventListener(k,w){k==="abort"&&this._listeners.push(w)}removeEventListener(k,w){k==="abort"&&(this._listeners=this._listeners.filter(_=>_!==w))}},s=new Set,t=(k,w)=>{const _=`LRU_CACHE_OPTION_${k}`;f(_)&&h(_,`${k} option`,`options.${w}`,M)},e=(k,w)=>{const _=`LRU_CACHE_METHOD_${k}`;if(f(_)){const{prototype:x}=M,{get:V}=Object.getOwnPropertyDescriptor(x,k);h(_,`${k} method`,`cache.${w}()`,V)}},i=(...k)=>{typeof a=="object"&&a&&typeof a.emitWarning=="function"?a.emitWarning(...k):console.error(...k)},f=k=>!s.has(k),h=(k,w,_,x)=>{s.add(k),i(`The ${w} is deprecated. Please use ${_} instead.`,"DeprecationWarning",k,x)},m=k=>k&&k===Math.floor(k)&&k>0&&isFinite(k),y=k=>m(k)?k<=Math.pow(2,8)?Uint8Array:k<=Math.pow(2,16)?Uint16Array:k<=Math.pow(2,32)?Uint32Array:k<=Number.MAX_SAFE_INTEGER?E:null:null;class E extends Array{constructor(w){super(w),this.fill(0)}}class P{constructor(w){if(w===0)return[];const _=y(w);this.heap=new _(w),this.length=0}push(w){this.heap[this.length++]=w}pop(){return this.heap[--this.length]}}class M{constructor(w={}){const{max:_=0,ttl:x,ttlResolution:V=1,ttlAutopurge:D,updateAgeOnGet:d,updateAgeOnHas:T,allowStale:A,dispose:G,disposeAfter:Q,noDisposeOnSet:X,noUpdateTTL:O,maxSize:S=0,maxEntrySize:C=0,sizeCalculation:$,fetchMethod:B,fetchContext:H,noDeleteOnFetchRejection:F,noDeleteOnStaleGet:W,allowStaleOnFetchRejection:J,allowStaleOnFetchAbort:Y,ignoreFetchAbort:Z}=w,{length:I,maxAge:n,stale:l}=w instanceof M?{}:w;if(_!==0&&!m(_))throw new TypeError("max option must be a nonnegative integer");const b=_?y(_):Array;if(!b)throw new Error("invalid max value: "+_);if(this.max=_,this.maxSize=S,this.maxEntrySize=C||this.maxSize,this.sizeCalculation=$||I,this.sizeCalculation){if(!this.maxSize&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(this.fetchMethod=B||null,this.fetchMethod&&typeof this.fetchMethod!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.fetchContext=H,!this.fetchMethod&&H!==void 0)throw new TypeError("cannot set fetchContext without fetchMethod");if(this.keyMap=new Map,this.keyList=new Array(_).fill(null),this.valList=new Array(_).fill(null),this.next=new b(_),this.prev=new b(_),this.head=0,this.tail=0,this.free=new P(_),this.initialFill=1,this.size=0,typeof G=="function"&&(this.dispose=G),typeof Q=="function"?(this.disposeAfter=Q,this.disposed=[]):(this.disposeAfter=null,this.disposed=null),this.noDisposeOnSet=!!X,this.noUpdateTTL=!!O,this.noDeleteOnFetchRejection=!!F,this.allowStaleOnFetchRejection=!!J,this.allowStaleOnFetchAbort=!!Y,this.ignoreFetchAbort=!!Z,this.maxEntrySize!==0){if(this.maxSize!==0&&!m(this.maxSize))throw new TypeError("maxSize must be a positive integer if specified");if(!m(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.initializeSizeTracking()}if(this.allowStale=!!A||!!l,this.noDeleteOnStaleGet=!!W,this.updateAgeOnGet=!!d,this.updateAgeOnHas=!!T,this.ttlResolution=m(V)||V===0?V:1,this.ttlAutopurge=!!D,this.ttl=x||n||0,this.ttl){if(!m(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.initializeTTLTracking()}if(this.max===0&&this.ttl===0&&this.maxSize===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.max&&!this.maxSize){const R="LRU_CACHE_UNBOUNDED";f(R)&&(s.add(R),i("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",R,M))}l&&t("stale","allowStale"),n&&t("maxAge","ttl"),I&&t("length","sizeCalculation")}getRemainingTTL(w){return this.has(w,{updateAgeOnHas:!1})?1/0:0}initializeTTLTracking(){this.ttls=new E(this.max),this.starts=new E(this.max),this.setItemTTL=(x,V,D=c.now())=>{if(this.starts[x]=V!==0?D:0,this.ttls[x]=V,V!==0&&this.ttlAutopurge){const d=setTimeout(()=>{this.isStale(x)&&this.delete(this.keyList[x])},V+1);d.unref&&d.unref()}},this.updateItemAge=x=>{this.starts[x]=this.ttls[x]!==0?c.now():0},this.statusTTL=(x,V)=>{x&&(x.ttl=this.ttls[V],x.start=this.starts[V],x.now=w||_(),x.remainingTTL=x.now+x.ttl-x.start)};let w=0;const _=()=>{const x=c.now();if(this.ttlResolution>0){w=x;const V=setTimeout(()=>w=0,this.ttlResolution);V.unref&&V.unref()}return x};this.getRemainingTTL=x=>{const V=this.keyMap.get(x);return V===void 0?0:this.ttls[V]===0||this.starts[V]===0?1/0:this.starts[V]+this.ttls[V]-(w||_())},this.isStale=x=>this.ttls[x]!==0&&this.starts[x]!==0&&(w||_())-this.starts[x]>this.ttls[x]}updateItemAge(w){}statusTTL(w,_){}setItemTTL(w,_,x){}isStale(w){return!1}initializeSizeTracking(){this.calculatedSize=0,this.sizes=new E(this.max),this.removeItemSize=w=>{this.calculatedSize-=this.sizes[w],this.sizes[w]=0},this.requireSize=(w,_,x,V)=>{if(this.isBackgroundFetch(_))return 0;if(!m(x)){if(!V)throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");if(typeof V!="function")throw new TypeError("sizeCalculation must be a function");if(x=V(_,w),!m(x))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}return x},this.addItemSize=(w,_,x)=>{if(this.sizes[w]=_,this.maxSize){const V=this.maxSize-this.sizes[w];for(;this.calculatedSize>V;)this.evict(!0)}this.calculatedSize+=this.sizes[w],x&&(x.entrySize=_,x.totalCalculatedSize=this.calculatedSize)}}removeItemSize(w){}addItemSize(w,_){}requireSize(w,_,x,V){if(x||V)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache")}*indexes({allowStale:w=this.allowStale}={}){if(this.size)for(let _=this.tail;this.isValidIndex(_)&&(!w&&this.isStale(_)||(yield _),_!==this.head);)_=this.prev[_]}*rindexes({allowStale:w=this.allowStale}={}){if(this.size)for(let _=this.head;this.isValidIndex(_)&&(!w&&this.isStale(_)||(yield _),_!==this.tail);)_=this.next[_]}isValidIndex(w){return w!==void 0&&this.keyMap.get(this.keyList[w])===w}*entries(){for(const w of this.indexes())this.valList[w]===void 0||this.keyList[w]===void 0||this.isBackgroundFetch(this.valList[w])||(yield[this.keyList[w],this.valList[w]])}*rentries(){for(const w of this.rindexes())this.valList[w]===void 0||this.keyList[w]===void 0||this.isBackgroundFetch(this.valList[w])||(yield[this.keyList[w],this.valList[w]])}*keys(){for(const w of this.indexes())this.keyList[w]===void 0||this.isBackgroundFetch(this.valList[w])||(yield this.keyList[w])}*rkeys(){for(const w of this.rindexes())this.keyList[w]===void 0||this.isBackgroundFetch(this.valList[w])||(yield this.keyList[w])}*values(){for(const w of this.indexes())this.valList[w]===void 0||this.isBackgroundFetch(this.valList[w])||(yield this.valList[w])}*rvalues(){for(const w of this.rindexes())this.valList[w]===void 0||this.isBackgroundFetch(this.valList[w])||(yield this.valList[w])}[Symbol.iterator](){return this.entries()}find(w,_){for(const x of this.indexes()){const V=this.valList[x],D=this.isBackgroundFetch(V)?V.__staleWhileFetching:V;if(D!==void 0&&w(D,this.keyList[x],this))return this.get(this.keyList[x],_)}}forEach(w,_=this){for(const x of this.indexes()){const V=this.valList[x],D=this.isBackgroundFetch(V)?V.__staleWhileFetching:V;D!==void 0&&w.call(_,D,this.keyList[x],this)}}rforEach(w,_=this){for(const x of this.rindexes()){const V=this.valList[x],D=this.isBackgroundFetch(V)?V.__staleWhileFetching:V;D!==void 0&&w.call(_,D,this.keyList[x],this)}}get prune(){return e("prune","purgeStale"),this.purgeStale}purgeStale(){let w=!1;for(const _ of this.rindexes({allowStale:!0}))this.isStale(_)&&(this.delete(this.keyList[_]),w=!0);return w}dump(){const w=[];for(const _ of this.indexes({allowStale:!0})){const x=this.keyList[_],V=this.valList[_],D=this.isBackgroundFetch(V)?V.__staleWhileFetching:V;if(D===void 0)continue;const d={value:D};if(this.ttls){d.ttl=this.ttls[_];const T=c.now()-this.starts[_];d.start=Math.floor(Date.now()-T)}this.sizes&&(d.size=this.sizes[_]),w.unshift([x,d])}return w}load(w){this.clear();for(const[_,x]of w){if(x.start){const V=Date.now()-x.start;x.start=c.now()-V}this.set(_,x.value,x)}}dispose(w,_,x){}set(w,_,{ttl:x=this.ttl,start:V,noDisposeOnSet:D=this.noDisposeOnSet,size:d=0,sizeCalculation:T=this.sizeCalculation,noUpdateTTL:A=this.noUpdateTTL,status:G}={}){if(d=this.requireSize(w,_,d,T),this.maxEntrySize&&d>this.maxEntrySize)return G&&(G.set="miss",G.maxEntrySizeExceeded=!0),this.delete(w),this;let Q=this.size===0?void 0:this.keyMap.get(w);if(Q===void 0)Q=this.newIndex(),this.keyList[Q]=w,this.valList[Q]=_,this.keyMap.set(w,Q),this.next[this.tail]=Q,this.prev[Q]=this.tail,this.tail=Q,this.size++,this.addItemSize(Q,d,G),G&&(G.set="add"),A=!1;else{this.moveToTail(Q);const X=this.valList[Q];if(_!==X){if(this.isBackgroundFetch(X)?X.__abortController.abort(new Error("replaced")):D||(this.dispose(X,w,"set"),this.disposeAfter&&this.disposed.push([X,w,"set"])),this.removeItemSize(Q),this.valList[Q]=_,this.addItemSize(Q,d,G),G){G.set="replace";const O=X&&this.isBackgroundFetch(X)?X.__staleWhileFetching:X;O!==void 0&&(G.oldValue=O)}}else G&&(G.set="update")}if(x===0||this.ttl!==0||this.ttls||this.initializeTTLTracking(),A||this.setItemTTL(Q,x,V),this.statusTTL(G,Q),this.disposeAfter)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return this}newIndex(){return this.size===0?this.tail:this.size===this.max&&this.max!==0?this.evict(!1):this.free.length!==0?this.free.pop():this.initialFill++}pop(){if(this.size){const w=this.valList[this.head];return this.evict(!0),w}}evict(w){const _=this.head,x=this.keyList[_],V=this.valList[_];return this.isBackgroundFetch(V)?V.__abortController.abort(new Error("evicted")):(this.dispose(V,x,"evict"),this.disposeAfter&&this.disposed.push([V,x,"evict"])),this.removeItemSize(_),w&&(this.keyList[_]=null,this.valList[_]=null,this.free.push(_)),this.head=this.next[_],this.keyMap.delete(x),this.size--,_}has(w,{updateAgeOnHas:_=this.updateAgeOnHas,status:x}={}){const V=this.keyMap.get(w);if(V!==void 0){if(!this.isStale(V))return _&&this.updateItemAge(V),x&&(x.has="hit"),this.statusTTL(x,V),!0;x&&(x.has="stale",this.statusTTL(x,V))}else x&&(x.has="miss");return!1}peek(w,{allowStale:_=this.allowStale}={}){const x=this.keyMap.get(w);if(x!==void 0&&(_||!this.isStale(x))){const V=this.valList[x];return this.isBackgroundFetch(V)?V.__staleWhileFetching:V}}backgroundFetch(w,_,x,V){const D=_===void 0?void 0:this.valList[_];if(this.isBackgroundFetch(D))return D;const d=new g;x.signal&&x.signal.addEventListener("abort",()=>d.abort(x.signal.reason));const T={signal:d.signal,options:x,context:V},A=(X,O=!1)=>{const{aborted:S}=d.signal,C=x.ignoreFetchAbort&&X!==void 0;return x.status&&(S&&!O?(x.status.fetchAborted=!0,x.status.fetchError=d.signal.reason,C&&(x.status.fetchAbortIgnored=!0)):x.status.fetchResolved=!0),!S||C||O?(this.valList[_]===Q&&(X===void 0?Q.__staleWhileFetching?this.valList[_]=Q.__staleWhileFetching:this.delete(w):(x.status&&(x.status.fetchUpdated=!0),this.set(w,X,T.options))),X):G(d.signal.reason)},G=X=>{const{aborted:O}=d.signal,S=O&&x.allowStaleOnFetchAbort,C=S||x.allowStaleOnFetchRejection,$=C||x.noDeleteOnFetchRejection;if(this.valList[_]===Q&&(!$||Q.__staleWhileFetching===void 0?this.delete(w):S||(this.valList[_]=Q.__staleWhileFetching)),C)return x.status&&Q.__staleWhileFetching!==void 0&&(x.status.returnedStale=!0),Q.__staleWhileFetching;if(Q.__returned===Q)throw X};x.status&&(x.status.fetchDispatched=!0);const Q=new Promise((X,O)=>{this.fetchMethod(w,D,T).then(S=>X(S),O),d.signal.addEventListener("abort",()=>{x.ignoreFetchAbort&&!x.allowStaleOnFetchAbort||(X(),x.allowStaleOnFetchAbort&&(X=S=>A(S,!0)))})}).then(A,X=>(x.status&&(x.status.fetchRejected=!0,x.status.fetchError=X),G(X)));return Q.__abortController=d,Q.__staleWhileFetching=D,Q.__returned=null,_===void 0?(this.set(w,Q,{...T.options,status:void 0}),_=this.keyMap.get(w)):this.valList[_]=Q,Q}isBackgroundFetch(w){return w&&typeof w=="object"&&typeof w.then=="function"&&Object.prototype.hasOwnProperty.call(w,"__staleWhileFetching")&&Object.prototype.hasOwnProperty.call(w,"__returned")&&(w.__returned===w||w.__returned===null)}async fetch(w,{allowStale:_=this.allowStale,updateAgeOnGet:x=this.updateAgeOnGet,noDeleteOnStaleGet:V=this.noDeleteOnStaleGet,ttl:D=this.ttl,noDisposeOnSet:d=this.noDisposeOnSet,size:T=0,sizeCalculation:A=this.sizeCalculation,noUpdateTTL:G=this.noUpdateTTL,noDeleteOnFetchRejection:Q=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:X=this.allowStaleOnFetchRejection,ignoreFetchAbort:O=this.ignoreFetchAbort,allowStaleOnFetchAbort:S=this.allowStaleOnFetchAbort,fetchContext:C=this.fetchContext,forceRefresh:$=!1,status:B,signal:H}={}){if(!this.fetchMethod)return B&&(B.fetch="get"),this.get(w,{allowStale:_,updateAgeOnGet:x,noDeleteOnStaleGet:V,status:B});const F={allowStale:_,updateAgeOnGet:x,noDeleteOnStaleGet:V,ttl:D,noDisposeOnSet:d,size:T,sizeCalculation:A,noUpdateTTL:G,noDeleteOnFetchRejection:Q,allowStaleOnFetchRejection:X,allowStaleOnFetchAbort:S,ignoreFetchAbort:O,status:B,signal:H};let W=this.keyMap.get(w);if(W===void 0){B&&(B.fetch="miss");const J=this.backgroundFetch(w,W,F,C);return J.__returned=J}{const J=this.valList[W];if(this.isBackgroundFetch(J)){const l=_&&J.__staleWhileFetching!==void 0;return B&&(B.fetch="inflight",l&&(B.returnedStale=!0)),l?J.__staleWhileFetching:J.__returned=J}const Y=this.isStale(W);if(!$&&!Y)return B&&(B.fetch="hit"),this.moveToTail(W),x&&this.updateItemAge(W),this.statusTTL(B,W),J;const Z=this.backgroundFetch(w,W,F,C),I=Z.__staleWhileFetching!==void 0,n=I&&_;return B&&(B.fetch=I&&Y?"stale":"refresh",n&&Y&&(B.returnedStale=!0)),n?Z.__staleWhileFetching:Z.__returned=Z}}get(w,{allowStale:_=this.allowStale,updateAgeOnGet:x=this.updateAgeOnGet,noDeleteOnStaleGet:V=this.noDeleteOnStaleGet,status:D}={}){const d=this.keyMap.get(w);if(d!==void 0){const T=this.valList[d],A=this.isBackgroundFetch(T);return this.statusTTL(D,d),this.isStale(d)?(D&&(D.get="stale"),A?(D&&(D.returnedStale=_&&T.__staleWhileFetching!==void 0),_?T.__staleWhileFetching:void 0):(V||this.delete(w),D&&(D.returnedStale=_),_?T:void 0)):(D&&(D.get="hit"),A?T.__staleWhileFetching:(this.moveToTail(d),x&&this.updateItemAge(d),T))}D&&(D.get="miss")}connect(w,_){this.prev[_]=w,this.next[w]=_}moveToTail(w){w!==this.tail&&(w===this.head?this.head=this.next[w]:this.connect(this.prev[w],this.next[w]),this.connect(this.tail,w),this.tail=w)}get del(){return e("del","delete"),this.delete}delete(w){let _=!1;if(this.size!==0){const x=this.keyMap.get(w);if(x!==void 0)if(_=!0,this.size===1)this.clear();else{this.removeItemSize(x);const V=this.valList[x];this.isBackgroundFetch(V)?V.__abortController.abort(new Error("deleted")):(this.dispose(V,w,"delete"),this.disposeAfter&&this.disposed.push([V,w,"delete"])),this.keyMap.delete(w),this.keyList[x]=null,this.valList[x]=null,x===this.tail?this.tail=this.prev[x]:x===this.head?this.head=this.next[x]:(this.next[this.prev[x]]=this.next[x],this.prev[this.next[x]]=this.prev[x]),this.size--,this.free.push(x)}}if(this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return _}clear(){for(const w of this.rindexes({allowStale:!0})){const _=this.valList[w];if(this.isBackgroundFetch(_))_.__abortController.abort(new Error("deleted"));else{const x=this.keyList[w];this.dispose(_,x,"delete"),this.disposeAfter&&this.disposed.push([_,x,"delete"])}}if(this.keyMap.clear(),this.valList.fill(null),this.keyList.fill(null),this.ttls&&(this.ttls.fill(0),this.starts.fill(0)),this.sizes&&this.sizes.fill(0),this.head=0,this.tail=0,this.initialFill=1,this.free.length=0,this.calculatedSize=0,this.size=0,this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift())}get reset(){return e("reset","clear"),this.clear}get length(){return((w,_)=>{const x=`LRU_CACHE_PROPERTY_${w}`;if(f(x)){const{prototype:V}=M,{get:D}=Object.getOwnPropertyDescriptor(V,w);h(x,`${w} property`,`cache.${_}`,D)}})("length","size"),this.size}static get AbortController(){return g}static get AbortSignal(){return o}}L.exports=M}).call(this)}).call(this,p("_process"))},{_process:102}],73:[function(p,L,v){const a=L.exports,{Buffer:c}=p("buffer");a.types={0:"reserved",1:"connect",2:"connack",3:"publish",4:"puback",5:"pubrec",6:"pubrel",7:"pubcomp",8:"subscribe",9:"suback",10:"unsubscribe",11:"unsuback",12:"pingreq",13:"pingresp",14:"disconnect",15:"auth"},a.requiredHeaderFlags={1:0,2:0,4:0,5:0,6:2,7:0,8:2,9:0,10:2,11:0,12:0,13:0,14:0,15:0},a.requiredHeaderFlagsErrors={};for(const u in a.requiredHeaderFlags){const r=a.requiredHeaderFlags[u];a.requiredHeaderFlagsErrors[u]="Invalid header flag bits, must be 0x"+r.toString(16)+" for "+a.types[u]+" packet"}a.codes={};for(const u in a.types){const r=a.types[u];a.codes[r]=u}a.CMD_SHIFT=4,a.CMD_MASK=240,a.DUP_MASK=8,a.QOS_MASK=3,a.QOS_SHIFT=1,a.RETAIN_MASK=1,a.VARBYTEINT_MASK=127,a.VARBYTEINT_FIN_MASK=128,a.VARBYTEINT_MAX=268435455,a.SESSIONPRESENT_MASK=1,a.SESSIONPRESENT_HEADER=c.from([a.SESSIONPRESENT_MASK]),a.CONNACK_HEADER=c.from([a.codes.connack<<a.CMD_SHIFT]),a.USERNAME_MASK=128,a.PASSWORD_MASK=64,a.WILL_RETAIN_MASK=32,a.WILL_QOS_MASK=24,a.WILL_QOS_SHIFT=3,a.WILL_FLAG_MASK=4,a.CLEAN_SESSION_MASK=2,a.CONNECT_HEADER=c.from([a.codes.connect<<a.CMD_SHIFT]),a.properties={sessionExpiryInterval:17,willDelayInterval:24,receiveMaximum:33,maximumPacketSize:39,topicAliasMaximum:34,requestResponseInformation:25,requestProblemInformation:23,userProperties:38,authenticationMethod:21,authenticationData:22,payloadFormatIndicator:1,messageExpiryInterval:2,contentType:3,responseTopic:8,correlationData:9,maximumQoS:36,retainAvailable:37,assignedClientIdentifier:18,reasonString:31,wildcardSubscriptionAvailable:40,subscriptionIdentifiersAvailable:41,sharedSubscriptionAvailable:42,serverKeepAlive:19,responseInformation:26,serverReference:28,topicAlias:35,subscriptionIdentifier:11},a.propertiesCodes={};for(const u in a.properties){const r=a.properties[u];a.propertiesCodes[r]=u}function g(u){return[0,1,2].map(r=>[0,1].map(o=>[0,1].map(s=>{const t=c.alloc(1);return t.writeUInt8(a.codes[u]<<a.CMD_SHIFT|(o?a.DUP_MASK:0)|r<<a.QOS_SHIFT|s,0,!0),t})))}a.propertiesTypes={sessionExpiryInterval:"int32",willDelayInterval:"int32",receiveMaximum:"int16",maximumPacketSize:"int32",topicAliasMaximum:"int16",requestResponseInformation:"byte",requestProblemInformation:"byte",userProperties:"pair",authenticationMethod:"string",authenticationData:"binary",payloadFormatIndicator:"byte",messageExpiryInterval:"int32",contentType:"string",responseTopic:"string",correlationData:"binary",maximumQoS:"int8",retainAvailable:"byte",assignedClientIdentifier:"string",reasonString:"string",wildcardSubscriptionAvailable:"byte",subscriptionIdentifiersAvailable:"byte",sharedSubscriptionAvailable:"byte",serverKeepAlive:"int16",responseInformation:"string",serverReference:"string",topicAlias:"int16",subscriptionIdentifier:"var"},a.PUBLISH_HEADER=g("publish"),a.SUBSCRIBE_HEADER=g("subscribe"),a.SUBSCRIBE_OPTIONS_QOS_MASK=3,a.SUBSCRIBE_OPTIONS_NL_MASK=1,a.SUBSCRIBE_OPTIONS_NL_SHIFT=2,a.SUBSCRIBE_OPTIONS_RAP_MASK=1,a.SUBSCRIBE_OPTIONS_RAP_SHIFT=3,a.SUBSCRIBE_OPTIONS_RH_MASK=3,a.SUBSCRIBE_OPTIONS_RH_SHIFT=4,a.SUBSCRIBE_OPTIONS_RH=[0,16,32],a.SUBSCRIBE_OPTIONS_NL=4,a.SUBSCRIBE_OPTIONS_RAP=8,a.SUBSCRIBE_OPTIONS_QOS=[0,1,2],a.UNSUBSCRIBE_HEADER=g("unsubscribe"),a.ACKS={unsuback:g("unsuback"),puback:g("puback"),pubcomp:g("pubcomp"),pubrel:g("pubrel"),pubrec:g("pubrec")},a.SUBACK_HEADER=c.from([a.codes.suback<<a.CMD_SHIFT]),a.VERSION3=c.from([3]),a.VERSION4=c.from([4]),a.VERSION5=c.from([5]),a.VERSION131=c.from([131]),a.VERSION132=c.from([132]),a.QOS=[0,1,2].map(u=>c.from([u])),a.EMPTY={pingreq:c.from([a.codes.pingreq<<4,0]),pingresp:c.from([a.codes.pingresp<<4,0]),disconnect:c.from([a.codes.disconnect<<4,0])},a.MQTT5_PUBACK_PUBREC_CODES={0:"Success",16:"No matching subscribers",128:"Unspecified error",131:"Implementation specific error",135:"Not authorized",144:"Topic Name invalid",145:"Packet identifier in use",151:"Quota exceeded",153:"Payload format invalid"},a.MQTT5_PUBREL_PUBCOMP_CODES={0:"Success",146:"Packet Identifier not found"},a.MQTT5_SUBACK_CODES={0:"Granted QoS 0",1:"Granted QoS 1",2:"Granted QoS 2",128:"Unspecified error",131:"Implementation specific error",135:"Not authorized",143:"Topic Filter invalid",145:"Packet Identifier in use",151:"Quota exceeded",158:"Shared Subscriptions not supported",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"},a.MQTT5_UNSUBACK_CODES={0:"Success",17:"No subscription existed",128:"Unspecified error",131:"Implementation specific error",135:"Not authorized",143:"Topic Filter invalid",145:"Packet Identifier in use"},a.MQTT5_DISCONNECT_CODES={0:"Normal disconnection",4:"Disconnect with Will Message",128:"Unspecified error",129:"Malformed Packet",130:"Protocol Error",131:"Implementation specific error",135:"Not authorized",137:"Server busy",139:"Server shutting down",141:"Keep Alive timeout",142:"Session taken over",143:"Topic Filter invalid",144:"Topic Name invalid",147:"Receive Maximum exceeded",148:"Topic Alias invalid",149:"Packet too large",150:"Message rate too high",151:"Quota exceeded",152:"Administrative action",153:"Payload format invalid",154:"Retain not supported",155:"QoS not supported",156:"Use another server",157:"Server moved",158:"Shared Subscriptions not supported",159:"Connection rate exceeded",160:"Maximum connect time",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"},a.MQTT5_AUTH_CODES={0:"Success",24:"Continue authentication",25:"Re-authenticate"}},{buffer:29}],74:[function(p,L,v){const a=p("./writeToStream"),c=p("events"),{Buffer:g}=p("buffer");class u extends c{constructor(){super(),this._array=new Array(20),this._i=0}write(o){return this._array[this._i++]=o,!0}concat(){let o=0;const s=new Array(this._array.length),t=this._array;let e,i=0;for(e=0;e<t.length&&t[e]!==void 0;e++)typeof t[e]!="string"?s[e]=t[e].length:s[e]=g.byteLength(t[e]),o+=s[e];const f=g.allocUnsafe(o);for(e=0;e<t.length&&t[e]!==void 0;e++)typeof t[e]!="string"?(t[e].copy(f,i),i+=s[e]):(f.write(t[e],i),i+=s[e]);return f}destroy(o){o&&this.emit("error",o)}}L.exports=function(r,o){const s=new u;return a(r,s,o),s.concat()}},{"./writeToStream":96,buffer:29,events:49}],75:[function(p,L,v){v.parser=p("./parser").parser,v.generate=p("./generate"),v.writeToStream=p("./writeToStream")},{"./generate":74,"./parser":95,"./writeToStream":96}],76:[function(p,L,v){const{Buffer:a}=p("buffer"),c=Symbol.for("BufferList");function g(u){if(!(this instanceof g))return new g(u);g._init.call(this,u)}g._init=function(u){Object.defineProperty(this,c,{value:!0}),this._bufs=[],this.length=0,u&&this.append(u)},g.prototype._new=function(u){return new g(u)},g.prototype._offset=function(u){if(u===0)return[0,0];let r=0;for(let o=0;o<this._bufs.length;o++){const s=r+this._bufs[o].length;if(u<s||o===this._bufs.length-1)return[o,u-r];r=s}},g.prototype._reverseOffset=function(u){const r=u[0];let o=u[1];for(let s=0;s<r;s++)o+=this._bufs[s].length;return o},g.prototype.get=function(u){if(u>this.length||u<0)return;const r=this._offset(u);return this._bufs[r[0]][r[1]]},g.prototype.slice=function(u,r){return typeof u=="number"&&u<0&&(u+=this.length),typeof r=="number"&&r<0&&(r+=this.length),this.copy(null,0,u,r)},g.prototype.copy=function(u,r,o,s){if((typeof o!="number"||o<0)&&(o=0),(typeof s!="number"||s>this.length)&&(s=this.length),o>=this.length||s<=0)return u||a.alloc(0);const t=!!u,e=this._offset(o),i=s-o;let f=i,h=t&&r||0,m=e[1];if(o===0&&s===this.length){if(!t)return this._bufs.length===1?this._bufs[0]:a.concat(this._bufs,this.length);for(let y=0;y<this._bufs.length;y++)this._bufs[y].copy(u,h),h+=this._bufs[y].length;return u}if(f<=this._bufs[e[0]].length-m)return t?this._bufs[e[0]].copy(u,r,m,m+f):this._bufs[e[0]].slice(m,m+f);t||(u=a.allocUnsafe(i));for(let y=e[0];y<this._bufs.length;y++){const E=this._bufs[y].length-m;if(!(f>E)){this._bufs[y].copy(u,h,m,m+f),h+=E;break}this._bufs[y].copy(u,h,m),h+=E,f-=E,m&&(m=0)}return u.length>h?u.slice(0,h):u},g.prototype.shallowSlice=function(u,r){if(u=u||0,r=typeof r!="number"?this.length:r,u<0&&(u+=this.length),r<0&&(r+=this.length),u===r)return this._new();const o=this._offset(u),s=this._offset(r),t=this._bufs.slice(o[0],s[0]+1);return s[1]===0?t.pop():t[t.length-1]=t[t.length-1].slice(0,s[1]),o[1]!==0&&(t[0]=t[0].slice(o[1])),this._new(t)},g.prototype.toString=function(u,r,o){return this.slice(r,o).toString(u)},g.prototype.consume=function(u){if(u=Math.trunc(u),Number.isNaN(u)||u<=0)return this;for(;this._bufs.length;){if(!(u>=this._bufs[0].length)){this._bufs[0]=this._bufs[0].slice(u),this.length-=u;break}u-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift()}return this},g.prototype.duplicate=function(){const u=this._new();for(let r=0;r<this._bufs.length;r++)u.append(this._bufs[r]);return u},g.prototype.append=function(u){if(u==null)return this;if(u.buffer)this._appendBuffer(a.from(u.buffer,u.byteOffset,u.byteLength));else if(Array.isArray(u))for(let r=0;r<u.length;r++)this.append(u[r]);else if(this._isBufferList(u))for(let r=0;r<u._bufs.length;r++)this.append(u._bufs[r]);else typeof u=="number"&&(u=u.toString()),this._appendBuffer(a.from(u));return this},g.prototype._appendBuffer=function(u){this._bufs.push(u),this.length+=u.length},g.prototype.indexOf=function(u,r,o){if(o===void 0&&typeof r=="string"&&(o=r,r=void 0),typeof u=="function"||Array.isArray(u))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof u=="number"?u=a.from([u]):typeof u=="string"?u=a.from(u,o):this._isBufferList(u)?u=u.slice():Array.isArray(u.buffer)?u=a.from(u.buffer,u.byteOffset,u.byteLength):a.isBuffer(u)||(u=a.from(u)),r=Number(r||0),isNaN(r)&&(r=0),r<0&&(r=this.length+r),r<0&&(r=0),u.length===0)return r>this.length?this.length:r;const s=this._offset(r);let t=s[0],e=s[1];for(;t<this._bufs.length;t++){const i=this._bufs[t];for(;e<i.length;)if(i.length-e>=u.length){const f=i.indexOf(u,e);if(f!==-1)return this._reverseOffset([t,f]);e=i.length-u.length+1}else{const f=this._reverseOffset([t,e]);if(this._match(f,u))return f;e++}e=0}return-1},g.prototype._match=function(u,r){if(this.length-u<r.length)return!1;for(let o=0;o<r.length;o++)if(this.get(u+o)!==r[o])return!1;return!0},function(){const u={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(const r in u)(function(o){g.prototype[o]=u[o]===null?function(s,t){return this.slice(s,s+t)[o](0,t)}:function(s=0){return this.slice(s,s+u[o])[o](0)}})(r)}(),g.prototype._isBufferList=function(u){return u instanceof g||g.isBufferList(u)},g.isBufferList=function(u){return u!=null&&u[c]},L.exports=g},{buffer:29}],77:[function(p,L,v){const a=p("readable-stream").Duplex,c=p("inherits"),g=p("./BufferList");function u(r){if(!(this instanceof u))return new u(r);if(typeof r=="function"){this._callback=r;const o=(function(s){this._callback&&(this._callback(s),this._callback=null)}).bind(this);this.on("pipe",function(s){s.on("error",o)}),this.on("unpipe",function(s){s.removeListener("error",o)}),r=null}g._init.call(this,r),a.call(this)}c(u,a),Object.assign(u.prototype,g.prototype),u.prototype._new=function(r){return new u(r)},u.prototype._write=function(r,o,s){this._appendBuffer(r),typeof s=="function"&&s()},u.prototype._read=function(r){if(!this.length)return this.push(null);r=Math.min(r,this.length),this.push(this.slice(0,r)),this.consume(r)},u.prototype.end=function(r){a.prototype.end.call(this,r),this._callback&&(this._callback(null,this.slice()),this._callback=null)},u.prototype._destroy=function(r,o){this._bufs.length=0,this.length=0,o(r)},u.prototype._isBufferList=function(r){return r instanceof u||r instanceof g||u.isBufferList(r)},u.isBufferList=g.isBufferList,L.exports=u,L.exports.BufferListStream=u,L.exports.BufferList=g},{"./BufferList":76,inherits:51,"readable-stream":92}],78:[function(p,L,v){arguments[4][33][0].apply(v,arguments)},{dup:33}],79:[function(p,L,v){arguments[4][34][0].apply(v,arguments)},{"./_stream_readable":81,"./_stream_writable":83,_process:102,dup:34,inherits:51}],80:[function(p,L,v){arguments[4][35][0].apply(v,arguments)},{"./_stream_transform":82,dup:35,inherits:51}],81:[function(p,L,v){arguments[4][36][0].apply(v,arguments)},{"../errors":78,"./_stream_duplex":79,"./internal/streams/async_iterator":84,"./internal/streams/buffer_list":85,"./internal/streams/destroy":86,"./internal/streams/from":88,"./internal/streams/state":90,"./internal/streams/stream":91,_process:102,buffer:29,dup:36,events:49,inherits:51,"string_decoder/":136,util:26}],82:[function(p,L,v){arguments[4][37][0].apply(v,arguments)},{"../errors":78,"./_stream_duplex":79,dup:37,inherits:51}],83:[function(p,L,v){arguments[4][38][0].apply(v,arguments)},{"../errors":78,"./_stream_duplex":79,"./internal/streams/destroy":86,"./internal/streams/state":90,"./internal/streams/stream":91,_process:102,buffer:29,dup:38,inherits:51,"util-deprecate":139}],84:[function(p,L,v){arguments[4][39][0].apply(v,arguments)},{"./end-of-stream":87,_process:102,dup:39}],85:[function(p,L,v){arguments[4][40][0].apply(v,arguments)},{buffer:29,dup:40,util:26}],86:[function(p,L,v){arguments[4][41][0].apply(v,arguments)},{_process:102,dup:41}],87:[function(p,L,v){arguments[4][42][0].apply(v,arguments)},{"../../../errors":78,dup:42}],88:[function(p,L,v){arguments[4][43][0].apply(v,arguments)},{dup:43}],89:[function(p,L,v){arguments[4][44][0].apply(v,arguments)},{"../../../errors":78,"./end-of-stream":87,dup:44}],90:[function(p,L,v){arguments[4][45][0].apply(v,arguments)},{"../../../errors":78,dup:45}],91:[function(p,L,v){arguments[4][46][0].apply(v,arguments)},{dup:46,events:49}],92:[function(p,L,v){arguments[4][47][0].apply(v,arguments)},{"./lib/_stream_duplex.js":79,"./lib/_stream_passthrough.js":80,"./lib/_stream_readable.js":81,"./lib/_stream_transform.js":82,"./lib/_stream_writable.js":83,"./lib/internal/streams/end-of-stream.js":87,"./lib/internal/streams/pipeline.js":89,dup:47}],93:[function(p,L,v){const{Buffer:a}=p("buffer"),c={},g=a.isBuffer(a.from([1,2]).subarray(0,1));function u(r){const o=a.allocUnsafe(2);return o.writeUInt8(r>>8,0),o.writeUInt8(255&r,1),o}L.exports={cache:c,generateCache:function(){for(let r=0;r<65536;r++)c[r]=u(r)},generateNumber:u,genBufVariableByteInt:function(r){let o=0,s=0;const t=a.allocUnsafe(4);do o=r%128|0,(r=r/128|0)>0&&(o|=128),t.writeUInt8(o,s++);while(r>0&&s<4);return r>0&&(s=0),g?t.subarray(0,s):t.slice(0,s)},generate4ByteBuffer:function(r){const o=a.allocUnsafe(4);return o.writeUInt32BE(r,0),o}}},{buffer:29}],94:[function(p,L,v){L.exports=class{constructor(){this.cmd=null,this.retain=!1,this.qos=0,this.dup=!1,this.length=-1,this.topic=null,this.payload=null}}},{}],95:[function(p,L,v){const a=p("bl"),c=p("events"),g=p("./packet"),u=p("./constants"),r=p("debug")("mqtt-packet:parser");class o extends c{constructor(){super(),this.parser=this.constructor.parser}static parser(t){return this instanceof o?(this.settings=t||{},this._states=["_parseHeader","_parseLength","_parsePayload","_newPacket"],this._resetState(),this):new o().parser(t)}_resetState(){r("_resetState: resetting packet, error, _list, and _stateCounter"),this.packet=new g,this.error=null,this._list=a(),this._stateCounter=0}parse(t){for(this.error&&this._resetState(),this._list.append(t),r("parse: current state: %s",this._states[this._stateCounter]);(this.packet.length!==-1||this._list.length>0)&&this[this._states[this._stateCounter]]()&&!this.error;)this._stateCounter++,r("parse: state complete. _stateCounter is now: %d",this._stateCounter),r("parse: packet.length: %d, buffer list length: %d",this.packet.length,this._list.length),this._stateCounter>=this._states.length&&(this._stateCounter=0);return r("parse: exited while loop. packet: %d, buffer list length: %d",this.packet.length,this._list.length),this._list.length}_parseHeader(){const t=this._list.readUInt8(0),e=t>>u.CMD_SHIFT;this.packet.cmd=u.types[e];const i=15&t,f=u.requiredHeaderFlags[e];return f!=null&&i!==f?this._emitError(new Error(u.requiredHeaderFlagsErrors[e])):(this.packet.retain=(t&u.RETAIN_MASK)!=0,this.packet.qos=t>>u.QOS_SHIFT&u.QOS_MASK,this.packet.qos>2?this._emitError(new Error("Packet must not have both QoS bits set to 1")):(this.packet.dup=(t&u.DUP_MASK)!=0,r("_parseHeader: packet: %o",this.packet),this._list.consume(1),!0))}_parseLength(){const t=this._parseVarByteNum(!0);return t&&(this.packet.length=t.value,this._list.consume(t.bytes)),r("_parseLength %d",t.value),!!t}_parsePayload(){r("_parsePayload: payload %O",this._list);let t=!1;if(this.packet.length===0||this._list.length>=this.packet.length){switch(this._pos=0,this.packet.cmd){case"connect":this._parseConnect();break;case"connack":this._parseConnack();break;case"publish":this._parsePublish();break;case"puback":case"pubrec":case"pubrel":case"pubcomp":this._parseConfirmation();break;case"subscribe":this._parseSubscribe();break;case"suback":this._parseSuback();break;case"unsubscribe":this._parseUnsubscribe();break;case"unsuback":this._parseUnsuback();break;case"pingreq":case"pingresp":break;case"disconnect":this._parseDisconnect();break;case"auth":this._parseAuth();break;default:this._emitError(new Error("Not supported"))}t=!0}return r("_parsePayload complete result: %s",t),t}_parseConnect(){let t,e,i,f;r("_parseConnect");const h={},m=this.packet,y=this._parseString();if(y===null)return this._emitError(new Error("Cannot parse protocolId"));if(y!=="MQTT"&&y!=="MQIsdp")return this._emitError(new Error("Invalid protocolId"));if(m.protocolId=y,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(m.protocolVersion=this._list.readUInt8(this._pos),m.protocolVersion>=128&&(m.bridgeMode=!0,m.protocolVersion=m.protocolVersion-128),m.protocolVersion!==3&&m.protocolVersion!==4&&m.protocolVersion!==5)return this._emitError(new Error("Invalid protocol version"));if(this._pos++,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(1&this._list.readUInt8(this._pos))return this._emitError(new Error("Connect flag bit 0 must be 0, but got 1"));h.username=this._list.readUInt8(this._pos)&u.USERNAME_MASK,h.password=this._list.readUInt8(this._pos)&u.PASSWORD_MASK,h.will=this._list.readUInt8(this._pos)&u.WILL_FLAG_MASK;const E=!!(this._list.readUInt8(this._pos)&u.WILL_RETAIN_MASK),P=(this._list.readUInt8(this._pos)&u.WILL_QOS_MASK)>>u.WILL_QOS_SHIFT;if(h.will)m.will={},m.will.retain=E,m.will.qos=P;else{if(E)return this._emitError(new Error("Will Retain Flag must be set to zero when Will Flag is set to 0"));if(P)return this._emitError(new Error("Will QoS must be set to zero when Will Flag is set to 0"))}if(m.clean=(this._list.readUInt8(this._pos)&u.CLEAN_SESSION_MASK)!=0,this._pos++,m.keepalive=this._parseNum(),m.keepalive===-1)return this._emitError(new Error("Packet too short"));if(m.protocolVersion===5){const k=this._parseProperties();Object.getOwnPropertyNames(k).length&&(m.properties=k)}const M=this._parseString();if(M===null)return this._emitError(new Error("Packet too short"));if(m.clientId=M,r("_parseConnect: packet.clientId: %s",m.clientId),h.will){if(m.protocolVersion===5){const k=this._parseProperties();Object.getOwnPropertyNames(k).length&&(m.will.properties=k)}if(t=this._parseString(),t===null)return this._emitError(new Error("Cannot parse will topic"));if(m.will.topic=t,r("_parseConnect: packet.will.topic: %s",m.will.topic),e=this._parseBuffer(),e===null)return this._emitError(new Error("Cannot parse will payload"));m.will.payload=e,r("_parseConnect: packet.will.paylaod: %s",m.will.payload)}if(h.username){if(f=this._parseString(),f===null)return this._emitError(new Error("Cannot parse username"));m.username=f,r("_parseConnect: packet.username: %s",m.username)}if(h.password){if(i=this._parseBuffer(),i===null)return this._emitError(new Error("Cannot parse password"));m.password=i}return this.settings=m,r("_parseConnect: complete"),m}_parseConnack(){r("_parseConnack");const t=this.packet;if(this._list.length<1)return null;const e=this._list.readUInt8(this._pos++);if(e>1)return this._emitError(new Error("Invalid connack flags, bits 7-1 must be set to 0"));if(t.sessionPresent=!!(e&u.SESSIONPRESENT_MASK),this.settings.protocolVersion===5)this._list.length>=2?t.reasonCode=this._list.readUInt8(this._pos++):t.reasonCode=0;else{if(this._list.length<2)return null;t.returnCode=this._list.readUInt8(this._pos++)}if(t.returnCode===-1||t.reasonCode===-1)return this._emitError(new Error("Cannot parse return code"));if(this.settings.protocolVersion===5){const i=this._parseProperties();Object.getOwnPropertyNames(i).length&&(t.properties=i)}r("_parseConnack: complete")}_parsePublish(){r("_parsePublish");const t=this.packet;if(t.topic=this._parseString(),t.topic===null)return this._emitError(new Error("Cannot parse topic"));if(!(t.qos>0)||this._parseMessageId()){if(this.settings.protocolVersion===5){const e=this._parseProperties();Object.getOwnPropertyNames(e).length&&(t.properties=e)}t.payload=this._list.slice(this._pos,t.length),r("_parsePublish: payload from buffer list: %o",t.payload)}}_parseSubscribe(){r("_parseSubscribe");const t=this.packet;let e,i,f,h,m,y,E;if(t.subscriptions=[],this._parseMessageId()){if(this.settings.protocolVersion===5){const P=this._parseProperties();Object.getOwnPropertyNames(P).length&&(t.properties=P)}if(t.length<=0)return this._emitError(new Error("Malformed subscribe, no payload specified"));for(;this._pos<t.length;){if(e=this._parseString(),e===null)return this._emitError(new Error("Cannot parse topic"));if(this._pos>=t.length)return this._emitError(new Error("Malformed Subscribe Payload"));if(i=this._parseByte(),this.settings.protocolVersion===5){if(192&i)return this._emitError(new Error("Invalid subscribe topic flag bits, bits 7-6 must be 0"))}else if(252&i)return this._emitError(new Error("Invalid subscribe topic flag bits, bits 7-2 must be 0"));if(f=i&u.SUBSCRIBE_OPTIONS_QOS_MASK,f>2)return this._emitError(new Error("Invalid subscribe QoS, must be <= 2"));if(y=(i>>u.SUBSCRIBE_OPTIONS_NL_SHIFT&u.SUBSCRIBE_OPTIONS_NL_MASK)!=0,m=(i>>u.SUBSCRIBE_OPTIONS_RAP_SHIFT&u.SUBSCRIBE_OPTIONS_RAP_MASK)!=0,h=i>>u.SUBSCRIBE_OPTIONS_RH_SHIFT&u.SUBSCRIBE_OPTIONS_RH_MASK,h>2)return this._emitError(new Error("Invalid retain handling, must be <= 2"));E={topic:e,qos:f},this.settings.protocolVersion===5?(E.nl=y,E.rap=m,E.rh=h):this.settings.bridgeMode&&(E.rh=0,E.rap=!0,E.nl=!0),r("_parseSubscribe: push subscription `%s` to subscription",E),t.subscriptions.push(E)}}}_parseSuback(){r("_parseSuback");const t=this.packet;if(this.packet.granted=[],this._parseMessageId()){if(this.settings.protocolVersion===5){const e=this._parseProperties();Object.getOwnPropertyNames(e).length&&(t.properties=e)}if(t.length<=0)return this._emitError(new Error("Malformed suback, no payload specified"));for(;this._pos<this.packet.length;){const e=this._list.readUInt8(this._pos++);if(this.settings.protocolVersion===5){if(!u.MQTT5_SUBACK_CODES[e])return this._emitError(new Error("Invalid suback code"))}else if(e>2&&e!==128)return this._emitError(new Error("Invalid suback QoS, must be 0, 1, 2 or 128"));this.packet.granted.push(e)}}}_parseUnsubscribe(){r("_parseUnsubscribe");const t=this.packet;if(t.unsubscriptions=[],this._parseMessageId()){if(this.settings.protocolVersion===5){const e=this._parseProperties();Object.getOwnPropertyNames(e).length&&(t.properties=e)}if(t.length<=0)return this._emitError(new Error("Malformed unsubscribe, no payload specified"));for(;this._pos<t.length;){const e=this._parseString();if(e===null)return this._emitError(new Error("Cannot parse topic"));r("_parseUnsubscribe: push topic `%s` to unsubscriptions",e),t.unsubscriptions.push(e)}}}_parseUnsuback(){r("_parseUnsuback");const t=this.packet;if(!this._parseMessageId())return this._emitError(new Error("Cannot parse messageId"));if((this.settings.protocolVersion===3||this.settings.protocolVersion===4)&&t.length!==2)return this._emitError(new Error("Malformed unsuback, payload length must be 2"));if(t.length<=0)return this._emitError(new Error("Malformed unsuback, no payload specified"));if(this.settings.protocolVersion===5){const e=this._parseProperties();for(Object.getOwnPropertyNames(e).length&&(t.properties=e),t.granted=[];this._pos<this.packet.length;){const i=this._list.readUInt8(this._pos++);if(!u.MQTT5_UNSUBACK_CODES[i])return this._emitError(new Error("Invalid unsuback code"));this.packet.granted.push(i)}}}_parseConfirmation(){r("_parseConfirmation: packet.cmd: `%s`",this.packet.cmd);const t=this.packet;if(this._parseMessageId(),this.settings.protocolVersion===5){if(t.length>2){switch(t.reasonCode=this._parseByte(),this.packet.cmd){case"puback":case"pubrec":if(!u.MQTT5_PUBACK_PUBREC_CODES[t.reasonCode])return this._emitError(new Error("Invalid "+this.packet.cmd+" reason code"));break;case"pubrel":case"pubcomp":if(!u.MQTT5_PUBREL_PUBCOMP_CODES[t.reasonCode])return this._emitError(new Error("Invalid "+this.packet.cmd+" reason code"))}r("_parseConfirmation: packet.reasonCode `%d`",t.reasonCode)}else t.reasonCode=0;if(t.length>3){const e=this._parseProperties();Object.getOwnPropertyNames(e).length&&(t.properties=e)}}return!0}_parseDisconnect(){const t=this.packet;if(r("_parseDisconnect"),this.settings.protocolVersion===5){this._list.length>0?(t.reasonCode=this._parseByte(),u.MQTT5_DISCONNECT_CODES[t.reasonCode]||this._emitError(new Error("Invalid disconnect reason code"))):t.reasonCode=0;const e=this._parseProperties();Object.getOwnPropertyNames(e).length&&(t.properties=e)}return r("_parseDisconnect result: true"),!0}_parseAuth(){r("_parseAuth");const t=this.packet;if(this.settings.protocolVersion!==5)return this._emitError(new Error("Not supported auth packet for this version MQTT"));if(t.reasonCode=this._parseByte(),!u.MQTT5_AUTH_CODES[t.reasonCode])return this._emitError(new Error("Invalid auth reason code"));const e=this._parseProperties();return Object.getOwnPropertyNames(e).length&&(t.properties=e),r("_parseAuth: result: true"),!0}_parseMessageId(){const t=this.packet;return t.messageId=this._parseNum(),t.messageId===null?(this._emitError(new Error("Cannot parse messageId")),!1):(r("_parseMessageId: packet.messageId %d",t.messageId),!0)}_parseString(t){const e=this._parseNum(),i=e+this._pos;if(e===-1||i>this._list.length||i>this.packet.length)return null;const f=this._list.toString("utf8",this._pos,i);return this._pos+=e,r("_parseString: result: %s",f),f}_parseStringPair(){return r("_parseStringPair"),{name:this._parseString(),value:this._parseString()}}_parseBuffer(){const t=this._parseNum(),e=t+this._pos;if(t===-1||e>this._list.length||e>this.packet.length)return null;const i=this._list.slice(this._pos,e);return this._pos+=t,r("_parseBuffer: result: %o",i),i}_parseNum(){if(this._list.length-this._pos<2)return-1;const t=this._list.readUInt16BE(this._pos);return this._pos+=2,r("_parseNum: result: %s",t),t}_parse4ByteNum(){if(this._list.length-this._pos<4)return-1;const t=this._list.readUInt32BE(this._pos);return this._pos+=4,r("_parse4ByteNum: result: %s",t),t}_parseVarByteNum(t){r("_parseVarByteNum");let e,i=0,f=1,h=0,m=!1;const y=this._pos?this._pos:0;for(;i<4&&y+i<this._list.length;){if(e=this._list.readUInt8(y+i++),h+=f*(e&u.VARBYTEINT_MASK),f*=128,(e&u.VARBYTEINT_FIN_MASK)==0){m=!0;break}if(this._list.length<=i)break}return!m&&i===4&&this._list.length>=i&&this._emitError(new Error("Invalid variable byte integer")),y&&(this._pos+=i),m=!!m&&(t?{bytes:i,value:h}:h),r("_parseVarByteNum: result: %o",m),m}_parseByte(){let t;return this._pos<this._list.length&&(t=this._list.readUInt8(this._pos),this._pos++),r("_parseByte: result: %o",t),t}_parseByType(t){switch(r("_parseByType: type: %s",t),t){case"byte":return this._parseByte()!==0;case"int8":return this._parseByte();case"int16":return this._parseNum();case"int32":return this._parse4ByteNum();case"var":return this._parseVarByteNum();case"string":return this._parseString();case"pair":return this._parseStringPair();case"binary":return this._parseBuffer()}}_parseProperties(){r("_parseProperties");const t=this._parseVarByteNum(),e=this._pos+t,i={};for(;this._pos<e;){const f=this._parseByte();if(!f)return this._emitError(new Error("Cannot parse property code type")),!1;const h=u.propertiesCodes[f];if(!h)return this._emitError(new Error("Unknown property")),!1;if(h!=="userProperties")i[h]?(Array.isArray(i[h])||(i[h]=[i[h]]),i[h].push(this._parseByType(u.propertiesTypes[h]))):i[h]=this._parseByType(u.propertiesTypes[h]);else{i[h]||(i[h]=Object.create(null));const m=this._parseByType(u.propertiesTypes[h]);if(i[h][m.name])if(Array.isArray(i[h][m.name]))i[h][m.name].push(m.value);else{const y=i[h][m.name];i[h][m.name]=[y],i[h][m.name].push(m.value)}else i[h][m.name]=m.value}}return i}_newPacket(){return r("_newPacket"),this.packet&&(this._list.consume(this.packet.length),r("_newPacket: parser emit packet: packet.cmd: %s, packet.payload: %s, packet.length: %d",this.packet.cmd,this.packet.payload,this.packet.length),this.emit("packet",this.packet)),r("_newPacket: new packet"),this.packet=new g,this._pos=0,!0}_emitError(t){r("_emitError",t),this.error=t,this.emit("error",t)}}L.exports=o},{"./constants":73,"./packet":94,bl:77,debug:30,events:49}],96:[function(p,L,v){const a=p("./constants"),{Buffer:c}=p("buffer"),g=c.allocUnsafe(0),u=c.from([0]),r=p("./numbers"),o=p("process-nextick-args").nextTick,s=p("debug")("mqtt-packet:writeToStream"),t=r.cache,e=r.generateNumber,i=r.generateCache,f=r.genBufVariableByteInt,h=r.generate4ByteBuffer;let m=x,y=!0;function E(O,S,C){switch(s("generate called"),S.cork&&(S.cork(),o(P,S)),y&&(y=!1,i()),s("generate: packet.cmd: %s",O.cmd),O.cmd){case"connect":return function($,B,H){const F=$||{},W=F.protocolId||"MQTT";let J=F.protocolVersion||4;const Y=F.will;let Z=F.clean;const I=F.keepalive||0,n=F.clientId||"",l=F.username,b=F.password,R=F.properties;Z===void 0&&(Z=!0);let U,z,j=0;if(!W||typeof W!="string"&&!c.isBuffer(W))return B.destroy(new Error("Invalid protocolId")),!1;if(j+=W.length+2,J!==3&&J!==4&&J!==5)return B.destroy(new Error("Invalid protocol version")),!1;if(j+=1,(typeof n=="string"||c.isBuffer(n))&&(n||J>=4)&&(n||Z))j+=c.byteLength(n)+2;else{if(J<4)return B.destroy(new Error("clientId must be supplied before 3.1.1")),!1;if(1*Z==0)return B.destroy(new Error("clientId must be given if cleanSession set to 0")),!1}if(typeof I!="number"||I<0||I>65535||I%1!=0)return B.destroy(new Error("Invalid keepalive")),!1;if(j+=2,j+=1,J===5){if(U=d(B,R),!U)return!1;j+=U.length}if(Y){if(typeof Y!="object")return B.destroy(new Error("Invalid will")),!1;if(!Y.topic||typeof Y.topic!="string")return B.destroy(new Error("Invalid will topic")),!1;if(j+=c.byteLength(Y.topic)+2,j+=2,Y.payload){if(!(Y.payload.length>=0))return B.destroy(new Error("Invalid will payload")),!1;typeof Y.payload=="string"?j+=c.byteLength(Y.payload):j+=Y.payload.length}if(z={},J===5){if(z=d(B,Y.properties),!z)return!1;j+=z.length}}let K=!1;if(l!=null){if(!X(l))return B.destroy(new Error("Invalid username")),!1;K=!0,j+=c.byteLength(l)+2}if(b!=null){if(!K)return B.destroy(new Error("Username is required to use password")),!1;if(!X(b))return B.destroy(new Error("Invalid password")),!1;j+=Q(b)+2}B.write(a.CONNECT_HEADER),k(B,j),D(B,W),F.bridgeMode&&(J+=128),B.write(J===131?a.VERSION131:J===132?a.VERSION132:J===4?a.VERSION4:J===5?a.VERSION5:a.VERSION3);let tt=0;return tt|=l!=null?a.USERNAME_MASK:0,tt|=b!=null?a.PASSWORD_MASK:0,tt|=Y&&Y.retain?a.WILL_RETAIN_MASK:0,tt|=Y&&Y.qos?Y.qos<<a.WILL_QOS_SHIFT:0,tt|=Y?a.WILL_FLAG_MASK:0,tt|=Z?a.CLEAN_SESSION_MASK:0,B.write(c.from([tt])),m(B,I),J===5&&U.write(),D(B,n),Y&&(J===5&&z.write(),w(B,Y.topic),D(B,Y.payload)),l!=null&&D(B,l),b!=null&&D(B,b),!0}(O,S);case"connack":return function($,B,H){const F=H?H.protocolVersion:4,W=$||{},J=F===5?W.reasonCode:W.returnCode,Y=W.properties;let Z=2;if(typeof J!="number")return B.destroy(new Error("Invalid return code")),!1;let I=null;if(F===5){if(I=d(B,Y),!I)return!1;Z+=I.length}return B.write(a.CONNACK_HEADER),k(B,Z),B.write(W.sessionPresent?a.SESSIONPRESENT_HEADER:u),B.write(c.from([J])),I!=null&&I.write(),!0}(O,S,C);case"publish":return function($,B,H){s("publish: packet: %o",$);const F=H?H.protocolVersion:4,W=$||{},J=W.qos||0,Y=W.retain?a.RETAIN_MASK:0,Z=W.topic,I=W.payload||g,n=W.messageId,l=W.properties;let b=0;if(typeof Z=="string")b+=c.byteLength(Z)+2;else{if(!c.isBuffer(Z))return B.destroy(new Error("Invalid topic")),!1;b+=Z.length+2}if(c.isBuffer(I)?b+=I.length:b+=c.byteLength(I),J&&typeof n!="number")return B.destroy(new Error("Invalid messageId")),!1;J&&(b+=2);let R=null;if(F===5){if(R=d(B,l),!R)return!1;b+=R.length}return B.write(a.PUBLISH_HEADER[J][W.dup?1:0][Y?1:0]),k(B,b),m(B,Q(Z)),B.write(Z),J>0&&m(B,n),R!=null&&R.write(),s("publish: payload: %o",I),B.write(I)}(O,S,C);case"puback":case"pubrec":case"pubrel":case"pubcomp":return function($,B,H){const F=H?H.protocolVersion:4,W=$||{},J=W.cmd||"puback",Y=W.messageId,Z=W.dup&&J==="pubrel"?a.DUP_MASK:0;let I=0;const n=W.reasonCode,l=W.properties;let b=F===5?3:2;if(J==="pubrel"&&(I=1),typeof Y!="number")return B.destroy(new Error("Invalid messageId")),!1;let R=null;if(F===5&&typeof l=="object"){if(R=T(B,l,H,b),!R)return!1;b+=R.length}return B.write(a.ACKS[J][I][Z][0]),b===3&&(b+=n!==0?1:-1),k(B,b),m(B,Y),F===5&&b!==2&&B.write(c.from([n])),R!==null?R.write():b===4&&B.write(c.from([0])),!0}(O,S,C);case"subscribe":return function($,B,H){s("subscribe: packet: ");const F=H?H.protocolVersion:4,W=$||{},J=W.dup?a.DUP_MASK:0,Y=W.messageId,Z=W.subscriptions,I=W.properties;let n=0;if(typeof Y!="number")return B.destroy(new Error("Invalid messageId")),!1;n+=2;let l=null;if(F===5){if(l=d(B,I),!l)return!1;n+=l.length}if(typeof Z!="object"||!Z.length)return B.destroy(new Error("Invalid subscriptions")),!1;for(let R=0;R<Z.length;R+=1){const U=Z[R].topic,z=Z[R].qos;if(typeof U!="string")return B.destroy(new Error("Invalid subscriptions - invalid topic")),!1;if(typeof z!="number")return B.destroy(new Error("Invalid subscriptions - invalid qos")),!1;if(F===5){if(typeof(Z[R].nl||!1)!="boolean")return B.destroy(new Error("Invalid subscriptions - invalid No Local")),!1;if(typeof(Z[R].rap||!1)!="boolean")return B.destroy(new Error("Invalid subscriptions - invalid Retain as Published")),!1;const j=Z[R].rh||0;if(typeof j!="number"||j>2)return B.destroy(new Error("Invalid subscriptions - invalid Retain Handling")),!1}n+=c.byteLength(U)+2+1}s("subscribe: writing to stream: %o",a.SUBSCRIBE_HEADER),B.write(a.SUBSCRIBE_HEADER[1][J?1:0][0]),k(B,n),m(B,Y),l!==null&&l.write();let b=!0;for(const R of Z){const U=R.topic,z=R.qos,j=+R.nl,K=+R.rap,tt=R.rh;let et;w(B,U),et=a.SUBSCRIBE_OPTIONS_QOS[z],F===5&&(et|=j?a.SUBSCRIBE_OPTIONS_NL:0,et|=K?a.SUBSCRIBE_OPTIONS_RAP:0,et|=tt?a.SUBSCRIBE_OPTIONS_RH[tt]:0),b=B.write(c.from([et]))}return b}(O,S,C);case"suback":return function($,B,H){const F=H?H.protocolVersion:4,W=$||{},J=W.messageId,Y=W.granted,Z=W.properties;let I=0;if(typeof J!="number")return B.destroy(new Error("Invalid messageId")),!1;if(I+=2,typeof Y!="object"||!Y.length)return B.destroy(new Error("Invalid qos vector")),!1;for(let l=0;l<Y.length;l+=1){if(typeof Y[l]!="number")return B.destroy(new Error("Invalid qos vector")),!1;I+=1}let n=null;if(F===5){if(n=T(B,Z,H,I),!n)return!1;I+=n.length}return B.write(a.SUBACK_HEADER),k(B,I),m(B,J),n!==null&&n.write(),B.write(c.from(Y))}(O,S,C);case"unsubscribe":return function($,B,H){const F=H?H.protocolVersion:4,W=$||{},J=W.messageId,Y=W.dup?a.DUP_MASK:0,Z=W.unsubscriptions,I=W.properties;let n=0;if(typeof J!="number")return B.destroy(new Error("Invalid messageId")),!1;if(n+=2,typeof Z!="object"||!Z.length)return B.destroy(new Error("Invalid unsubscriptions")),!1;for(let R=0;R<Z.length;R+=1){if(typeof Z[R]!="string")return B.destroy(new Error("Invalid unsubscriptions")),!1;n+=c.byteLength(Z[R])+2}let l=null;if(F===5){if(l=d(B,I),!l)return!1;n+=l.length}B.write(a.UNSUBSCRIBE_HEADER[1][Y?1:0][0]),k(B,n),m(B,J),l!==null&&l.write();let b=!0;for(let R=0;R<Z.length;R++)b=w(B,Z[R]);return b}(O,S,C);case"unsuback":return function($,B,H){const F=H?H.protocolVersion:4,W=$||{},J=W.messageId,Y=W.dup?a.DUP_MASK:0,Z=W.granted,I=W.properties,n=W.cmd,l=0;let b=2;if(typeof J!="number")return B.destroy(new Error("Invalid messageId")),!1;if(F===5){if(typeof Z!="object"||!Z.length)return B.destroy(new Error("Invalid qos vector")),!1;for(let U=0;U<Z.length;U+=1){if(typeof Z[U]!="number")return B.destroy(new Error("Invalid qos vector")),!1;b+=1}}let R=null;if(F===5){if(R=T(B,I,H,b),!R)return!1;b+=R.length}return B.write(a.ACKS[n][l][Y][0]),k(B,b),m(B,J),R!==null&&R.write(),F===5&&B.write(c.from(Z)),!0}(O,S,C);case"pingreq":case"pingresp":return function($,B,H){return B.write(a.EMPTY[$.cmd])}(O,S);case"disconnect":return function($,B,H){const F=H?H.protocolVersion:4,W=$||{},J=W.reasonCode,Y=W.properties;let Z=F===5?1:0,I=null;if(F===5){if(I=T(B,Y,H,Z),!I)return!1;Z+=I.length}return B.write(c.from([a.codes.disconnect<<4])),k(B,Z),F===5&&B.write(c.from([J])),I!==null&&I.write(),!0}(O,S,C);case"auth":return function($,B,H){const F=H?H.protocolVersion:4,W=$||{},J=W.reasonCode,Y=W.properties;let Z=F===5?1:0;F!==5&&B.destroy(new Error("Invalid mqtt version for auth packet"));const I=T(B,Y,H,Z);return I?(Z+=I.length,B.write(c.from([a.codes.auth<<4])),k(B,Z),B.write(c.from([J])),I!==null&&I.write(),!0):!1}(O,S,C);default:return S.destroy(new Error("Unknown command")),!1}}function P(O){O.uncork()}Object.defineProperty(E,"cacheNumbers",{get:()=>m===x,set(O){O?(t&&Object.keys(t).length!==0||(y=!0),m=x):(y=!1,m=V)}});const M={};function k(O,S){if(S>a.VARBYTEINT_MAX)return O.destroy(new Error(`Invalid variable byte integer: ${S}`)),!1;let C=M[S];return C||(C=f(S),S<16384&&(M[S]=C)),s("writeVarByteInt: writing to stream: %o",C),O.write(C)}function w(O,S){const C=c.byteLength(S);return m(O,C),s("writeString: %s",S),O.write(S,"utf8")}function _(O,S,C){w(O,S),w(O,C)}function x(O,S){return s("writeNumberCached: number: %d",S),s("writeNumberCached: %o",t[S]),O.write(t[S])}function V(O,S){const C=e(S);return s("writeNumberGenerated: %o",C),O.write(C)}function D(O,S){typeof S=="string"?w(O,S):S?(m(O,S.length),O.write(S)):m(O,0)}function d(O,S){if(typeof S!="object"||S.length!=null)return{length:1,write(){G(O,{},0)}};let C=0;function $(B,H){let F=0;switch(a.propertiesTypes[B]){case"byte":if(typeof H!="boolean")return O.destroy(new Error(`Invalid ${B}: ${H}`)),!1;F+=2;break;case"int8":if(typeof H!="number"||H<0||H>255)return O.destroy(new Error(`Invalid ${B}: ${H}`)),!1;F+=2;break;case"binary":if(H&&H===null)return O.destroy(new Error(`Invalid ${B}: ${H}`)),!1;F+=1+c.byteLength(H)+2;break;case"int16":if(typeof H!="number"||H<0||H>65535)return O.destroy(new Error(`Invalid ${B}: ${H}`)),!1;F+=3;break;case"int32":if(typeof H!="number"||H<0||H>4294967295)return O.destroy(new Error(`Invalid ${B}: ${H}`)),!1;F+=5;break;case"var":if(typeof H!="number"||H<0||H>268435455)return O.destroy(new Error(`Invalid ${B}: ${H}`)),!1;F+=1+c.byteLength(f(H));break;case"string":if(typeof H!="string")return O.destroy(new Error(`Invalid ${B}: ${H}`)),!1;F+=3+c.byteLength(H.toString());break;case"pair":if(typeof H!="object")return O.destroy(new Error(`Invalid ${B}: ${H}`)),!1;F+=Object.getOwnPropertyNames(H).reduce((W,J)=>{const Y=H[J];return Array.isArray(Y)?W+=Y.reduce((Z,I)=>Z+=3+c.byteLength(J.toString())+2+c.byteLength(I.toString()),0):W+=3+c.byteLength(J.toString())+2+c.byteLength(H[J].toString()),W},0);break;default:return O.destroy(new Error(`Invalid property ${B}: ${H}`)),!1}return F}if(S)for(const B in S){let H=0,F=0;const W=S[B];if(Array.isArray(W))for(let J=0;J<W.length;J++){if(F=$(B,W[J]),!F)return!1;H+=F}else{if(F=$(B,W),!F)return!1;H=F}if(!H)return!1;C+=H}return{length:c.byteLength(f(C))+C,write(){G(O,S,C)}}}function T(O,S,C,$){const B=["reasonString","userProperties"],H=C&&C.properties&&C.properties.maximumPacketSize?C.properties.maximumPacketSize:0;let F=d(O,S);if(H)for(;$+F.length>H;){const W=B.shift();if(!W||!S[W])return!1;delete S[W],F=d(O,S)}return F}function A(O,S,C){switch(a.propertiesTypes[S]){case"byte":O.write(c.from([a.properties[S]])),O.write(c.from([+C]));break;case"int8":O.write(c.from([a.properties[S]])),O.write(c.from([C]));break;case"binary":O.write(c.from([a.properties[S]])),D(O,C);break;case"int16":O.write(c.from([a.properties[S]])),m(O,C);break;case"int32":O.write(c.from([a.properties[S]])),function($,B){const H=h(B);s("write4ByteNumber: %o",H),$.write(H)}(O,C);break;case"var":O.write(c.from([a.properties[S]])),k(O,C);break;case"string":O.write(c.from([a.properties[S]])),w(O,C);break;case"pair":Object.getOwnPropertyNames(C).forEach($=>{const B=C[$];Array.isArray(B)?B.forEach(H=>{O.write(c.from([a.properties[S]])),_(O,$.toString(),H.toString())}):(O.write(c.from([a.properties[S]])),_(O,$.toString(),B.toString()))});break;default:return O.destroy(new Error(`Invalid property ${S} value: ${C}`)),!1}}function G(O,S,C){k(O,C);for(const $ in S)if(Object.prototype.hasOwnProperty.call(S,$)&&S[$]!==null){const B=S[$];if(Array.isArray(B))for(let H=0;H<B.length;H++)A(O,$,B[H]);else A(O,$,B)}}function Q(O){return O?O instanceof c?O.length:c.byteLength(O):0}function X(O){return typeof O=="string"||O instanceof c}L.exports=E},{"./constants":73,"./numbers":93,buffer:29,debug:30,"process-nextick-args":101}],97:[function(p,L,v){var a=1e3,c=60*a,g=60*c,u=24*g,r=7*u,o=365.25*u;function s(t,e,i,f){var h=e>=1.5*i;return Math.round(t/i)+" "+f+(h?"s":"")}L.exports=function(t,e){e=e||{};var i=typeof t;if(i==="string"&&t.length>0)return function(f){if(!((f=String(f)).length>100)){var h=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(f);if(h){var m=parseFloat(h[1]);switch((h[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return m*o;case"weeks":case"week":case"w":return m*r;case"days":case"day":case"d":return m*u;case"hours":case"hour":case"hrs":case"hr":case"h":return m*g;case"minutes":case"minute":case"mins":case"min":case"m":return m*c;case"seconds":case"second":case"secs":case"sec":case"s":return m*a;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return m;default:return}}}}(t);if(i==="number"&&isFinite(t))return e.long?function(f){var h=Math.abs(f);return h>=u?s(f,h,u,"day"):h>=g?s(f,h,g,"hour"):h>=c?s(f,h,c,"minute"):h>=a?s(f,h,a,"second"):f+" ms"}(t):function(f){var h=Math.abs(f);return h>=u?Math.round(f/u)+"d":h>=g?Math.round(f/g)+"h":h>=c?Math.round(f/c)+"m":h>=a?Math.round(f/a)+"s":f+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},{}],98:[function(p,L,v){const a=p("./lib/number-allocator.js");L.exports.NumberAllocator=a},{"./lib/number-allocator.js":99}],99:[function(p,L,v){const a=p("js-sdsl").OrderedSet,c=p("debug")("number-allocator:trace"),g=p("debug")("number-allocator:error");function u(o,s){this.low=o,this.high=s}function r(o,s){if(!(this instanceof r))return new r(o,s);this.min=o,this.max=s,this.ss=new a([],(t,e)=>t.compare(e)),c("Create"),this.clear()}u.prototype.equals=function(o){return this.low===o.low&&this.high===o.high},u.prototype.compare=function(o){return this.low<o.low&&this.high<o.low?-1:o.low<this.low&&o.high<this.low?1:0},r.prototype.firstVacant=function(){return this.ss.size()===0?null:this.ss.front().low},r.prototype.alloc=function(){if(this.ss.size()===0)return c("alloc():empty"),null;const o=this.ss.begin(),s=o.pointer.low,t=o.pointer.high,e=s;return e+1<=t?this.ss.updateKeyByIterator(o,new u(s+1,t)):this.ss.eraseElementByPos(0),c("alloc():"+e),e},r.prototype.use=function(o){const s=new u(o,o),t=this.ss.lowerBound(s);if(!t.equals(this.ss.end())){const e=t.pointer.low,i=t.pointer.high;return t.pointer.equals(s)?(this.ss.eraseElementByIterator(t),c("use():"+o),!0):!(e>o)&&(e===o?(this.ss.updateKeyByIterator(t,new u(e+1,i)),c("use():"+o),!0):i===o?(this.ss.updateKeyByIterator(t,new u(e,i-1)),c("use():"+o),!0):(this.ss.updateKeyByIterator(t,new u(o+1,i)),this.ss.insert(new u(e,o-1)),c("use():"+o),!0))}return c("use():failed"),!1},r.prototype.free=function(o){if(o<this.min||o>this.max)return void g("free():"+o+" is out of range");const s=new u(o,o),t=this.ss.upperBound(s);if(t.equals(this.ss.end())){if(t.equals(this.ss.begin()))return void this.ss.insert(s);t.pre();const e=t.pointer.high;t.pointer.high+1===o?this.ss.updateKeyByIterator(t,new u(e,o)):this.ss.insert(s)}else if(t.equals(this.ss.begin()))if(o+1===t.pointer.low){const e=t.pointer.high;this.ss.updateKeyByIterator(t,new u(o,e))}else this.ss.insert(s);else{const e=t.pointer.low,i=t.pointer.high;t.pre();const f=t.pointer.low;t.pointer.high+1===o?o+1===e?(this.ss.eraseElementByIterator(t),this.ss.updateKeyByIterator(t,new u(f,i))):this.ss.updateKeyByIterator(t,new u(f,o)):o+1===e?(this.ss.eraseElementByIterator(t.next()),this.ss.insert(new u(o,i))):this.ss.insert(s)}c("free():"+o)},r.prototype.clear=function(){c("clear()"),this.ss.clear(),this.ss.insert(new u(this.min,this.max))},r.prototype.intervalCount=function(){return this.ss.size()},r.prototype.dump=function(){console.log("length:"+this.ss.size());for(const o of this.ss)console.log(o)},L.exports=r},{debug:30,"js-sdsl":69}],100:[function(p,L,v){var a=p("wrappy");function c(u){var r=function(){return r.called?r.value:(r.called=!0,r.value=u.apply(this,arguments))};return r.called=!1,r}function g(u){var r=function(){if(r.called)throw new Error(r.onceError);return r.called=!0,r.value=u.apply(this,arguments)},o=u.name||"Function wrapped with `once`";return r.onceError=o+" shouldn't be called more than once",r.called=!1,r}L.exports=a(c),L.exports.strict=a(g),c.proto=c(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return c(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return g(this)},configurable:!0})})},{wrappy:140}],101:[function(p,L,v){(function(a){(function(){a===void 0||!a.version||a.version.indexOf("v0.")===0||a.version.indexOf("v1.")===0&&a.version.indexOf("v1.8.")!==0?L.exports={nextTick:function(c,g,u,r){if(typeof c!="function")throw new TypeError('"callback" argument must be a function');var o,s,t=arguments.length;switch(t){case 0:case 1:return a.nextTick(c);case 2:return a.nextTick(function(){c.call(null,g)});case 3:return a.nextTick(function(){c.call(null,g,u)});case 4:return a.nextTick(function(){c.call(null,g,u,r)});default:for(o=new Array(t-1),s=0;s<o.length;)o[s++]=arguments[s];return a.nextTick(function(){c.apply(null,o)})}}}:L.exports=a}).call(this)}).call(this,p("_process"))},{_process:102}],102:[function(p,L,v){var a,c,g=L.exports={};function u(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(E){if(a===setTimeout)return setTimeout(E,0);if((a===u||!a)&&setTimeout)return a=setTimeout,setTimeout(E,0);try{return a(E,0)}catch{try{return a.call(null,E,0)}catch{return a.call(this,E,0)}}}(function(){try{a=typeof setTimeout=="function"?setTimeout:u}catch{a=u}try{c=typeof clearTimeout=="function"?clearTimeout:r}catch{c=r}})();var s,t=[],e=!1,i=-1;function f(){e&&s&&(e=!1,s.length?t=s.concat(t):i=-1,t.length&&h())}function h(){if(!e){var E=o(f);e=!0;for(var P=t.length;P;){for(s=t,t=[];++i<P;)s&&s[i].run();i=-1,P=t.length}s=null,e=!1,function(M){if(c===clearTimeout)return clearTimeout(M);if((c===r||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(M);try{return c(M)}catch{try{return c.call(null,M)}catch{return c.call(this,M)}}}(E)}}function m(E,P){this.fun=E,this.array=P}function y(){}g.nextTick=function(E){var P=new Array(arguments.length-1);if(arguments.length>1)for(var M=1;M<arguments.length;M++)P[M-1]=arguments[M];t.push(new m(E,P)),t.length!==1||e||o(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},g.title="browser",g.browser=!0,g.env={},g.argv=[],g.version="",g.versions={},g.on=y,g.addListener=y,g.once=y,g.off=y,g.removeListener=y,g.removeAllListeners=y,g.emit=y,g.prependListener=y,g.prependOnceListener=y,g.listeners=function(E){return[]},g.binding=function(E){throw new Error("process.binding is not supported")},g.cwd=function(){return"/"},g.chdir=function(E){throw new Error("process.chdir is not supported")},g.umask=function(){return 0}},{}],103:[function(p,L,v){(function(a){(function(){(function(c){var g=typeof v=="object"&&v&&!v.nodeType&&v,u=typeof L=="object"&&L&&!L.nodeType&&L,r=typeof a=="object"&&a;r.global!==r&&r.window!==r&&r.self!==r||(c=r);var o,s,t=2147483647,e=36,i=1,f=26,h=38,m=700,y=72,E=128,P="-",M=/^xn--/,k=/[^\x20-\x7E]/,w=/[\x2E\u3002\uFF0E\uFF61]/g,_={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},x=e-i,V=Math.floor,D=String.fromCharCode;function d($){throw new RangeError(_[$])}function T($,B){for(var H=$.length,F=[];H--;)F[H]=B($[H]);return F}function A($,B){var H=$.split("@"),F="";return H.length>1&&(F=H[0]+"@",$=H[1]),F+T(($=$.replace(w,".")).split("."),B).join(".")}function G($){for(var B,H,F=[],W=0,J=$.length;W<J;)(B=$.charCodeAt(W++))>=55296&&B<=56319&&W<J?(64512&(H=$.charCodeAt(W++)))==56320?F.push(((1023&B)<<10)+(1023&H)+65536):(F.push(B),W--):F.push(B);return F}function Q($){return T($,function(B){var H="";return B>65535&&(H+=D((B-=65536)>>>10&1023|55296),B=56320|1023&B),H+=D(B)}).join("")}function X($,B){return $+22+75*($<26)-((B!=0)<<5)}function O($,B,H){var F=0;for($=H?V($/m):$>>1,$+=V($/B);$>x*f>>1;F+=e)$=V($/x);return V(F+(x+1)*$/($+h))}function S($){var B,H,F,W,J,Y,Z,I,n,l,b,R=[],U=$.length,z=0,j=E,K=y;for((H=$.lastIndexOf(P))<0&&(H=0),F=0;F<H;++F)$.charCodeAt(F)>=128&&d("not-basic"),R.push($.charCodeAt(F));for(W=H>0?H+1:0;W<U;){for(J=z,Y=1,Z=e;W>=U&&d("invalid-input"),((I=(b=$.charCodeAt(W++))-48<10?b-22:b-65<26?b-65:b-97<26?b-97:e)>=e||I>V((t-z)/Y))&&d("overflow"),z+=I*Y,!(I<(n=Z<=K?i:Z>=K+f?f:Z-K));Z+=e)Y>V(t/(l=e-n))&&d("overflow"),Y*=l;K=O(z-J,B=R.length+1,J==0),V(z/B)>t-j&&d("overflow"),j+=V(z/B),z%=B,R.splice(z++,0,j)}return Q(R)}function C($){var B,H,F,W,J,Y,Z,I,n,l,b,R,U,z,j,K=[];for(R=($=G($)).length,B=E,H=0,J=y,Y=0;Y<R;++Y)(b=$[Y])<128&&K.push(D(b));for(F=W=K.length,W&&K.push(P);F<R;){for(Z=t,Y=0;Y<R;++Y)(b=$[Y])>=B&&b<Z&&(Z=b);for(Z-B>V((t-H)/(U=F+1))&&d("overflow"),H+=(Z-B)*U,B=Z,Y=0;Y<R;++Y)if((b=$[Y])<B&&++H>t&&d("overflow"),b==B){for(I=H,n=e;!(I<(l=n<=J?i:n>=J+f?f:n-J));n+=e)j=I-l,z=e-l,K.push(D(X(l+j%z,0))),I=V(j/z);K.push(D(X(I,0))),J=O(H,U,F==W),H=0,++F}++H,++B}return K.join("")}if(o={version:"1.4.1",ucs2:{decode:G,encode:Q},decode:S,encode:C,toASCII:function($){return A($,function(B){return k.test(B)?"xn--"+C(B):B})},toUnicode:function($){return A($,function(B){return M.test(B)?S(B.slice(4).toLowerCase()):B})}},g&&u)if(L.exports==g)u.exports=o;else for(s in o)o.hasOwnProperty(s)&&(g[s]=o[s]);else c.punycode=o})(this)}).call(this)}).call(this,typeof wt<"u"?wt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],104:[function(p,L,v){function a(g,u){return Object.prototype.hasOwnProperty.call(g,u)}L.exports=function(g,u,r,o){u=u||"&",r=r||"=";var s={};if(typeof g!="string"||g.length===0)return s;var t=/\+/g;g=g.split(u);var e=1e3;o&&typeof o.maxKeys=="number"&&(e=o.maxKeys);var i=g.length;e>0&&i>e&&(i=e);for(var f=0;f<i;++f){var h,m,y,E,P=g[f].replace(t,"%20"),M=P.indexOf(r);M>=0?(h=P.substr(0,M),m=P.substr(M+1)):(h=P,m=""),y=decodeURIComponent(h),E=decodeURIComponent(m),a(s,y)?c(s[y])?s[y].push(E):s[y]=[s[y],E]:s[y]=E}return s};var c=Array.isArray||function(g){return Object.prototype.toString.call(g)==="[object Array]"}},{}],105:[function(p,L,v){var a=function(r){switch(typeof r){case"string":return r;case"boolean":return r?"true":"false";case"number":return isFinite(r)?r:"";default:return""}};L.exports=function(r,o,s,t){return o=o||"&",s=s||"=",r===null&&(r=void 0),typeof r=="object"?g(u(r),function(e){var i=encodeURIComponent(a(e))+s;return c(r[e])?g(r[e],function(f){return i+encodeURIComponent(a(f))}).join(o):i+encodeURIComponent(a(r[e]))}).join(o):t?encodeURIComponent(a(t))+s+encodeURIComponent(a(r)):""};var c=Array.isArray||function(r){return Object.prototype.toString.call(r)==="[object Array]"};function g(r,o){if(r.map)return r.map(o);for(var s=[],t=0;t<r.length;t++)s.push(o(r[t],t));return s}var u=Object.keys||function(r){var o=[];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&o.push(s);return o}},{}],106:[function(p,L,v){v.decode=v.parse=p("./decode"),v.encode=v.stringify=p("./encode")},{"./decode":104,"./encode":105}],107:[function(p,L,v){const{AbortError:a,codes:c}=p("../../ours/errors"),{isNodeStream:g,isWebStream:u,kControllerErrorFunction:r}=p("./utils"),o=p("./end-of-stream"),{ERR_INVALID_ARG_TYPE:s}=c;L.exports.addAbortSignal=function(t,e){if(((i,f)=>{if(typeof i!="object"||!("aborted"in i))throw new s(f,"AbortSignal",i)})(t,"signal"),!g(e)&&!u(e))throw new s("stream",["ReadableStream","WritableStream","Stream"],e);return L.exports.addAbortSignalNoValidate(t,e)},L.exports.addAbortSignalNoValidate=function(t,e){if(typeof t!="object"||!("aborted"in t))return e;const i=g(e)?()=>{e.destroy(new a(void 0,{cause:t.reason}))}:()=>{e[r](new a(void 0,{cause:t.reason}))};return t.aborted?i():(t.addEventListener("abort",i),o(e,()=>t.removeEventListener("abort",i))),e}},{"../../ours/errors":126,"./end-of-stream":113,"./utils":122}],108:[function(p,L,v){const{StringPrototypeSlice:a,SymbolIterator:c,TypedArrayPrototypeSet:g,Uint8Array:u}=p("../../ours/primordials"),{Buffer:r}=p("buffer"),{inspect:o}=p("../../ours/util");L.exports=class{constructor(){this.head=null,this.tail=null,this.length=0}push(s){const t={data:s,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}unshift(s){const t={data:s,next:this.head};this.length===0&&(this.tail=t),this.head=t,++this.length}shift(){if(this.length===0)return;const s=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,s}clear(){this.head=this.tail=null,this.length=0}join(s){if(this.length===0)return"";let t=this.head,e=""+t.data;for(;(t=t.next)!==null;)e+=s+t.data;return e}concat(s){if(this.length===0)return r.alloc(0);const t=r.allocUnsafe(s>>>0);let e=this.head,i=0;for(;e;)g(t,e.data,i),i+=e.data.length,e=e.next;return t}consume(s,t){const e=this.head.data;if(s<e.length){const i=e.slice(0,s);return this.head.data=e.slice(s),i}return s===e.length?this.shift():t?this._getString(s):this._getBuffer(s)}first(){return this.head.data}*[c](){for(let s=this.head;s;s=s.next)yield s.data}_getString(s){let t="",e=this.head,i=0;do{const f=e.data;if(!(s>f.length)){s===f.length?(t+=f,++i,e.next?this.head=e.next:this.head=this.tail=null):(t+=a(f,0,s),this.head=e,e.data=a(f,s));break}t+=f,s-=f.length,++i}while((e=e.next)!==null);return this.length-=i,t}_getBuffer(s){const t=r.allocUnsafe(s),e=s;let i=this.head,f=0;do{const h=i.data;if(!(s>h.length)){s===h.length?(g(t,h,e-s),++f,i.next?this.head=i.next:this.head=this.tail=null):(g(t,new u(h.buffer,h.byteOffset,s),e-s),this.head=i,i.data=h.slice(s));break}g(t,h,e-s),s-=h.length,++f}while((i=i.next)!==null);return this.length-=f,t}[Symbol.for("nodejs.util.inspect.custom")](s,t){return o(this,{...t,depth:0,customInspect:!1})}}},{"../../ours/primordials":127,"../../ours/util":128,buffer:29}],109:[function(p,L,v){const{pipeline:a}=p("./pipeline"),c=p("./duplex"),{destroyer:g}=p("./destroy"),{isNodeStream:u,isReadable:r,isWritable:o,isWebStream:s,isTransformStream:t,isWritableStream:e,isReadableStream:i}=p("./utils"),{AbortError:f,codes:{ERR_INVALID_ARG_VALUE:h,ERR_MISSING_ARGS:m}}=p("../../ours/errors"),y=p("./end-of-stream");L.exports=function(...E){if(E.length===0)throw new m("streams");if(E.length===1)return c.from(E[0]);const P=[...E];if(typeof E[0]=="function"&&(E[0]=c.from(E[0])),typeof E[E.length-1]=="function"){const A=E.length-1;E[A]=c.from(E[A])}for(let A=0;A<E.length;++A)if(u(E[A])||s(E[A])){if(A<E.length-1&&!(r(E[A])||i(E[A])||t(E[A])))throw new h(`streams[${A}]`,P[A],"must be readable");if(A>0&&!(o(E[A])||e(E[A])||t(E[A])))throw new h(`streams[${A}]`,P[A],"must be writable")}let M,k,w,_,x;const V=E[0],D=a(E,function(A){const G=_;_=null,G?G(A):A?x.destroy(A):T||d||x.destroy()}),d=!!(o(V)||e(V)||t(V)),T=!!(r(D)||i(D)||t(D));if(x=new c({writableObjectMode:!(V==null||!V.writableObjectMode),readableObjectMode:!(D==null||!D.writableObjectMode),writable:d,readable:T}),d){if(u(V))x._write=function(G,Q,X){V.write(G,Q)?X():M=X},x._final=function(G){V.end(),k=G},V.on("drain",function(){if(M){const G=M;M=null,G()}});else if(s(V)){const G=(t(V)?V.writable:V).getWriter();x._write=async function(Q,X,O){try{await G.ready,G.write(Q).catch(()=>{}),O()}catch(S){O(S)}},x._final=async function(Q){try{await G.ready,G.close().catch(()=>{}),k=Q}catch(X){Q(X)}}}const A=t(D)?D.readable:D;y(A,()=>{if(k){const G=k;k=null,G()}})}if(T){if(u(D))D.on("readable",function(){if(w){const A=w;w=null,A()}}),D.on("end",function(){x.push(null)}),x._read=function(){for(;;){const A=D.read();if(A===null)return void(w=x._read);if(!x.push(A))return}};else if(s(D)){const A=(t(D)?D.readable:D).getReader();x._read=async function(){for(;;)try{const{value:G,done:Q}=await A.read();if(!x.push(G))return;if(Q)return void x.push(null)}catch{return}}}}return x._destroy=function(A,G){A||_===null||(A=new f),w=null,M=null,k=null,_===null?G(A):(_=G,u(D)&&g(D,A))},x}},{"../../ours/errors":126,"./destroy":110,"./duplex":111,"./end-of-stream":113,"./pipeline":118,"./utils":122}],110:[function(p,L,v){const a=p("process/"),{aggregateTwoErrors:c,codes:{ERR_MULTIPLE_CALLBACK:g},AbortError:u}=p("../../ours/errors"),{Symbol:r}=p("../../ours/primordials"),{kDestroyed:o,isDestroyed:s,isFinished:t,isServerRequest:e}=p("./utils"),i=r("kDestroy"),f=r("kConstruct");function h(D,d,T){D&&(D.stack,d&&!d.errored&&(d.errored=D),T&&!T.errored&&(T.errored=D))}function m(D,d,T){let A=!1;function G(Q){if(A)return;A=!0;const X=D._readableState,O=D._writableState;h(Q,O,X),O&&(O.closed=!0),X&&(X.closed=!0),typeof T=="function"&&T(Q),Q?a.nextTick(y,D,Q):a.nextTick(E,D)}try{D._destroy(d||null,G)}catch(Q){G(Q)}}function y(D,d){P(D,d),E(D)}function E(D){const d=D._readableState,T=D._writableState;T&&(T.closeEmitted=!0),d&&(d.closeEmitted=!0),(T!=null&&T.emitClose||d!=null&&d.emitClose)&&D.emit("close")}function P(D,d){const T=D._readableState,A=D._writableState;A!=null&&A.errorEmitted||T!=null&&T.errorEmitted||(A&&(A.errorEmitted=!0),T&&(T.errorEmitted=!0),D.emit("error",d))}function M(D,d,T){const A=D._readableState,G=D._writableState;if(G!=null&&G.destroyed||A!=null&&A.destroyed)return this;A!=null&&A.autoDestroy||G!=null&&G.autoDestroy?D.destroy(d):d&&(d.stack,G&&!G.errored&&(G.errored=d),A&&!A.errored&&(A.errored=d),T?a.nextTick(P,D,d):P(D,d))}function k(D){let d=!1;function T(A){if(d)return void M(D,A??new g);d=!0;const G=D._readableState,Q=D._writableState,X=Q||G;G&&(G.constructed=!0),Q&&(Q.constructed=!0),X.destroyed?D.emit(i,A):A?M(D,A,!0):a.nextTick(w,D)}try{D._construct(A=>{a.nextTick(T,A)})}catch(A){a.nextTick(T,A)}}function w(D){D.emit(f)}function _(D){return(D==null?void 0:D.setHeader)&&typeof D.abort=="function"}function x(D){D.emit("close")}function V(D,d){D.emit("error",d),a.nextTick(x,D)}L.exports={construct:function(D,d){if(typeof D._construct!="function")return;const T=D._readableState,A=D._writableState;T&&(T.constructed=!1),A&&(A.constructed=!1),D.once(f,d),D.listenerCount(f)>1||a.nextTick(k,D)},destroyer:function(D,d){D&&!s(D)&&(d||t(D)||(d=new u),e(D)?(D.socket=null,D.destroy(d)):_(D)?D.abort():_(D.req)?D.req.abort():typeof D.destroy=="function"?D.destroy(d):typeof D.close=="function"?D.close():d?a.nextTick(V,D,d):a.nextTick(x,D),D.destroyed||(D[o]=!0))},destroy:function(D,d){const T=this._readableState,A=this._writableState,G=A||T;return A!=null&&A.destroyed||T!=null&&T.destroyed?(typeof d=="function"&&d(),this):(h(D,A,T),A&&(A.destroyed=!0),T&&(T.destroyed=!0),G.constructed?m(this,D,d):this.once(i,function(Q){m(this,c(Q,D),d)}),this)},undestroy:function(){const D=this._readableState,d=this._writableState;D&&(D.constructed=!0,D.closed=!1,D.closeEmitted=!1,D.destroyed=!1,D.errored=null,D.errorEmitted=!1,D.reading=!1,D.ended=D.readable===!1,D.endEmitted=D.readable===!1),d&&(d.constructed=!0,d.destroyed=!1,d.closed=!1,d.closeEmitted=!1,d.errored=null,d.errorEmitted=!1,d.finalCalled=!1,d.prefinished=!1,d.ended=d.writable===!1,d.ending=d.writable===!1,d.finished=d.writable===!1)},errorOrDestroy:M}},{"../../ours/errors":126,"../../ours/primordials":127,"./utils":122,"process/":102}],111:[function(p,L,v){const{ObjectDefineProperties:a,ObjectGetOwnPropertyDescriptor:c,ObjectKeys:g,ObjectSetPrototypeOf:u}=p("../../ours/primordials");L.exports=s;const r=p("./readable"),o=p("./writable");u(s.prototype,r.prototype),u(s,r);{const f=g(o.prototype);for(let h=0;h<f.length;h++){const m=f[h];s.prototype[m]||(s.prototype[m]=o.prototype[m])}}function s(f){if(!(this instanceof s))return new s(f);r.call(this,f),o.call(this,f),f?(this.allowHalfOpen=f.allowHalfOpen!==!1,f.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),f.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}let t,e;function i(){return t===void 0&&(t={}),t}a(s.prototype,{writable:{__proto__:null,...c(o.prototype,"writable")},writableHighWaterMark:{__proto__:null,...c(o.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...c(o.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...c(o.prototype,"writableBuffer")},writableLength:{__proto__:null,...c(o.prototype,"writableLength")},writableFinished:{__proto__:null,...c(o.prototype,"writableFinished")},writableCorked:{__proto__:null,...c(o.prototype,"writableCorked")},writableEnded:{__proto__:null,...c(o.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...c(o.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set(f){this._readableState&&this._writableState&&(this._readableState.destroyed=f,this._writableState.destroyed=f)}}}),s.fromWeb=function(f,h){return i().newStreamDuplexFromReadableWritablePair(f,h)},s.toWeb=function(f){return i().newReadableWritablePairFromDuplex(f)},s.from=function(f){return e||(e=p("./duplexify")),e(f,"body")}},{"../../ours/primordials":127,"./duplexify":112,"./readable":119,"./writable":123}],112:[function(p,L,v){const a=p("process/"),c=p("buffer"),{isReadable:g,isWritable:u,isIterable:r,isNodeStream:o,isReadableNodeStream:s,isWritableNodeStream:t,isDuplexNodeStream:e}=p("./utils"),i=p("./end-of-stream"),{AbortError:f,codes:{ERR_INVALID_ARG_TYPE:h,ERR_INVALID_RETURN_VALUE:m}}=p("../../ours/errors"),{destroyer:y}=p("./destroy"),E=p("./duplex"),P=p("./readable"),{createDeferredPromise:M}=p("../../ours/util"),k=p("./from"),w=globalThis.Blob||c.Blob,_=w!==void 0?function(T){return T instanceof w}:function(T){return!1},x=globalThis.AbortController||p("abort-controller").AbortController,{FunctionPrototypeCall:V}=p("../../ours/primordials");class D extends E{constructor(A){super(A),(A==null?void 0:A.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(A==null?void 0:A.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}function d(T){const A=T.readable&&typeof T.readable.read!="function"?P.wrap(T.readable):T.readable,G=T.writable;let Q,X,O,S,C,$=!!g(A),B=!!u(G);function H(F){const W=S;S=null,W?W(F):F&&C.destroy(F)}return C=new D({readableObjectMode:!(A==null||!A.readableObjectMode),writableObjectMode:!(G==null||!G.writableObjectMode),readable:$,writable:B}),B&&(i(G,F=>{B=!1,F&&y(A,F),H(F)}),C._write=function(F,W,J){G.write(F,W)?J():Q=J},C._final=function(F){G.end(),X=F},G.on("drain",function(){if(Q){const F=Q;Q=null,F()}}),G.on("finish",function(){if(X){const F=X;X=null,F()}})),$&&(i(A,F=>{$=!1,F&&y(A,F),H(F)}),A.on("readable",function(){if(O){const F=O;O=null,F()}}),A.on("end",function(){C.push(null)}),C._read=function(){for(;;){const F=A.read();if(F===null)return void(O=C._read);if(!C.push(F))return}}),C._destroy=function(F,W){F||S===null||(F=new f),O=null,Q=null,X=null,S===null?W(F):(S=W,y(G,F),y(A,F))},C}L.exports=function T(A,G){if(e(A))return A;if(s(A))return d({readable:A});if(t(A))return d({writable:A});if(o(A))return d({writable:!1,readable:!1});if(typeof A=="function"){const{value:X,write:O,final:S,destroy:C}=function(B){let{promise:H,resolve:F}=M();const W=new x,J=W.signal;return{value:B(async function*(){for(;;){const Z=H;H=null;const{chunk:I,done:n,cb:l}=await Z;if(a.nextTick(l),n)return;if(J.aborted)throw new f(void 0,{cause:J.reason});({promise:H,resolve:F}=M()),yield I}}(),{signal:J}),write(Z,I,n){const l=F;F=null,l({chunk:Z,done:!1,cb:n})},final(Z){const I=F;F=null,I({done:!0,cb:Z})},destroy(Z,I){W.abort(),I(Z)}}}(A);if(r(X))return k(D,X,{objectMode:!0,write:O,final:S,destroy:C});const $=X==null?void 0:X.then;if(typeof $=="function"){let B;const H=V($,X,F=>{if(F!=null)throw new m("nully","body",F)},F=>{y(B,F)});return B=new D({objectMode:!0,readable:!1,write:O,final(F){S(async()=>{try{await H,a.nextTick(F,null)}catch(W){a.nextTick(F,W)}})},destroy:C})}throw new m("Iterable, AsyncIterable or AsyncFunction",G,X)}if(_(A))return T(A.arrayBuffer());if(r(A))return k(D,A,{objectMode:!0,writable:!1});if(typeof(A==null?void 0:A.writable)=="object"||typeof(A==null?void 0:A.readable)=="object")return d({readable:A!=null&&A.readable?s(A==null?void 0:A.readable)?A==null?void 0:A.readable:T(A.readable):void 0,writable:A!=null&&A.writable?t(A==null?void 0:A.writable)?A==null?void 0:A.writable:T(A.writable):void 0});const Q=A==null?void 0:A.then;if(typeof Q=="function"){let X;return V(Q,A,O=>{O!=null&&X.push(O),X.push(null)},O=>{y(X,O)}),X=new D({objectMode:!0,writable:!1,read(){}})}throw new h(G,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],A)}},{"../../ours/errors":126,"../../ours/primordials":127,"../../ours/util":128,"./destroy":110,"./duplex":111,"./end-of-stream":113,"./from":114,"./readable":119,"./utils":122,"abort-controller":24,buffer:29,"process/":102}],113:[function(p,L,v){const a=p("process/"),{AbortError:c,codes:g}=p("../../ours/errors"),{ERR_INVALID_ARG_TYPE:u,ERR_STREAM_PREMATURE_CLOSE:r}=g,{kEmptyObject:o,once:s}=p("../../ours/util"),{validateAbortSignal:t,validateFunction:e,validateObject:i,validateBoolean:f}=p("../validators"),{Promise:h,PromisePrototypeThen:m}=p("../../ours/primordials"),{isClosed:y,isReadable:E,isReadableNodeStream:P,isReadableStream:M,isReadableFinished:k,isReadableErrored:w,isWritable:_,isWritableNodeStream:x,isWritableStream:V,isWritableFinished:D,isWritableErrored:d,isNodeStream:T,willEmitClose:A,kIsClosedPromise:G}=p("./utils"),Q=()=>{};function X(O,S,C){var $,B;if(arguments.length===2?(C=S,S=o):S==null?S=o:i(S,"options"),e(C,"callback"),t(S.signal,"options.signal"),C=s(C),M(O)||V(O))return function(et,rt,ut){let st=!1,ot=Q;if(rt.signal)if(ot=()=>{st=!0,ut.call(et,new c(void 0,{cause:rt.signal.reason}))},rt.signal.aborted)a.nextTick(ot);else{const q=ut;ut=s((...it)=>{rt.signal.removeEventListener("abort",ot),q.apply(et,it)}),rt.signal.addEventListener("abort",ot)}const N=(...q)=>{st||a.nextTick(()=>ut.apply(et,q))};return m(et[G].promise,N,N),Q}(O,S,C);if(!T(O))throw new u("stream",["ReadableStream","WritableStream","Stream"],O);const H=($=S.readable)!==null&&$!==void 0?$:P(O),F=(B=S.writable)!==null&&B!==void 0?B:x(O),W=O._writableState,J=O._readableState,Y=()=>{O.writable||n()};let Z=A(O)&&P(O)===H&&x(O)===F,I=D(O,!1);const n=()=>{I=!0,O.destroyed&&(Z=!1),(!Z||O.readable&&!H)&&(H&&!l||C.call(O))};let l=k(O,!1);const b=()=>{l=!0,O.destroyed&&(Z=!1),(!Z||O.writable&&!F)&&(F&&!I||C.call(O))},R=et=>{C.call(O,et)};let U=y(O);const z=()=>{U=!0;const et=d(O)||w(O);return et&&typeof et!="boolean"?C.call(O,et):H&&!l&&P(O,!0)&&!k(O,!1)?C.call(O,new r):!F||I||D(O,!1)?void C.call(O):C.call(O,new r)},j=()=>{U=!0;const et=d(O)||w(O);if(et&&typeof et!="boolean")return C.call(O,et);C.call(O)},K=()=>{O.req.on("finish",n)};(function(et){return et.setHeader&&typeof et.abort=="function"})(O)?(O.on("complete",n),Z||O.on("abort",z),O.req?K():O.on("request",K)):F&&!W&&(O.on("end",Y),O.on("close",Y)),Z||typeof O.aborted!="boolean"||O.on("aborted",z),O.on("end",b),O.on("finish",n),S.error!==!1&&O.on("error",R),O.on("close",z),U?a.nextTick(z):W!=null&&W.errorEmitted||J!=null&&J.errorEmitted?Z||a.nextTick(j):(H||Z&&!E(O)||!I&&_(O)!==!1)&&(F||Z&&!_(O)||!l&&E(O)!==!1)?J&&O.req&&O.aborted&&a.nextTick(j):a.nextTick(j);const tt=()=>{C=Q,O.removeListener("aborted",z),O.removeListener("complete",n),O.removeListener("abort",z),O.removeListener("request",K),O.req&&O.req.removeListener("finish",n),O.removeListener("end",Y),O.removeListener("close",Y),O.removeListener("finish",n),O.removeListener("end",b),O.removeListener("error",R),O.removeListener("close",z)};if(S.signal&&!U){const et=()=>{const rt=C;tt(),rt.call(O,new c(void 0,{cause:S.signal.reason}))};if(S.signal.aborted)a.nextTick(et);else{const rt=C;C=s((...ut)=>{S.signal.removeEventListener("abort",et),rt.apply(O,ut)}),S.signal.addEventListener("abort",et)}}return tt}L.exports=X,L.exports.finished=function(O,S){var C;let $=!1;return S===null&&(S=o),(C=S)!==null&&C!==void 0&&C.cleanup&&(f(S.cleanup,"cleanup"),$=S.cleanup),new h((B,H)=>{const F=X(O,S,W=>{$&&F(),W?H(W):B()})})}},{"../../ours/errors":126,"../../ours/primordials":127,"../../ours/util":128,"../validators":124,"./utils":122,"process/":102}],114:[function(p,L,v){const a=p("process/"),{PromisePrototypeThen:c,SymbolAsyncIterator:g,SymbolIterator:u}=p("../../ours/primordials"),{Buffer:r}=p("buffer"),{ERR_INVALID_ARG_TYPE:o,ERR_STREAM_NULL_VALUES:s}=p("../../ours/errors").codes;L.exports=function(t,e,i){let f,h;if(typeof e=="string"||e instanceof r)return new t({objectMode:!0,...i,read(){this.push(e),this.push(null)}});if(e&&e[g])h=!0,f=e[g]();else{if(!e||!e[u])throw new o("iterable",["Iterable"],e);h=!1,f=e[u]()}const m=new t({objectMode:!0,highWaterMark:1,...i});let y=!1;return m._read=function(){y||(y=!0,async function(){for(;;){try{const{value:E,done:P}=h?await f.next():f.next();if(P)m.push(null);else{const M=E&&typeof E.then=="function"?await E:E;if(M===null)throw y=!1,new s;if(m.push(M))continue;y=!1}}catch(E){m.destroy(E)}break}}())},m._destroy=function(E,P){c(async function(M){const k=M!=null,w=typeof f.throw=="function";if(k&&w){const{value:_,done:x}=await f.throw(M);if(await _,x)return}if(typeof f.return=="function"){const{value:_}=await f.return();await _}}(E),()=>a.nextTick(P,E),M=>a.nextTick(P,M||E))},m}},{"../../ours/errors":126,"../../ours/primordials":127,buffer:29,"process/":102}],115:[function(p,L,v){const{ArrayIsArray:a,ObjectSetPrototypeOf:c}=p("../../ours/primordials"),{EventEmitter:g}=p("events");function u(o){g.call(this,o)}function r(o,s,t){if(typeof o.prependListener=="function")return o.prependListener(s,t);o._events&&o._events[s]?a(o._events[s])?o._events[s].unshift(t):o._events[s]=[t,o._events[s]]:o.on(s,t)}c(u.prototype,g.prototype),c(u,g),u.prototype.pipe=function(o,s){const t=this;function e(P){o.writable&&o.write(P)===!1&&t.pause&&t.pause()}function i(){t.readable&&t.resume&&t.resume()}t.on("data",e),o.on("drain",i),o._isStdio||s&&s.end===!1||(t.on("end",h),t.on("close",m));let f=!1;function h(){f||(f=!0,o.end())}function m(){f||(f=!0,typeof o.destroy=="function"&&o.destroy())}function y(P){E(),g.listenerCount(this,"error")===0&&this.emit("error",P)}function E(){t.removeListener("data",e),o.removeListener("drain",i),t.removeListener("end",h),t.removeListener("close",m),t.removeListener("error",y),o.removeListener("error",y),t.removeListener("end",E),t.removeListener("close",E),o.removeListener("close",E)}return r(t,"error",y),r(o,"error",y),t.on("end",E),t.on("close",E),o.on("close",E),o.emit("pipe",t),o},L.exports={Stream:u,prependListener:r}},{"../../ours/primordials":127,events:49}],116:[function(p,L,v){const a=globalThis.AbortController||p("abort-controller").AbortController,{codes:{ERR_INVALID_ARG_VALUE:c,ERR_INVALID_ARG_TYPE:g,ERR_MISSING_ARGS:u,ERR_OUT_OF_RANGE:r},AbortError:o}=p("../../ours/errors"),{validateAbortSignal:s,validateInteger:t,validateObject:e}=p("../validators"),i=p("../../ours/primordials").Symbol("kWeak"),{finished:f}=p("./end-of-stream"),h=p("./compose"),{addAbortSignalNoValidate:m}=p("./add-abort-signal"),{isWritable:y,isNodeStream:E}=p("./utils"),{ArrayPrototypePush:P,MathFloor:M,Number:k,NumberIsNaN:w,Promise:_,PromiseReject:x,PromisePrototypeThen:V,Symbol:D}=p("../../ours/primordials"),d=D("kEmpty"),T=D("kEof");function A(S,C){if(typeof S!="function")throw new g("fn",["Function","AsyncFunction"],S);C!=null&&e(C,"options"),(C==null?void 0:C.signal)!=null&&s(C.signal,"options.signal");let $=1;return(C==null?void 0:C.concurrency)!=null&&($=M(C.concurrency)),t($,"concurrency",1),(async function*(){var B,H;const F=new a,W=this,J=[],Y=F.signal,Z={signal:Y},I=()=>F.abort();let n,l;C!=null&&(B=C.signal)!==null&&B!==void 0&&B.aborted&&I(),C==null||(H=C.signal)===null||H===void 0||H.addEventListener("abort",I);let b=!1;function R(){b=!0}(async function(){try{for await(let j of W){var U;if(b)return;if(Y.aborted)throw new o;try{j=S(j,Z)}catch(K){j=x(K)}j!==d&&(typeof((U=j)===null||U===void 0?void 0:U.catch)=="function"&&j.catch(R),J.push(j),n&&(n(),n=null),!b&&J.length&&J.length>=$&&await new _(K=>{l=K}))}J.push(T)}catch(j){const K=x(j);V(K,void 0,R),J.push(K)}finally{var z;b=!0,n&&(n(),n=null),C==null||(z=C.signal)===null||z===void 0||z.removeEventListener("abort",I)}})();try{for(;;){for(;J.length>0;){const U=await J[0];if(U===T)return;if(Y.aborted)throw new o;U!==d&&(yield U),J.shift(),l&&(l(),l=null)}await new _(U=>{n=U})}}finally{F.abort(),b=!0,l&&(l(),l=null)}}).call(this)}async function G(S,C=void 0){for await(const $ of Q.call(this,S,C))return!0;return!1}function Q(S,C){if(typeof S!="function")throw new g("fn",["Function","AsyncFunction"],S);return A.call(this,async function($,B){return await S($,B)?$:d},C)}class X extends u{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}function O(S){if(S=k(S),w(S))return 0;if(S<0)throw new r("number",">= 0",S);return S}L.exports.streamReturningOperators={asIndexedPairs:function(S=void 0){return S!=null&&e(S,"options"),(S==null?void 0:S.signal)!=null&&s(S.signal,"options.signal"),(async function*(){let C=0;for await(const B of this){var $;if(S!=null&&($=S.signal)!==null&&$!==void 0&&$.aborted)throw new o({cause:S.signal.reason});yield[C++,B]}}).call(this)},drop:function(S,C=void 0){return C!=null&&e(C,"options"),(C==null?void 0:C.signal)!=null&&s(C.signal,"options.signal"),S=O(S),(async function*(){var $;if(C!=null&&($=C.signal)!==null&&$!==void 0&&$.aborted)throw new o;for await(const H of this){var B;if(C!=null&&(B=C.signal)!==null&&B!==void 0&&B.aborted)throw new o;S--<=0&&(yield H)}}).call(this)},filter:Q,flatMap:function(S,C){const $=A.call(this,S,C);return(async function*(){for await(const B of $)yield*B}).call(this)},map:A,take:function(S,C=void 0){return C!=null&&e(C,"options"),(C==null?void 0:C.signal)!=null&&s(C.signal,"options.signal"),S=O(S),(async function*(){var $;if(C!=null&&($=C.signal)!==null&&$!==void 0&&$.aborted)throw new o;for await(const H of this){var B;if(C!=null&&(B=C.signal)!==null&&B!==void 0&&B.aborted)throw new o;if(!(S-- >0))return;yield H}}).call(this)},compose:function(S,C){if(C!=null&&e(C,"options"),(C==null?void 0:C.signal)!=null&&s(C.signal,"options.signal"),E(S)&&!y(S))throw new c("stream",S,"must be writable");const $=h(this,S);return C!=null&&C.signal&&m(C.signal,$),$}},L.exports.promiseReturningOperators={every:async function(S,C=void 0){if(typeof S!="function")throw new g("fn",["Function","AsyncFunction"],S);return!await G.call(this,async(...$)=>!await S(...$),C)},forEach:async function(S,C){if(typeof S!="function")throw new g("fn",["Function","AsyncFunction"],S);for await(const $ of A.call(this,async function(B,H){return await S(B,H),d},C));},reduce:async function(S,C,$){var B;if(typeof S!="function")throw new g("reducer",["Function","AsyncFunction"],S);$!=null&&e($,"options"),($==null?void 0:$.signal)!=null&&s($.signal,"options.signal");let H=arguments.length>1;if($!=null&&(B=$.signal)!==null&&B!==void 0&&B.aborted){const Z=new o(void 0,{cause:$.signal.reason});throw this.once("error",()=>{}),await f(this.destroy(Z)),Z}const F=new a,W=F.signal;if($!=null&&$.signal){const Z={once:!0,[i]:this};$.signal.addEventListener("abort",()=>F.abort(),Z)}let J=!1;try{for await(const Z of this){var Y;if(J=!0,$!=null&&(Y=$.signal)!==null&&Y!==void 0&&Y.aborted)throw new o;H?C=await S(C,Z,{signal:W}):(C=Z,H=!0)}if(!J&&!H)throw new X}finally{F.abort()}return C},toArray:async function(S){S!=null&&e(S,"options"),(S==null?void 0:S.signal)!=null&&s(S.signal,"options.signal");const C=[];for await(const B of this){var $;if(S!=null&&($=S.signal)!==null&&$!==void 0&&$.aborted)throw new o(void 0,{cause:S.signal.reason});P(C,B)}return C},some:G,find:async function(S,C){for await(const $ of Q.call(this,S,C))return $}}},{"../../ours/errors":126,"../../ours/primordials":127,"../validators":124,"./add-abort-signal":107,"./compose":109,"./end-of-stream":113,"./utils":122,"abort-controller":24}],117:[function(p,L,v){const{ObjectSetPrototypeOf:a}=p("../../ours/primordials");L.exports=g;const c=p("./transform");function g(u){if(!(this instanceof g))return new g(u);c.call(this,u)}a(g.prototype,c.prototype),a(g,c),g.prototype._transform=function(u,r,o){o(null,u)}},{"../../ours/primordials":127,"./transform":121}],118:[function(p,L,v){const a=p("process/"),{ArrayIsArray:c,Promise:g,SymbolAsyncIterator:u}=p("../../ours/primordials"),r=p("./end-of-stream"),{once:o}=p("../../ours/util"),s=p("./destroy"),t=p("./duplex"),{aggregateTwoErrors:e,codes:{ERR_INVALID_ARG_TYPE:i,ERR_INVALID_RETURN_VALUE:f,ERR_MISSING_ARGS:h,ERR_STREAM_DESTROYED:m,ERR_STREAM_PREMATURE_CLOSE:y},AbortError:E}=p("../../ours/errors"),{validateFunction:P,validateAbortSignal:M}=p("../validators"),{isIterable:k,isReadable:w,isReadableNodeStream:_,isNodeStream:x,isTransformStream:V,isWebStream:D,isReadableStream:d,isReadableEnded:T}=p("./utils"),A=globalThis.AbortController||p("abort-controller").AbortController;let G,Q;function X(H,F,W){let J=!1;return H.on("close",()=>{J=!0}),{destroy:Y=>{J||(J=!0,s.destroyer(H,Y||new m("pipe")))},cleanup:r(H,{readable:F,writable:W},Y=>{J=!Y})}}function O(H){if(k(H))return H;if(_(H))return async function*(F){Q||(Q=p("./readable")),yield*Q.prototype[u].call(F)}(H);throw new i("val",["Readable","Iterable","AsyncIterable"],H)}async function S(H,F,W,{end:J}){let Y,Z=null;const I=b=>{if(b&&(Y=b),Z){const R=Z;Z=null,R()}},n=()=>new g((b,R)=>{Y?R(Y):Z=()=>{Y?R(Y):b()}});F.on("drain",I);const l=r(F,{readable:!1},I);try{F.writableNeedDrain&&await n();for await(const b of H)F.write(b)||await n();J&&F.end(),await n(),W()}catch(b){W(Y!==b?e(Y,b):b)}finally{l(),F.off("drain",I)}}async function C(H,F,W,{end:J}){V(F)&&(F=F.writable);const Y=F.getWriter();try{for await(const Z of H)await Y.ready,Y.write(Z).catch(()=>{});await Y.ready,J&&await Y.close(),W()}catch(Z){try{await Y.abort(Z),W(Z)}catch(I){W(I)}}}function $(H,F,W){if(H.length===1&&c(H[0])&&(H=H[0]),H.length<2)throw new h("streams");const J=new A,Y=J.signal,Z=W==null?void 0:W.signal,I=[];function n(){K(new E)}let l,b;M(Z,"options.signal"),Z==null||Z.addEventListener("abort",n);const R=[];let U,z=0;function j(ut){K(ut,--z==0)}function K(ut,st){if(!ut||l&&l.code!=="ERR_STREAM_PREMATURE_CLOSE"||(l=ut),l||st){for(;R.length;)R.shift()(l);Z==null||Z.removeEventListener("abort",n),J.abort(),st&&(l||I.forEach(ot=>ot()),a.nextTick(F,l,b))}}for(let ut=0;ut<H.length;ut++){const st=H[ut],ot=ut<H.length-1,N=ut>0,q=ot||(W==null?void 0:W.end)!==!1,it=ut===H.length-1;if(x(st)){let nt=function(at){at&&at.name!=="AbortError"&&at.code!=="ERR_STREAM_PREMATURE_CLOSE"&&j(at)};var rt=nt;if(q){const{destroy:at,cleanup:ht}=X(st,ot,N);R.push(at),w(st)&&it&&I.push(ht)}st.on("error",nt),w(st)&&it&&I.push(()=>{st.removeListener("error",nt)})}if(ut===0)if(typeof st=="function"){if(U=st({signal:Y}),!k(U))throw new f("Iterable, AsyncIterable or Stream","source",U)}else U=k(st)||_(st)||V(st)?st:t.from(st);else if(typeof st=="function"){var tt;if(V(U)?U=O((tt=U)===null||tt===void 0?void 0:tt.readable):U=O(U),U=st(U,{signal:Y}),ot){if(!k(U,!0))throw new f("AsyncIterable",`transform[${ut-1}]`,U)}else{var et;G||(G=p("./passthrough"));const nt=new G({objectMode:!0}),at=(et=U)===null||et===void 0?void 0:et.then;if(typeof at=="function")z++,at.call(U,dt=>{b=dt,dt!=null&&nt.write(dt),q&&nt.end(),a.nextTick(j)},dt=>{nt.destroy(dt),a.nextTick(j,dt)});else if(k(U,!0))z++,S(U,nt,j,{end:q});else{if(!d(U)&&!V(U))throw new f("AsyncIterable or Promise","destination",U);{const dt=U.readable||U;z++,S(dt,nt,j,{end:q})}}U=nt;const{destroy:ht,cleanup:gt}=X(U,!1,!0);R.push(ht),it&&I.push(gt)}}else if(x(st)){if(_(U)){z+=2;const nt=B(U,st,j,{end:q});w(st)&&it&&I.push(nt)}else if(V(U)||d(U)){const nt=U.readable||U;z++,S(nt,st,j,{end:q})}else{if(!k(U))throw new i("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],U);z++,S(U,st,j,{end:q})}U=st}else if(D(st)){if(_(U))z++,C(O(U),st,j,{end:q});else if(d(U)||k(U))z++,C(U,st,j,{end:q});else{if(!V(U))throw new i("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],U);z++,C(U.readable,st,j,{end:q})}U=st}else U=t.from(st)}return(Y!=null&&Y.aborted||Z!=null&&Z.aborted)&&a.nextTick(n),U}function B(H,F,W,{end:J}){let Y=!1;if(F.on("close",()=>{Y||W(new y)}),H.pipe(F,{end:!1}),J){let I=function(){Y=!0,F.end()};var Z=I;T(H)?a.nextTick(I):H.once("end",I)}else W();return r(H,{readable:!0,writable:!1},I=>{const n=H._readableState;I&&I.code==="ERR_STREAM_PREMATURE_CLOSE"&&n&&n.ended&&!n.errored&&!n.errorEmitted?H.once("end",W).once("error",W):W(I)}),r(F,{readable:!1,writable:!0},W)}L.exports={pipelineImpl:$,pipeline:function(...H){return $(H,o(function(F){return P(F[F.length-1],"streams[stream.length - 1]"),F.pop()}(H)))}}},{"../../ours/errors":126,"../../ours/primordials":127,"../../ours/util":128,"../validators":124,"./destroy":110,"./duplex":111,"./end-of-stream":113,"./passthrough":117,"./readable":119,"./utils":122,"abort-controller":24,"process/":102}],119:[function(p,L,v){const a=p("process/"),{ArrayPrototypeIndexOf:c,NumberIsInteger:g,NumberIsNaN:u,NumberParseInt:r,ObjectDefineProperties:o,ObjectKeys:s,ObjectSetPrototypeOf:t,Promise:e,SafeSet:i,SymbolAsyncIterator:f,Symbol:h}=p("../../ours/primordials");L.exports=W,W.ReadableState=F;const{EventEmitter:m}=p("events"),{Stream:y,prependListener:E}=p("./legacy"),{Buffer:P}=p("buffer"),{addAbortSignal:M}=p("./add-abort-signal"),k=p("./end-of-stream");let w=p("../../ours/util").debuglog("stream",N=>{w=N});const _=p("./buffer_list"),x=p("./destroy"),{getHighWaterMark:V,getDefaultHighWaterMark:D}=p("./state"),{aggregateTwoErrors:d,codes:{ERR_INVALID_ARG_TYPE:T,ERR_METHOD_NOT_IMPLEMENTED:A,ERR_OUT_OF_RANGE:G,ERR_STREAM_PUSH_AFTER_EOF:Q,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:X}}=p("../../ours/errors"),{validateObject:O}=p("../validators"),S=h("kPaused"),{StringDecoder:C}=p("string_decoder"),$=p("./from");t(W.prototype,y.prototype),t(W,y);const B=()=>{},{errorOrDestroy:H}=x;function F(N,q,it){typeof it!="boolean"&&(it=q instanceof p("./duplex")),this.objectMode=!(!N||!N.objectMode),it&&(this.objectMode=this.objectMode||!(!N||!N.readableObjectMode)),this.highWaterMark=N?V(this,N,"readableHighWaterMark",it):D(!1),this.buffer=new _,this.length=0,this.pipes=[],this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.constructed=!0,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this[S]=null,this.errorEmitted=!1,this.emitClose=!N||N.emitClose!==!1,this.autoDestroy=!N||N.autoDestroy!==!1,this.destroyed=!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this.defaultEncoding=N&&N.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.multiAwaitDrain=!1,this.readingMore=!1,this.dataEmitted=!1,this.decoder=null,this.encoding=null,N&&N.encoding&&(this.decoder=new C(N.encoding),this.encoding=N.encoding)}function W(N){if(!(this instanceof W))return new W(N);const q=this instanceof p("./duplex");this._readableState=new F(N,this,q),N&&(typeof N.read=="function"&&(this._read=N.read),typeof N.destroy=="function"&&(this._destroy=N.destroy),typeof N.construct=="function"&&(this._construct=N.construct),N.signal&&!q&&M(N.signal,this)),y.call(this,N),x.construct(this,()=>{this._readableState.needReadable&&l(this,this._readableState)})}function J(N,q,it,nt){w("readableAddChunk",q);const at=N._readableState;let ht;if(at.objectMode||(typeof q=="string"?(it=it||at.defaultEncoding,at.encoding!==it&&(nt&&at.encoding?q=P.from(q,it).toString(at.encoding):(q=P.from(q,it),it=""))):q instanceof P?it="":y._isUint8Array(q)?(q=y._uint8ArrayToBuffer(q),it=""):q!=null&&(ht=new T("chunk",["string","Buffer","Uint8Array"],q))),ht)H(N,ht);else if(q===null)at.reading=!1,function(gt,dt){if(w("onEofChunk"),!dt.ended){if(dt.decoder){const vt=dt.decoder.end();vt&&vt.length&&(dt.buffer.push(vt),dt.length+=dt.objectMode?1:vt.length)}dt.ended=!0,dt.sync?I(gt):(dt.needReadable=!1,dt.emittedReadable=!0,n(gt))}}(N,at);else if(at.objectMode||q&&q.length>0)if(nt)if(at.endEmitted)H(N,new X);else{if(at.destroyed||at.errored)return!1;Y(N,at,q,!0)}else if(at.ended)H(N,new Q);else{if(at.destroyed||at.errored)return!1;at.reading=!1,at.decoder&&!it?(q=at.decoder.write(q),at.objectMode||q.length!==0?Y(N,at,q,!1):l(N,at)):Y(N,at,q,!1)}else nt||(at.reading=!1,l(N,at));return!at.ended&&(at.length<at.highWaterMark||at.length===0)}function Y(N,q,it,nt){q.flowing&&q.length===0&&!q.sync&&N.listenerCount("data")>0?(q.multiAwaitDrain?q.awaitDrainWriters.clear():q.awaitDrainWriters=null,q.dataEmitted=!0,N.emit("data",it)):(q.length+=q.objectMode?1:it.length,nt?q.buffer.unshift(it):q.buffer.push(it),q.needReadable&&I(N)),l(N,q)}W.prototype.destroy=x.destroy,W.prototype._undestroy=x.undestroy,W.prototype._destroy=function(N,q){q(N)},W.prototype[m.captureRejectionSymbol]=function(N){this.destroy(N)},W.prototype.push=function(N,q){return J(this,N,q,!1)},W.prototype.unshift=function(N,q){return J(this,N,q,!0)},W.prototype.isPaused=function(){const N=this._readableState;return N[S]===!0||N.flowing===!1},W.prototype.setEncoding=function(N){const q=new C(N);this._readableState.decoder=q,this._readableState.encoding=this._readableState.decoder.encoding;const it=this._readableState.buffer;let nt="";for(const at of it)nt+=q.write(at);return it.clear(),nt!==""&&it.push(nt),this._readableState.length=nt.length,this};function Z(N,q){return N<=0||q.length===0&&q.ended?0:q.objectMode?1:u(N)?q.flowing&&q.length?q.buffer.first().length:q.length:N<=q.length?N:q.ended?q.length:0}function I(N){const q=N._readableState;w("emitReadable",q.needReadable,q.emittedReadable),q.needReadable=!1,q.emittedReadable||(w("emitReadable",q.flowing),q.emittedReadable=!0,a.nextTick(n,N))}function n(N){const q=N._readableState;w("emitReadable_",q.destroyed,q.length,q.ended),q.destroyed||q.errored||!q.length&&!q.ended||(N.emit("readable"),q.emittedReadable=!1),q.needReadable=!q.flowing&&!q.ended&&q.length<=q.highWaterMark,j(N)}function l(N,q){!q.readingMore&&q.constructed&&(q.readingMore=!0,a.nextTick(b,N,q))}function b(N,q){for(;!q.reading&&!q.ended&&(q.length<q.highWaterMark||q.flowing&&q.length===0);){const it=q.length;if(w("maybeReadMore read 0"),N.read(0),it===q.length)break}q.readingMore=!1}function R(N){const q=N._readableState;q.readableListening=N.listenerCount("readable")>0,q.resumeScheduled&&q[S]===!1?q.flowing=!0:N.listenerCount("data")>0?N.resume():q.readableListening||(q.flowing=null)}function U(N){w("readable nexttick read 0"),N.read(0)}function z(N,q){w("resume",q.reading),q.reading||N.read(0),q.resumeScheduled=!1,N.emit("resume"),j(N),q.flowing&&!q.reading&&N.read(0)}function j(N){const q=N._readableState;for(w("flow",q.flowing);q.flowing&&N.read()!==null;);}function K(N,q){typeof N.read!="function"&&(N=W.wrap(N,{objectMode:!0}));const it=async function*(nt,at){let ht,gt=B;function dt(bt){this===nt?(gt(),gt=B):gt=bt}nt.on("readable",dt);const vt=k(nt,{writable:!1},bt=>{ht=bt?d(ht,bt):null,gt(),gt=B});try{for(;;){const bt=nt.destroyed?null:nt.read();if(bt!==null)yield bt;else{if(ht)throw ht;if(ht===null)return;await new e(dt)}}}catch(bt){throw ht=d(ht,bt),ht}finally{!ht&&(at==null?void 0:at.destroyOnReturn)===!1||ht!==void 0&&!nt._readableState.autoDestroy?(nt.off("readable",dt),vt()):x.destroyer(nt,null)}}(N,q);return it.stream=N,it}function tt(N,q){if(q.length===0)return null;let it;return q.objectMode?it=q.buffer.shift():!N||N>=q.length?(it=q.decoder?q.buffer.join(""):q.buffer.length===1?q.buffer.first():q.buffer.concat(q.length),q.buffer.clear()):it=q.buffer.consume(N,q.decoder),it}function et(N){const q=N._readableState;w("endReadable",q.endEmitted),q.endEmitted||(q.ended=!0,a.nextTick(rt,q,N))}function rt(N,q){if(w("endReadableNT",N.endEmitted,N.length),!N.errored&&!N.closeEmitted&&!N.endEmitted&&N.length===0){if(N.endEmitted=!0,q.emit("end"),q.writable&&q.allowHalfOpen===!1)a.nextTick(ut,q);else if(N.autoDestroy){const it=q._writableState;(!it||it.autoDestroy&&(it.finished||it.writable===!1))&&q.destroy()}}}function ut(N){N.writable&&!N.writableEnded&&!N.destroyed&&N.end()}let st;function ot(){return st===void 0&&(st={}),st}W.prototype.read=function(N){w("read",N),N===void 0?N=NaN:g(N)||(N=r(N,10));const q=this._readableState,it=N;if(N>q.highWaterMark&&(q.highWaterMark=function(ht){if(ht>1073741824)throw new G("size","<= 1GiB",ht);return ht--,ht|=ht>>>1,ht|=ht>>>2,ht|=ht>>>4,ht|=ht>>>8,ht|=ht>>>16,++ht}(N)),N!==0&&(q.emittedReadable=!1),N===0&&q.needReadable&&((q.highWaterMark!==0?q.length>=q.highWaterMark:q.length>0)||q.ended))return w("read: emitReadable",q.length,q.ended),q.length===0&&q.ended?et(this):I(this),null;if((N=Z(N,q))===0&&q.ended)return q.length===0&&et(this),null;let nt,at=q.needReadable;if(w("need readable",at),(q.length===0||q.length-N<q.highWaterMark)&&(at=!0,w("length less than watermark",at)),q.ended||q.reading||q.destroyed||q.errored||!q.constructed)at=!1,w("reading, ended or constructing",at);else if(at){w("do read"),q.reading=!0,q.sync=!0,q.length===0&&(q.needReadable=!0);try{this._read(q.highWaterMark)}catch(ht){H(this,ht)}q.sync=!1,q.reading||(N=Z(it,q))}return nt=N>0?tt(N,q):null,nt===null?(q.needReadable=q.length<=q.highWaterMark,N=0):(q.length-=N,q.multiAwaitDrain?q.awaitDrainWriters.clear():q.awaitDrainWriters=null),q.length===0&&(q.ended||(q.needReadable=!0),it!==N&&q.ended&&et(this)),nt===null||q.errorEmitted||q.closeEmitted||(q.dataEmitted=!0,this.emit("data",nt)),nt},W.prototype._read=function(N){throw new A("_read()")},W.prototype.pipe=function(N,q){const it=this,nt=this._readableState;nt.pipes.length===1&&(nt.multiAwaitDrain||(nt.multiAwaitDrain=!0,nt.awaitDrainWriters=new i(nt.awaitDrainWriters?[nt.awaitDrainWriters]:[]))),nt.pipes.push(N),w("pipe count=%d opts=%j",nt.pipes.length,q);const at=(!q||q.end!==!1)&&N!==a.stdout&&N!==a.stderr?gt:kt;function ht(_t,mt){w("onunpipe"),_t===it&&mt&&mt.hasUnpiped===!1&&(mt.hasUnpiped=!0,function(){w("cleanup"),N.removeListener("close",Rt),N.removeListener("finish",Ct),dt&&N.removeListener("drain",dt),N.removeListener("error",It),N.removeListener("unpipe",ht),it.removeListener("end",gt),it.removeListener("end",kt),it.removeListener("data",Mt),vt=!0,dt&&nt.awaitDrainWriters&&(!N._writableState||N._writableState.needDrain)&&dt()}())}function gt(){w("onend"),N.end()}let dt;nt.endEmitted?a.nextTick(at):it.once("end",at),N.on("unpipe",ht);let vt=!1;function bt(){vt||(nt.pipes.length===1&&nt.pipes[0]===N?(w("false write response, pause",0),nt.awaitDrainWriters=N,nt.multiAwaitDrain=!1):nt.pipes.length>1&&nt.pipes.includes(N)&&(w("false write response, pause",nt.awaitDrainWriters.size),nt.awaitDrainWriters.add(N)),it.pause()),dt||(dt=function(_t,mt){return function(){const St=_t._readableState;St.awaitDrainWriters===mt?(w("pipeOnDrain",1),St.awaitDrainWriters=null):St.multiAwaitDrain&&(w("pipeOnDrain",St.awaitDrainWriters.size),St.awaitDrainWriters.delete(mt)),St.awaitDrainWriters&&St.awaitDrainWriters.size!==0||!_t.listenerCount("data")||_t.resume()}}(it,N),N.on("drain",dt))}function Mt(_t){w("ondata");const mt=N.write(_t);w("dest.write",mt),mt===!1&&bt()}function It(_t){if(w("onerror",_t),kt(),N.removeListener("error",It),N.listenerCount("error")===0){const mt=N._writableState||N._readableState;mt&&!mt.errorEmitted?H(N,_t):N.emit("error",_t)}}function Rt(){N.removeListener("finish",Ct),kt()}function Ct(){w("onfinish"),N.removeListener("close",Rt),kt()}function kt(){w("unpipe"),it.unpipe(N)}return it.on("data",Mt),E(N,"error",It),N.once("close",Rt),N.once("finish",Ct),N.emit("pipe",it),N.writableNeedDrain===!0?nt.flowing&&bt():nt.flowing||(w("pipe resume"),it.resume()),N},W.prototype.unpipe=function(N){const q=this._readableState;if(q.pipes.length===0)return this;if(!N){const nt=q.pipes;q.pipes=[],this.pause();for(let at=0;at<nt.length;at++)nt[at].emit("unpipe",this,{hasUnpiped:!1});return this}const it=c(q.pipes,N);return it===-1||(q.pipes.splice(it,1),q.pipes.length===0&&this.pause(),N.emit("unpipe",this,{hasUnpiped:!1})),this},W.prototype.on=function(N,q){const it=y.prototype.on.call(this,N,q),nt=this._readableState;return N==="data"?(nt.readableListening=this.listenerCount("readable")>0,nt.flowing!==!1&&this.resume()):N==="readable"&&(nt.endEmitted||nt.readableListening||(nt.readableListening=nt.needReadable=!0,nt.flowing=!1,nt.emittedReadable=!1,w("on readable",nt.length,nt.reading),nt.length?I(this):nt.reading||a.nextTick(U,this))),it},W.prototype.addListener=W.prototype.on,W.prototype.removeListener=function(N,q){const it=y.prototype.removeListener.call(this,N,q);return N==="readable"&&a.nextTick(R,this),it},W.prototype.off=W.prototype.removeListener,W.prototype.removeAllListeners=function(N){const q=y.prototype.removeAllListeners.apply(this,arguments);return N!=="readable"&&N!==void 0||a.nextTick(R,this),q},W.prototype.resume=function(){const N=this._readableState;return N.flowing||(w("resume"),N.flowing=!N.readableListening,function(q,it){it.resumeScheduled||(it.resumeScheduled=!0,a.nextTick(z,q,it))}(this,N)),N[S]=!1,this},W.prototype.pause=function(){return w("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(w("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[S]=!0,this},W.prototype.wrap=function(N){let q=!1;N.on("data",nt=>{!this.push(nt)&&N.pause&&(q=!0,N.pause())}),N.on("end",()=>{this.push(null)}),N.on("error",nt=>{H(this,nt)}),N.on("close",()=>{this.destroy()}),N.on("destroy",()=>{this.destroy()}),this._read=()=>{q&&N.resume&&(q=!1,N.resume())};const it=s(N);for(let nt=1;nt<it.length;nt++){const at=it[nt];this[at]===void 0&&typeof N[at]=="function"&&(this[at]=N[at].bind(N))}return this},W.prototype[f]=function(){return K(this)},W.prototype.iterator=function(N){return N!==void 0&&O(N,"options"),K(this,N)},o(W.prototype,{readable:{__proto__:null,get(){const N=this._readableState;return!(!N||N.readable===!1||N.destroyed||N.errorEmitted||N.endEmitted)},set(N){this._readableState&&(this._readableState.readable=!!N)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!(this._readableState.readable===!1||!this._readableState.destroyed&&!this._readableState.errored||this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(N){this._readableState&&(this._readableState.flowing=N)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.objectMode}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return!!this._readableState&&this._readableState.closed}},destroyed:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.destroyed},set(N){this._readableState&&(this._readableState.destroyed=N)}},readableEnded:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.endEmitted}}}),o(F.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[S]!==!1},set(N){this[S]=!!N}}}),W._fromList=tt,W.from=function(N,q){return $(W,N,q)},W.fromWeb=function(N,q){return ot().newStreamReadableFromReadableStream(N,q)},W.toWeb=function(N,q){return ot().newReadableStreamFromStreamReadable(N,q)},W.wrap=function(N,q){var it,nt;return new W({objectMode:(it=(nt=N.readableObjectMode)!==null&&nt!==void 0?nt:N.objectMode)===null||it===void 0||it,...q,destroy(at,ht){x.destroyer(N,at),ht(at)}}).wrap(N)}},{"../../ours/errors":126,"../../ours/primordials":127,"../../ours/util":128,"../validators":124,"./add-abort-signal":107,"./buffer_list":108,"./destroy":110,"./duplex":111,"./end-of-stream":113,"./from":114,"./legacy":115,"./state":120,buffer:29,events:49,"process/":102,string_decoder:28}],120:[function(p,L,v){const{MathFloor:a,NumberIsInteger:c}=p("../../ours/primordials"),{ERR_INVALID_ARG_VALUE:g}=p("../../ours/errors").codes;function u(r){return r?16:16384}L.exports={getHighWaterMark:function(r,o,s,t){const e=function(i,f,h){return i.highWaterMark!=null?i.highWaterMark:f?i[h]:null}(o,t,s);if(e!=null){if(!c(e)||e<0)throw new g(t?`options.${s}`:"options.highWaterMark",e);return a(e)}return u(r.objectMode)},getDefaultHighWaterMark:u}},{"../../ours/errors":126,"../../ours/primordials":127}],121:[function(p,L,v){const{ObjectSetPrototypeOf:a,Symbol:c}=p("../../ours/primordials");L.exports=s;const{ERR_METHOD_NOT_IMPLEMENTED:g}=p("../../ours/errors").codes,u=p("./duplex"),{getHighWaterMark:r}=p("./state");a(s.prototype,u.prototype),a(s,u);const o=c("kCallback");function s(i){if(!(this instanceof s))return new s(i);const f=i?r(this,i,"readableHighWaterMark",!0):null;f===0&&(i={...i,highWaterMark:null,readableHighWaterMark:f,writableHighWaterMark:i.writableHighWaterMark||0}),u.call(this,i),this._readableState.sync=!1,this[o]=null,i&&(typeof i.transform=="function"&&(this._transform=i.transform),typeof i.flush=="function"&&(this._flush=i.flush)),this.on("prefinish",e)}function t(i){typeof this._flush!="function"||this.destroyed?(this.push(null),i&&i()):this._flush((f,h)=>{f?i?i(f):this.destroy(f):(h!=null&&this.push(h),this.push(null),i&&i())})}function e(){this._final!==t&&t.call(this)}s.prototype._final=t,s.prototype._transform=function(i,f,h){throw new g("_transform()")},s.prototype._write=function(i,f,h){const m=this._readableState,y=this._writableState,E=m.length;this._transform(i,f,(P,M)=>{P?h(P):(M!=null&&this.push(M),y.ended||E===m.length||m.length<m.highWaterMark?h():this[o]=h)})},s.prototype._read=function(){if(this[o]){const i=this[o];this[o]=null,i()}}},{"../../ours/errors":126,"../../ours/primordials":127,"./duplex":111,"./state":120}],122:[function(p,L,v){const{Symbol:a,SymbolAsyncIterator:c,SymbolIterator:g,SymbolFor:u}=p("../../ours/primordials"),r=a("kDestroyed"),o=a("kIsErrored"),s=a("kIsReadable"),t=a("kIsDisturbed"),e=u("nodejs.webstream.isClosedPromise"),i=u("nodejs.webstream.controllerErrorFunction");function f(d,T=!1){var A;return!(!d||typeof d.pipe!="function"||typeof d.on!="function"||T&&(typeof d.pause!="function"||typeof d.resume!="function")||d._writableState&&((A=d._readableState)===null||A===void 0?void 0:A.readable)===!1||d._writableState&&!d._readableState)}function h(d){var T;return!(!d||typeof d.write!="function"||typeof d.on!="function"||d._readableState&&((T=d._writableState)===null||T===void 0?void 0:T.writable)===!1)}function m(d){return d&&(d._readableState||d._writableState||typeof d.write=="function"&&typeof d.on=="function"||typeof d.pipe=="function"&&typeof d.on=="function")}function y(d){return!(!d||m(d)||typeof d.pipeThrough!="function"||typeof d.getReader!="function"||typeof d.cancel!="function")}function E(d){return!(!d||m(d)||typeof d.getWriter!="function"||typeof d.abort!="function")}function P(d){return!(!d||m(d)||typeof d.readable!="object"||typeof d.writable!="object")}function M(d){if(!m(d))return null;const T=d._writableState,A=d._readableState,G=T||A;return!!(d.destroyed||d[r]||G!=null&&G.destroyed)}function k(d){if(!h(d))return null;if(d.writableEnded===!0)return!0;const T=d._writableState;return(T==null||!T.errored)&&(typeof(T==null?void 0:T.ended)!="boolean"?null:T.ended)}function w(d,T){if(!f(d))return null;const A=d._readableState;return(A==null||!A.errored)&&(typeof(A==null?void 0:A.endEmitted)!="boolean"?null:!!(A.endEmitted||T===!1&&A.ended===!0&&A.length===0))}function _(d){return d&&d[s]!=null?d[s]:typeof(d==null?void 0:d.readable)!="boolean"?null:!M(d)&&f(d)&&d.readable&&!w(d)}function x(d){return typeof(d==null?void 0:d.writable)!="boolean"?null:!M(d)&&h(d)&&d.writable&&!k(d)}function V(d){return typeof d._closed=="boolean"&&typeof d._defaultKeepAlive=="boolean"&&typeof d._removedConnection=="boolean"&&typeof d._removedContLen=="boolean"}function D(d){return typeof d._sent100=="boolean"&&V(d)}L.exports={kDestroyed:r,isDisturbed:function(d){var T;return!(!d||!((T=d[t])!==null&&T!==void 0?T:d.readableDidRead||d.readableAborted))},kIsDisturbed:t,isErrored:function(d){var T,A,G,Q,X,O,S,C,$,B;return!(!d||!((T=(A=(G=(Q=(X=(O=d[o])!==null&&O!==void 0?O:d.readableErrored)!==null&&X!==void 0?X:d.writableErrored)!==null&&Q!==void 0?Q:(S=d._readableState)===null||S===void 0?void 0:S.errorEmitted)!==null&&G!==void 0?G:(C=d._writableState)===null||C===void 0?void 0:C.errorEmitted)!==null&&A!==void 0?A:($=d._readableState)===null||$===void 0?void 0:$.errored)!==null&&T!==void 0?T:!((B=d._writableState)===null||B===void 0)&&B.errored))},kIsErrored:o,isReadable:_,kIsReadable:s,kIsClosedPromise:e,kControllerErrorFunction:i,isClosed:function(d){if(!m(d))return null;if(typeof d.closed=="boolean")return d.closed;const T=d._writableState,A=d._readableState;return typeof(T==null?void 0:T.closed)=="boolean"||typeof(A==null?void 0:A.closed)=="boolean"?(T==null?void 0:T.closed)||(A==null?void 0:A.closed):typeof d._closed=="boolean"&&V(d)?d._closed:null},isDestroyed:M,isDuplexNodeStream:function(d){return!(!d||typeof d.pipe!="function"||!d._readableState||typeof d.on!="function"||typeof d.write!="function")},isFinished:function(d,T){return m(d)?!!M(d)||((T==null?void 0:T.readable)===!1||!_(d))&&((T==null?void 0:T.writable)===!1||!x(d)):null},isIterable:function(d,T){return d!=null&&(T===!0?typeof d[c]=="function":T===!1?typeof d[g]=="function":typeof d[c]=="function"||typeof d[g]=="function")},isReadableNodeStream:f,isReadableStream:y,isReadableEnded:function(d){if(!f(d))return null;if(d.readableEnded===!0)return!0;const T=d._readableState;return!(!T||T.errored)&&(typeof(T==null?void 0:T.ended)!="boolean"?null:T.ended)},isReadableFinished:w,isReadableErrored:function(d){var T,A;return m(d)?d.readableErrored?d.readableErrored:(T=(A=d._readableState)===null||A===void 0?void 0:A.errored)!==null&&T!==void 0?T:null:null},isNodeStream:m,isWebStream:function(d){return y(d)||E(d)||P(d)},isWritable:x,isWritableNodeStream:h,isWritableStream:E,isWritableEnded:k,isWritableFinished:function(d,T){if(!h(d))return null;if(d.writableFinished===!0)return!0;const A=d._writableState;return(A==null||!A.errored)&&(typeof(A==null?void 0:A.finished)!="boolean"?null:!!(A.finished||T===!1&&A.ended===!0&&A.length===0))},isWritableErrored:function(d){var T,A;return m(d)?d.writableErrored?d.writableErrored:(T=(A=d._writableState)===null||A===void 0?void 0:A.errored)!==null&&T!==void 0?T:null:null},isServerRequest:function(d){var T;return typeof d._consuming=="boolean"&&typeof d._dumped=="boolean"&&((T=d.req)===null||T===void 0?void 0:T.upgradeOrConnect)===void 0},isServerResponse:D,willEmitClose:function(d){if(!m(d))return null;const T=d._writableState,A=d._readableState,G=T||A;return!G&&D(d)||!!(G&&G.autoDestroy&&G.emitClose&&G.closed===!1)},isTransformStream:P}},{"../../ours/primordials":127}],123:[function(p,L,v){const a=p("process/"),{ArrayPrototypeSlice:c,Error:g,FunctionPrototypeSymbolHasInstance:u,ObjectDefineProperty:r,ObjectDefineProperties:o,ObjectSetPrototypeOf:s,StringPrototypeToLowerCase:t,Symbol:e,SymbolHasInstance:i}=p("../../ours/primordials");L.exports=C,C.WritableState=O;const{EventEmitter:f}=p("events"),h=p("./legacy").Stream,{Buffer:m}=p("buffer"),y=p("./destroy"),{addAbortSignal:E}=p("./add-abort-signal"),{getHighWaterMark:P,getDefaultHighWaterMark:M}=p("./state"),{ERR_INVALID_ARG_TYPE:k,ERR_METHOD_NOT_IMPLEMENTED:w,ERR_MULTIPLE_CALLBACK:_,ERR_STREAM_CANNOT_PIPE:x,ERR_STREAM_DESTROYED:V,ERR_STREAM_ALREADY_FINISHED:D,ERR_STREAM_NULL_VALUES:d,ERR_STREAM_WRITE_AFTER_END:T,ERR_UNKNOWN_ENCODING:A}=p("../../ours/errors").codes,{errorOrDestroy:G}=y;function Q(){}s(C.prototype,h.prototype),s(C,h);const X=e("kOnFinished");function O(j,K,tt){typeof tt!="boolean"&&(tt=K instanceof p("./duplex")),this.objectMode=!(!j||!j.objectMode),tt&&(this.objectMode=this.objectMode||!(!j||!j.writableObjectMode)),this.highWaterMark=j?P(this,j,"writableHighWaterMark",tt):M(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const et=!(!j||j.decodeStrings!==!1);this.decodeStrings=!et,this.defaultEncoding=j&&j.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=F.bind(void 0,K),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,S(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!j||j.emitClose!==!1,this.autoDestroy=!j||j.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[X]=[]}function S(j){j.buffered=[],j.bufferedIndex=0,j.allBuffers=!0,j.allNoop=!0}function C(j){const K=this instanceof p("./duplex");if(!K&&!u(C,this))return new C(j);this._writableState=new O(j,this,K),j&&(typeof j.write=="function"&&(this._write=j.write),typeof j.writev=="function"&&(this._writev=j.writev),typeof j.destroy=="function"&&(this._destroy=j.destroy),typeof j.final=="function"&&(this._final=j.final),typeof j.construct=="function"&&(this._construct=j.construct),j.signal&&E(j.signal,this)),h.call(this,j),y.construct(this,()=>{const tt=this._writableState;tt.writing||Z(this,tt),l(this,tt)})}function $(j,K,tt,et){const rt=j._writableState;if(typeof tt=="function")et=tt,tt=rt.defaultEncoding;else{if(tt){if(tt!=="buffer"&&!m.isEncoding(tt))throw new A(tt)}else tt=rt.defaultEncoding;typeof et!="function"&&(et=Q)}if(K===null)throw new d;if(!rt.objectMode)if(typeof K=="string")rt.decodeStrings!==!1&&(K=m.from(K,tt),tt="buffer");else if(K instanceof m)tt="buffer";else{if(!h._isUint8Array(K))throw new k("chunk",["string","Buffer","Uint8Array"],K);K=h._uint8ArrayToBuffer(K),tt="buffer"}let ut;return rt.ending?ut=new T:rt.destroyed&&(ut=new V("write")),ut?(a.nextTick(et,ut),G(j,ut,!0),ut):(rt.pendingcb++,function(st,ot,N,q,it){const nt=ot.objectMode?1:N.length;ot.length+=nt;const at=ot.length<ot.highWaterMark;return at||(ot.needDrain=!0),ot.writing||ot.corked||ot.errored||!ot.constructed?(ot.buffered.push({chunk:N,encoding:q,callback:it}),ot.allBuffers&&q!=="buffer"&&(ot.allBuffers=!1),ot.allNoop&&it!==Q&&(ot.allNoop=!1)):(ot.writelen=nt,ot.writecb=it,ot.writing=!0,ot.sync=!0,st._write(N,q,ot.onwrite),ot.sync=!1),at&&!ot.errored&&!ot.destroyed}(j,rt,K,tt,et))}function B(j,K,tt,et,rt,ut,st){K.writelen=et,K.writecb=st,K.writing=!0,K.sync=!0,K.destroyed?K.onwrite(new V("write")):tt?j._writev(rt,K.onwrite):j._write(rt,ut,K.onwrite),K.sync=!1}function H(j,K,tt,et){--K.pendingcb,et(tt),Y(K),G(j,tt)}function F(j,K){const tt=j._writableState,et=tt.sync,rt=tt.writecb;typeof rt=="function"?(tt.writing=!1,tt.writecb=null,tt.length-=tt.writelen,tt.writelen=0,K?(K.stack,tt.errored||(tt.errored=K),j._readableState&&!j._readableState.errored&&(j._readableState.errored=K),et?a.nextTick(H,j,tt,K,rt):H(j,tt,K,rt)):(tt.buffered.length>tt.bufferedIndex&&Z(j,tt),et?tt.afterWriteTickInfo!==null&&tt.afterWriteTickInfo.cb===rt?tt.afterWriteTickInfo.count++:(tt.afterWriteTickInfo={count:1,cb:rt,stream:j,state:tt},a.nextTick(W,tt.afterWriteTickInfo)):J(j,tt,1,rt))):G(j,new _)}function W({stream:j,state:K,count:tt,cb:et}){return K.afterWriteTickInfo=null,J(j,K,tt,et)}function J(j,K,tt,et){for(!K.ending&&!j.destroyed&&K.length===0&&K.needDrain&&(K.needDrain=!1,j.emit("drain"));tt-- >0;)K.pendingcb--,et();K.destroyed&&Y(K),l(j,K)}function Y(j){if(j.writing)return;for(let rt=j.bufferedIndex;rt<j.buffered.length;++rt){var K;const{chunk:ut,callback:st}=j.buffered[rt],ot=j.objectMode?1:ut.length;j.length-=ot,st((K=j.errored)!==null&&K!==void 0?K:new V("write"))}const tt=j[X].splice(0);for(let rt=0;rt<tt.length;rt++){var et;tt[rt]((et=j.errored)!==null&&et!==void 0?et:new V("end"))}S(j)}function Z(j,K){if(K.corked||K.bufferProcessing||K.destroyed||!K.constructed)return;const{buffered:tt,bufferedIndex:et,objectMode:rt}=K,ut=tt.length-et;if(!ut)return;let st=et;if(K.bufferProcessing=!0,ut>1&&j._writev){K.pendingcb-=ut-1;const ot=K.allNoop?Q:q=>{for(let it=st;it<tt.length;++it)tt[it].callback(q)},N=K.allNoop&&st===0?tt:c(tt,st);N.allBuffers=K.allBuffers,B(j,K,!0,K.length,N,"",ot),S(K)}else{do{const{chunk:ot,encoding:N,callback:q}=tt[st];tt[st++]=null,B(j,K,!1,rt?1:ot.length,ot,N,q)}while(st<tt.length&&!K.writing);st===tt.length?S(K):st>256?(tt.splice(0,st),K.bufferedIndex=0):K.bufferedIndex=st}K.bufferProcessing=!1}function I(j){return j.ending&&!j.destroyed&&j.constructed&&j.length===0&&!j.errored&&j.buffered.length===0&&!j.finished&&!j.writing&&!j.errorEmitted&&!j.closeEmitted}function n(j,K){K.prefinished||K.finalCalled||(typeof j._final!="function"||K.destroyed?(K.prefinished=!0,j.emit("prefinish")):(K.finalCalled=!0,function(tt,et){let rt=!1;function ut(st){if(rt)G(tt,st??_());else if(rt=!0,et.pendingcb--,st){const ot=et[X].splice(0);for(let N=0;N<ot.length;N++)ot[N](st);G(tt,st,et.sync)}else I(et)&&(et.prefinished=!0,tt.emit("prefinish"),et.pendingcb++,a.nextTick(b,tt,et))}et.sync=!0,et.pendingcb++;try{tt._final(ut)}catch(st){ut(st)}et.sync=!1}(j,K)))}function l(j,K,tt){I(K)&&(n(j,K),K.pendingcb===0&&(tt?(K.pendingcb++,a.nextTick((et,rt)=>{I(rt)?b(et,rt):rt.pendingcb--},j,K)):I(K)&&(K.pendingcb++,b(j,K))))}function b(j,K){K.pendingcb--,K.finished=!0;const tt=K[X].splice(0);for(let et=0;et<tt.length;et++)tt[et]();if(j.emit("finish"),K.autoDestroy){const et=j._readableState;(!et||et.autoDestroy&&(et.endEmitted||et.readable===!1))&&j.destroy()}}O.prototype.getBuffer=function(){return c(this.buffered,this.bufferedIndex)},r(O.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}}),r(C,i,{__proto__:null,value:function(j){return!!u(this,j)||this===C&&j&&j._writableState instanceof O}}),C.prototype.pipe=function(){G(this,new x)},C.prototype.write=function(j,K,tt){return $(this,j,K,tt)===!0},C.prototype.cork=function(){this._writableState.corked++},C.prototype.uncork=function(){const j=this._writableState;j.corked&&(j.corked--,j.writing||Z(this,j))},C.prototype.setDefaultEncoding=function(j){if(typeof j=="string"&&(j=t(j)),!m.isEncoding(j))throw new A(j);return this._writableState.defaultEncoding=j,this},C.prototype._write=function(j,K,tt){if(!this._writev)throw new w("_write()");this._writev([{chunk:j,encoding:K}],tt)},C.prototype._writev=null,C.prototype.end=function(j,K,tt){const et=this._writableState;let rt;if(typeof j=="function"?(tt=j,j=null,K=null):typeof K=="function"&&(tt=K,K=null),j!=null){const ut=$(this,j,K);ut instanceof g&&(rt=ut)}return et.corked&&(et.corked=1,this.uncork()),rt||(et.errored||et.ending?et.finished?rt=new D("end"):et.destroyed&&(rt=new V("end")):(et.ending=!0,l(this,et,!0),et.ended=!0)),typeof tt=="function"&&(rt||et.finished?a.nextTick(tt,rt):et[X].push(tt)),this},o(C.prototype,{closed:{__proto__:null,get(){return!!this._writableState&&this._writableState.closed}},destroyed:{__proto__:null,get(){return!!this._writableState&&this._writableState.destroyed},set(j){this._writableState&&(this._writableState.destroyed=j)}},writable:{__proto__:null,get(){const j=this._writableState;return!(!j||j.writable===!1||j.destroyed||j.errored||j.ending||j.ended)},set(j){this._writableState&&(this._writableState.writable=!!j)}},writableFinished:{__proto__:null,get(){return!!this._writableState&&this._writableState.finished}},writableObjectMode:{__proto__:null,get(){return!!this._writableState&&this._writableState.objectMode}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return!!this._writableState&&this._writableState.ending}},writableNeedDrain:{__proto__:null,get(){const j=this._writableState;return!!j&&!j.destroyed&&!j.ending&&j.needDrain}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!(this._writableState.writable===!1||!this._writableState.destroyed&&!this._writableState.errored||this._writableState.finished)}}});const R=y.destroy;let U;function z(){return U===void 0&&(U={}),U}C.prototype.destroy=function(j,K){const tt=this._writableState;return!tt.destroyed&&(tt.bufferedIndex<tt.buffered.length||tt[X].length)&&a.nextTick(Y,tt),R.call(this,j,K),this},C.prototype._undestroy=y.undestroy,C.prototype._destroy=function(j,K){K(j)},C.prototype[f.captureRejectionSymbol]=function(j){this.destroy(j)},C.fromWeb=function(j,K){return z().newStreamWritableFromWritableStream(j,K)},C.toWeb=function(j){return z().newWritableStreamFromStreamWritable(j)}},{"../../ours/errors":126,"../../ours/primordials":127,"./add-abort-signal":107,"./destroy":110,"./duplex":111,"./legacy":115,"./state":120,buffer:29,events:49,"process/":102}],124:[function(p,L,v){const{ArrayIsArray:a,ArrayPrototypeIncludes:c,ArrayPrototypeJoin:g,ArrayPrototypeMap:u,NumberIsInteger:r,NumberIsNaN:o,NumberMAX_SAFE_INTEGER:s,NumberMIN_SAFE_INTEGER:t,NumberParseInt:e,ObjectPrototypeHasOwnProperty:i,RegExpPrototypeExec:f,String:h,StringPrototypeToUpperCase:m,StringPrototypeTrim:y}=p("../ours/primordials"),{hideStackFrames:E,codes:{ERR_SOCKET_BAD_PORT:P,ERR_INVALID_ARG_TYPE:M,ERR_INVALID_ARG_VALUE:k,ERR_OUT_OF_RANGE:w,ERR_UNKNOWN_SIGNAL:_}}=p("../ours/errors"),{normalizeEncoding:x}=p("../ours/util"),{isAsyncFunction:V,isArrayBufferView:D}=p("../ours/util").types,d={},T=/^[0-7]+$/,A=E((l,b,R=t,U=s)=>{if(typeof l!="number")throw new M(b,"number",l);if(!r(l))throw new w(b,"an integer",l);if(l<R||l>U)throw new w(b,`>= ${R} && <= ${U}`,l)}),G=E((l,b,R=-2147483648,U=2147483647)=>{if(typeof l!="number")throw new M(b,"number",l);if(!r(l))throw new w(b,"an integer",l);if(l<R||l>U)throw new w(b,`>= ${R} && <= ${U}`,l)}),Q=E((l,b,R=!1)=>{if(typeof l!="number")throw new M(b,"number",l);if(!r(l))throw new w(b,"an integer",l);const U=R?1:0,z=4294967295;if(l<U||l>z)throw new w(b,`>= ${U} && <= ${z}`,l)});function X(l,b){if(typeof l!="string")throw new M(b,"string",l)}const O=E((l,b,R)=>{if(!c(R,l)){const U=g(u(R,z=>typeof z=="string"?`'${z}'`:h(z)),", ");throw new k(b,l,"must be one of: "+U)}});function S(l,b){if(typeof l!="boolean")throw new M(b,"boolean",l)}function C(l,b,R){return l!=null&&i(l,b)?l[b]:R}const $=E((l,b,R=null)=>{const U=C(R,"allowArray",!1),z=C(R,"allowFunction",!1);if(!C(R,"nullable",!1)&&l===null||!U&&a(l)||typeof l!="object"&&(!z||typeof l!="function"))throw new M(b,"Object",l)}),B=E((l,b)=>{if(l!=null&&typeof l!="object"&&typeof l!="function")throw new M(b,"a dictionary",l)}),H=E((l,b,R=0)=>{if(!a(l))throw new M(b,"Array",l);if(l.length<R)throw new k(b,l,`must be longer than ${R}`)}),F=E((l,b="buffer")=>{if(!D(l))throw new M(b,["Buffer","TypedArray","DataView"],l)}),W=E((l,b)=>{if(l!==void 0&&(l===null||typeof l!="object"||!("aborted"in l)))throw new M(b,"AbortSignal",l)}),J=E((l,b)=>{if(typeof l!="function")throw new M(b,"Function",l)}),Y=E((l,b)=>{if(typeof l!="function"||V(l))throw new M(b,"Function",l)}),Z=E((l,b)=>{if(l!==void 0)throw new M(b,"undefined",l)}),I=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function n(l,b){if(l===void 0||!f(I,l))throw new k(b,l,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}L.exports={isInt32:function(l){return l===(0|l)},isUint32:function(l){return l===l>>>0},parseFileMode:function(l,b,R){if(l===void 0&&(l=R),typeof l=="string"){if(f(T,l)===null)throw new k(b,l,"must be a 32-bit unsigned integer or an octal string");l=e(l,8)}return Q(l,b),l},validateArray:H,validateStringArray:function(l,b){H(l,b);for(let R=0;R<l.length;R++)X(l[R],`${b}[${R}]`)},validateBooleanArray:function(l,b){H(l,b);for(let R=0;R<l.length;R++)S(l[R],`${b}[${R}]`)},validateBoolean:S,validateBuffer:F,validateDictionary:B,validateEncoding:function(l,b){const R=x(b),U=l.length;if(R==="hex"&&U%2!=0)throw new k("encoding",b,`is invalid for data of length ${U}`)},validateFunction:J,validateInt32:G,validateInteger:A,validateNumber:function(l,b,R=void 0,U){if(typeof l!="number")throw new M(b,"number",l);if(R!=null&&l<R||U!=null&&l>U||(R!=null||U!=null)&&o(l))throw new w(b,`${R!=null?`>= ${R}`:""}${R!=null&&U!=null?" && ":""}${U!=null?`<= ${U}`:""}`,l)},validateObject:$,validateOneOf:O,validatePlainFunction:Y,validatePort:function(l,b="Port",R=!0){if(typeof l!="number"&&typeof l!="string"||typeof l=="string"&&y(l).length===0||+l!=+l>>>0||l>65535||l===0&&!R)throw new P(b,l,R);return 0|l},validateSignalName:function(l,b="signal"){if(X(l,b),d[l]===void 0)throw d[m(l)]!==void 0?new _(l+" (signals must use all capital letters)"):new _(l)},validateString:X,validateUint32:Q,validateUndefined:Z,validateUnion:function(l,b,R){if(!c(R,l))throw new M(b,`('${g(R,"|")}')`,l)},validateAbortSignal:W,validateLinkHeaderValue:function(l){if(typeof l=="string")return n(l,"hints"),l;if(a(l)){const b=l.length;let R="";if(b===0)return R;for(let U=0;U<b;U++){const z=l[U];n(z,"hints"),R+=z,U!==b-1&&(R+=", ")}return R}throw new k("hints",l,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}}},{"../ours/errors":126,"../ours/primordials":127,"../ours/util":128}],125:[function(p,L,v){const a=p("../stream"),c=p("../stream/promises"),g=a.Readable.destroy;L.exports=a.Readable,L.exports._uint8ArrayToBuffer=a._uint8ArrayToBuffer,L.exports._isUint8Array=a._isUint8Array,L.exports.isDisturbed=a.isDisturbed,L.exports.isErrored=a.isErrored,L.exports.isReadable=a.isReadable,L.exports.Readable=a.Readable,L.exports.Writable=a.Writable,L.exports.Duplex=a.Duplex,L.exports.Transform=a.Transform,L.exports.PassThrough=a.PassThrough,L.exports.addAbortSignal=a.addAbortSignal,L.exports.finished=a.finished,L.exports.destroy=a.destroy,L.exports.destroy=g,L.exports.pipeline=a.pipeline,L.exports.compose=a.compose,Object.defineProperty(a,"promises",{configurable:!0,enumerable:!0,get:()=>c}),L.exports.Stream=a.Stream,L.exports.default=L.exports},{"../stream":129,"../stream/promises":130}],126:[function(p,L,v){const{format:a,inspect:c,AggregateError:g}=p("./util"),u=globalThis.AggregateError||g,r=Symbol("kIsNodeError"),o=["string","function","number","object","Function","Object","boolean","bigint","symbol"],s=/^([A-Z][a-z0-9]*)+$/,t={};function e(y,E){if(!y)throw new t.ERR_INTERNAL_ASSERTION(E)}function i(y){let E="",P=y.length;const M=y[0]==="-"?1:0;for(;P>=M+4;P-=3)E=`_${y.slice(P-3,P)}${E}`;return`${y.slice(0,P)}${E}`}function f(y,E,P){P||(P=Error);class M extends P{constructor(...w){super(function(_,x,V){if(typeof x=="function")return e(x.length<=V.length,`Code: ${_}; The provided arguments length (${V.length}) does not match the required ones (${x.length}).`),x(...V);const D=(x.match(/%[dfijoOs]/g)||[]).length;return e(D===V.length,`Code: ${_}; The provided arguments length (${V.length}) does not match the required ones (${D}).`),V.length===0?x:a(x,...V)}(y,E,w))}toString(){return`${this.name} [${y}]: ${this.message}`}}Object.defineProperties(M.prototype,{name:{value:P.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${y}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),M.prototype.code=y,M.prototype[r]=!0,t[y]=M}function h(y){const E="__node_internal_"+y.name;return Object.defineProperty(y,"name",{value:E}),y}class m extends Error{constructor(E="The operation was aborted",P=void 0){if(P!==void 0&&typeof P!="object")throw new t.ERR_INVALID_ARG_TYPE("options","Object",P);super(E,P),this.code="ABORT_ERR",this.name="AbortError"}}f("ERR_ASSERTION","%s",Error),f("ERR_INVALID_ARG_TYPE",(y,E,P)=>{e(typeof y=="string","'name' must be a string"),Array.isArray(E)||(E=[E]);let M="The ";y.endsWith(" argument")?M+=`${y} `:M+=`"${y}" ${y.includes(".")?"property":"argument"} `,M+="must be ";const k=[],w=[],_=[];for(const V of E)e(typeof V=="string","All expected entries have to be of type string"),o.includes(V)?k.push(V.toLowerCase()):s.test(V)?w.push(V):(e(V!=="object",'The value "object" should be written as "Object"'),_.push(V));if(w.length>0){const V=k.indexOf("object");V!==-1&&(k.splice(k,V,1),w.push("Object"))}if(k.length>0){switch(k.length){case 1:M+=`of type ${k[0]}`;break;case 2:M+=`one of type ${k[0]} or ${k[1]}`;break;default:{const V=k.pop();M+=`one of type ${k.join(", ")}, or ${V}`}}(w.length>0||_.length>0)&&(M+=" or ")}if(w.length>0){switch(w.length){case 1:M+=`an instance of ${w[0]}`;break;case 2:M+=`an instance of ${w[0]} or ${w[1]}`;break;default:{const V=w.pop();M+=`an instance of ${w.join(", ")}, or ${V}`}}_.length>0&&(M+=" or ")}switch(_.length){case 0:break;case 1:_[0].toLowerCase()!==_[0]&&(M+="an "),M+=`${_[0]}`;break;case 2:M+=`one of ${_[0]} or ${_[1]}`;break;default:{const V=_.pop();M+=`one of ${_.join(", ")}, or ${V}`}}if(P==null)M+=`. Received ${P}`;else if(typeof P=="function"&&P.name)M+=`. Received function ${P.name}`;else if(typeof P=="object"){var x;(x=P.constructor)!==null&&x!==void 0&&x.name?M+=`. Received an instance of ${P.constructor.name}`:M+=`. Received ${c(P,{depth:-1})}`}else{let V=c(P,{colors:!1});V.length>25&&(V=`${V.slice(0,25)}...`),M+=`. Received type ${typeof P} (${V})`}return M},TypeError),f("ERR_INVALID_ARG_VALUE",(y,E,P="is invalid")=>{let M=c(E);return M.length>128&&(M=M.slice(0,128)+"..."),`The ${y.includes(".")?"property":"argument"} '${y}' ${P}. Received ${M}`},TypeError),f("ERR_INVALID_RETURN_VALUE",(y,E,P)=>{var M;return`Expected ${y} to be returned from the "${E}" function but got ${P!=null&&(M=P.constructor)!==null&&M!==void 0&&M.name?`instance of ${P.constructor.name}`:"type "+typeof P}.`},TypeError),f("ERR_MISSING_ARGS",(...y)=>{let E;e(y.length>0,"At least one arg needs to be specified");const P=y.length;switch(y=(Array.isArray(y)?y:[y]).map(M=>`"${M}"`).join(" or "),P){case 1:E+=`The ${y[0]} argument`;break;case 2:E+=`The ${y[0]} and ${y[1]} arguments`;break;default:{const M=y.pop();E+=`The ${y.join(", ")}, and ${M} arguments`}}return`${E} must be specified`},TypeError),f("ERR_OUT_OF_RANGE",(y,E,P)=>{let M;return e(E,'Missing "range" argument'),Number.isInteger(P)&&Math.abs(P)>2**32?M=i(String(P)):typeof P=="bigint"?(M=String(P),(P>2n**32n||P<-(2n**32n))&&(M=i(M)),M+="n"):M=c(P),`The value of "${y}" is out of range. It must be ${E}. Received ${M}`},RangeError),f("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),f("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),f("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),f("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),f("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),f("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),f("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),f("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),f("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),f("ERR_STREAM_WRITE_AFTER_END","write after end",Error),f("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),L.exports={AbortError:m,aggregateTwoErrors:h(function(y,E){if(y&&E&&y!==E){if(Array.isArray(E.errors))return E.errors.push(y),E;const P=new u([E,y],E.message);return P.code=E.code,P}return y||E}),hideStackFrames:h,codes:t}},{"./util":128}],127:[function(p,L,v){L.exports={ArrayIsArray:a=>Array.isArray(a),ArrayPrototypeIncludes:(a,c)=>a.includes(c),ArrayPrototypeIndexOf:(a,c)=>a.indexOf(c),ArrayPrototypeJoin:(a,c)=>a.join(c),ArrayPrototypeMap:(a,c)=>a.map(c),ArrayPrototypePop:(a,c)=>a.pop(c),ArrayPrototypePush:(a,c)=>a.push(c),ArrayPrototypeSlice:(a,c,g)=>a.slice(c,g),Error,FunctionPrototypeCall:(a,c,...g)=>a.call(c,...g),FunctionPrototypeSymbolHasInstance:(a,c)=>Function.prototype[Symbol.hasInstance].call(a,c),MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties:(a,c)=>Object.defineProperties(a,c),ObjectDefineProperty:(a,c,g)=>Object.defineProperty(a,c,g),ObjectGetOwnPropertyDescriptor:(a,c)=>Object.getOwnPropertyDescriptor(a,c),ObjectKeys:a=>Object.keys(a),ObjectSetPrototypeOf:(a,c)=>Object.setPrototypeOf(a,c),Promise,PromisePrototypeCatch:(a,c)=>a.catch(c),PromisePrototypeThen:(a,c,g)=>a.then(c,g),PromiseReject:a=>Promise.reject(a),ReflectApply:Reflect.apply,RegExpPrototypeTest:(a,c)=>a.test(c),SafeSet:Set,String,StringPrototypeSlice:(a,c,g)=>a.slice(c,g),StringPrototypeToLowerCase:a=>a.toLowerCase(),StringPrototypeToUpperCase:a=>a.toUpperCase(),StringPrototypeTrim:a=>a.trim(),Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,TypedArrayPrototypeSet:(a,c,g)=>a.set(c,g),Uint8Array}},{}],128:[function(p,L,v){const a=p("buffer"),c=Object.getPrototypeOf(async function(){}).constructor,g=globalThis.Blob||a.Blob,u=g!==void 0?function(o){return o instanceof g}:function(o){return!1};class r extends Error{constructor(s){if(!Array.isArray(s))throw new TypeError("Expected input to be an Array, got "+typeof s);let t="";for(let e=0;e<s.length;e++)t+=`    ${s[e].stack}
`;super(t),this.name="AggregateError",this.errors=s}}L.exports={AggregateError:r,kEmptyObject:Object.freeze({}),once(o){let s=!1;return function(...t){s||(s=!0,o.apply(this,t))}},createDeferredPromise:function(){let o,s;return{promise:new Promise((t,e)=>{o=t,s=e}),resolve:o,reject:s}},promisify:o=>new Promise((s,t)=>{o((e,...i)=>e?t(e):s(...i))}),debuglog:()=>function(){},format:(o,...s)=>o.replace(/%([sdifj])/g,function(...[t,e]){const i=s.shift();return e==="f"?i.toFixed(6):e==="j"?JSON.stringify(i):e==="s"&&typeof i=="object"?`${i.constructor!==Object?i.constructor.name:""} {}`.trim():i.toString()}),inspect(o){switch(typeof o){case"string":if(o.includes("'")){if(!o.includes('"'))return`"${o}"`;if(!o.includes("`")&&!o.includes("${"))return`\`${o}\``}return`'${o}'`;case"number":return isNaN(o)?"NaN":Object.is(o,-0)?String(o):o;case"bigint":return`${String(o)}n`;case"boolean":case"undefined":return String(o);case"object":return"{}"}},types:{isAsyncFunction:o=>o instanceof c,isArrayBufferView:o=>ArrayBuffer.isView(o)},isBlob:u},L.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")},{buffer:29}],129:[function(p,L,v){const{Buffer:a}=p("buffer"),{ObjectDefineProperty:c,ObjectKeys:g,ReflectApply:u}=p("./ours/primordials"),{promisify:{custom:r}}=p("./ours/util"),{streamReturningOperators:o,promiseReturningOperators:s}=p("./internal/streams/operators"),{codes:{ERR_ILLEGAL_CONSTRUCTOR:t}}=p("./ours/errors"),e=p("./internal/streams/compose"),{pipeline:i}=p("./internal/streams/pipeline"),{destroyer:f}=p("./internal/streams/destroy"),h=p("./internal/streams/end-of-stream"),m=p("./stream/promises"),y=p("./internal/streams/utils"),E=L.exports=p("./internal/streams/legacy").Stream;E.isDisturbed=y.isDisturbed,E.isErrored=y.isErrored,E.isReadable=y.isReadable,E.Readable=p("./internal/streams/readable");for(const k of g(o)){let _=function(...x){if(new.target)throw t();return E.Readable.from(u(w,this,x))};var M=_;const w=o[k];c(_,"name",{__proto__:null,value:w.name}),c(_,"length",{__proto__:null,value:w.length}),c(E.Readable.prototype,k,{__proto__:null,value:_,enumerable:!1,configurable:!0,writable:!0})}for(const k of g(s)){let _=function(...V){if(new.target)throw t();return u(w,this,V)};var M=_;const w=s[k];c(_,"name",{__proto__:null,value:w.name}),c(_,"length",{__proto__:null,value:w.length}),c(E.Readable.prototype,k,{__proto__:null,value:_,enumerable:!1,configurable:!0,writable:!0})}E.Writable=p("./internal/streams/writable"),E.Duplex=p("./internal/streams/duplex"),E.Transform=p("./internal/streams/transform"),E.PassThrough=p("./internal/streams/passthrough"),E.pipeline=i;const{addAbortSignal:P}=p("./internal/streams/add-abort-signal");E.addAbortSignal=P,E.finished=h,E.destroy=f,E.compose=e,c(E,"promises",{__proto__:null,configurable:!0,enumerable:!0,get:()=>m}),c(i,r,{__proto__:null,enumerable:!0,get:()=>m.pipeline}),c(h,r,{__proto__:null,enumerable:!0,get:()=>m.finished}),E.Stream=E,E._isUint8Array=function(k){return k instanceof Uint8Array},E._uint8ArrayToBuffer=function(k){return a.from(k.buffer,k.byteOffset,k.byteLength)}},{"./internal/streams/add-abort-signal":107,"./internal/streams/compose":109,"./internal/streams/destroy":110,"./internal/streams/duplex":111,"./internal/streams/end-of-stream":113,"./internal/streams/legacy":115,"./internal/streams/operators":116,"./internal/streams/passthrough":117,"./internal/streams/pipeline":118,"./internal/streams/readable":119,"./internal/streams/transform":121,"./internal/streams/utils":122,"./internal/streams/writable":123,"./ours/errors":126,"./ours/primordials":127,"./ours/util":128,"./stream/promises":130,buffer:29}],130:[function(p,L,v){const{ArrayPrototypePop:a,Promise:c}=p("../ours/primordials"),{isIterable:g,isNodeStream:u,isWebStream:r}=p("../internal/streams/utils"),{pipelineImpl:o}=p("../internal/streams/pipeline"),{finished:s}=p("../internal/streams/end-of-stream");p("../../lib/stream.js"),L.exports={finished:s,pipeline:function(...t){return new c((e,i)=>{let f,h;const m=t[t.length-1];if(m&&typeof m=="object"&&!u(m)&&!g(m)&&!r(m)){const y=a(t);f=y.signal,h=y.end}o(t,(y,E)=>{y?i(y):e(E)},{signal:f,end:h})})}}},{"../../lib/stream.js":129,"../internal/streams/end-of-stream":113,"../internal/streams/pipeline":118,"../internal/streams/utils":122,"../ours/primordials":127}],131:[function(p,L,v){function a(c,g,u){var r=this;this._callback=c,this._args=u,this._interval=setInterval(c,g,this._args),this.reschedule=function(o){o||(o=r._interval),r._interval&&clearInterval(r._interval),r._interval=setInterval(r._callback,o,r._args)},this.clear=function(){r._interval&&(clearInterval(r._interval),r._interval=void 0)},this.destroy=function(){r._interval&&clearInterval(r._interval),r._callback=void 0,r._interval=void 0,r._args=void 0}}L.exports=function(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("interval needed");var c;if(arguments.length>0){c=new Array(arguments.length-2);for(var g=0;g<c.length;g++)c[g]=arguments[g+2]}return new a(arguments[0],arguments[1],c)}},{}],132:[function(p,L,v){L.exports=p("./index.js")()},{"./index.js":133}],133:[function(p,L,v){(function(a){(function(){function c(g){return g instanceof a?a.from(g):new g.constructor(g.buffer.slice(),g.byteOffset,g.length)}L.exports=function(g){return(g=g||{}).circles?function(r){var o=[],s=[];return r.proto?function e(i){if(typeof i!="object"||i===null)return i;if(i instanceof Date)return new Date(i);if(Array.isArray(i))return t(i,e);if(i instanceof Map)return new Map(t(Array.from(i),e));if(i instanceof Set)return new Set(t(Array.from(i),e));var f={};for(var h in o.push(i),s.push(f),i){var m=i[h];if(typeof m!="object"||m===null)f[h]=m;else if(m instanceof Date)f[h]=new Date(m);else if(m instanceof Map)f[h]=new Map(t(Array.from(m),e));else if(m instanceof Set)f[h]=new Set(t(Array.from(m),e));else if(ArrayBuffer.isView(m))f[h]=c(m);else{var y=o.indexOf(m);f[h]=y!==-1?s[y]:e(m)}}return o.pop(),s.pop(),f}:function e(i){if(typeof i!="object"||i===null)return i;if(i instanceof Date)return new Date(i);if(Array.isArray(i))return t(i,e);if(i instanceof Map)return new Map(t(Array.from(i),e));if(i instanceof Set)return new Set(t(Array.from(i),e));var f={};for(var h in o.push(i),s.push(f),i)if(Object.hasOwnProperty.call(i,h)!==!1){var m=i[h];if(typeof m!="object"||m===null)f[h]=m;else if(m instanceof Date)f[h]=new Date(m);else if(m instanceof Map)f[h]=new Map(t(Array.from(m),e));else if(m instanceof Set)f[h]=new Set(t(Array.from(m),e));else if(ArrayBuffer.isView(m))f[h]=c(m);else{var y=o.indexOf(m);f[h]=y!==-1?s[y]:e(m)}}return o.pop(),s.pop(),f};function t(e,i){for(var f=Object.keys(e),h=new Array(f.length),m=0;m<f.length;m++){var y=f[m],E=e[y];if(typeof E!="object"||E===null)h[y]=E;else if(E instanceof Date)h[y]=new Date(E);else if(ArrayBuffer.isView(E))h[y]=c(E);else{var P=o.indexOf(E);h[y]=P!==-1?s[P]:i(E)}}return h}}(g):g.proto?function r(o){if(typeof o!="object"||o===null)return o;if(o instanceof Date)return new Date(o);if(Array.isArray(o))return u(o,r);if(o instanceof Map)return new Map(u(Array.from(o),r));if(o instanceof Set)return new Set(u(Array.from(o),r));var s={};for(var t in o){var e=o[t];typeof e!="object"||e===null?s[t]=e:e instanceof Date?s[t]=new Date(e):e instanceof Map?s[t]=new Map(u(Array.from(e),r)):e instanceof Set?s[t]=new Set(u(Array.from(e),r)):ArrayBuffer.isView(e)?s[t]=c(e):s[t]=r(e)}return s}:function r(o){if(typeof o!="object"||o===null)return o;if(o instanceof Date)return new Date(o);if(Array.isArray(o))return u(o,r);if(o instanceof Map)return new Map(u(Array.from(o),r));if(o instanceof Set)return new Set(u(Array.from(o),r));var s={};for(var t in o)if(Object.hasOwnProperty.call(o,t)!==!1){var e=o[t];typeof e!="object"||e===null?s[t]=e:e instanceof Date?s[t]=new Date(e):e instanceof Map?s[t]=new Map(u(Array.from(e),r)):e instanceof Set?s[t]=new Set(u(Array.from(e),r)):ArrayBuffer.isView(e)?s[t]=c(e):s[t]=r(e)}return s};function u(r,o){for(var s=Object.keys(r),t=new Array(s.length),e=0;e<s.length;e++){var i=s[e],f=r[i];typeof f!="object"||f===null?t[i]=f:f instanceof Date?t[i]=new Date(f):ArrayBuffer.isView(f)?t[i]=c(f):t[i]=o(f)}return t}}}).call(this)}).call(this,p("buffer").Buffer)},{buffer:29}],134:[function(p,L,v){/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var a=p("buffer"),c=a.Buffer;function g(r,o){for(var s in r)o[s]=r[s]}function u(r,o,s){return c(r,o,s)}c.from&&c.alloc&&c.allocUnsafe&&c.allocUnsafeSlow?L.exports=a:(g(a,v),v.Buffer=u),u.prototype=Object.create(c.prototype),g(c,u),u.from=function(r,o,s){if(typeof r=="number")throw new TypeError("Argument must not be a number");return c(r,o,s)},u.alloc=function(r,o,s){if(typeof r!="number")throw new TypeError("Argument must be a number");var t=c(r);return o!==void 0?typeof s=="string"?t.fill(o,s):t.fill(o):t.fill(0),t},u.allocUnsafe=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return c(r)},u.allocUnsafeSlow=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return a.SlowBuffer(r)}},{buffer:29}],135:[function(p,L,v){L.exports=function(a){var c=a._readableState;return c?c.objectMode||typeof a._duplexState=="number"?a.read():a.read(function(g){return g.buffer.length?g.buffer.head?g.buffer.head.data.length:g.buffer[0].length:g.length}(c)):null}},{}],136:[function(p,L,v){arguments[4][28][0].apply(v,arguments)},{dup:28,"safe-buffer":134}],137:[function(p,L,v){var a=p("punycode"),c=p("./util");function g(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}v.parse=M,v.resolve=function(k,w){return M(k,!1,!0).resolve(w)},v.resolveObject=function(k,w){return k?M(k,!1,!0).resolveObject(w):w},v.format=function(k){return c.isString(k)&&(k=M(k)),k instanceof g?k.format():g.prototype.format.call(k)},v.Url=g;var u=/^([a-z0-9.+-]+:)/i,r=/:[0-9]*$/,o=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,s=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r",`
`,"	"]),t=["'"].concat(s),e=["%","/","?",";","#"].concat(t),i=["/","?","#"],f=/^[+a-z0-9A-Z_-]{0,63}$/,h=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,m={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},E={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},P=p("querystring");function M(k,w,_){if(k&&c.isObject(k)&&k instanceof g)return k;var x=new g;return x.parse(k,w,_),x}g.prototype.parse=function(k,w,_){if(!c.isString(k))throw new TypeError("Parameter 'url' must be a string, not "+typeof k);var x=k.indexOf("?"),V=x!==-1&&x<k.indexOf("#")?"?":"#",D=k.split(V);D[0]=D[0].replace(/\\/g,"/");var d=k=D.join(V);if(d=d.trim(),!_&&k.split("#").length===1){var T=o.exec(d);if(T)return this.path=d,this.href=d,this.pathname=T[1],T[2]?(this.search=T[2],this.query=w?P.parse(this.search.substr(1)):this.search.substr(1)):w&&(this.search="",this.query={}),this}var A=u.exec(d);if(A){var G=(A=A[0]).toLowerCase();this.protocol=G,d=d.substr(A.length)}if(_||A||d.match(/^\/\/[^@\/]+@[^@\/]+/)){var Q=d.substr(0,2)==="//";!Q||A&&y[A]||(d=d.substr(2),this.slashes=!0)}if(!y[A]&&(Q||A&&!E[A])){for(var X,O,S=-1,C=0;C<i.length;C++)($=d.indexOf(i[C]))!==-1&&(S===-1||$<S)&&(S=$);for((O=S===-1?d.lastIndexOf("@"):d.lastIndexOf("@",S))!==-1&&(X=d.slice(0,O),d=d.slice(O+1),this.auth=decodeURIComponent(X)),S=-1,C=0;C<e.length;C++){var $;($=d.indexOf(e[C]))!==-1&&(S===-1||$<S)&&(S=$)}S===-1&&(S=d.length),this.host=d.slice(0,S),d=d.slice(S),this.parseHost(),this.hostname=this.hostname||"";var B=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!B)for(var H=this.hostname.split(/\./),F=(C=0,H.length);C<F;C++){var W=H[C];if(W&&!W.match(f)){for(var J="",Y=0,Z=W.length;Y<Z;Y++)W.charCodeAt(Y)>127?J+="x":J+=W[Y];if(!J.match(f)){var I=H.slice(0,C),n=H.slice(C+1),l=W.match(h);l&&(I.push(l[1]),n.unshift(l[2])),n.length&&(d="/"+n.join(".")+d),this.hostname=I.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),B||(this.hostname=a.toASCII(this.hostname));var b=this.port?":"+this.port:"",R=this.hostname||"";this.host=R+b,this.href+=this.host,B&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),d[0]!=="/"&&(d="/"+d))}if(!m[G])for(C=0,F=t.length;C<F;C++){var U=t[C];if(d.indexOf(U)!==-1){var z=encodeURIComponent(U);z===U&&(z=escape(U)),d=d.split(U).join(z)}}var j=d.indexOf("#");j!==-1&&(this.hash=d.substr(j),d=d.slice(0,j));var K=d.indexOf("?");if(K!==-1?(this.search=d.substr(K),this.query=d.substr(K+1),w&&(this.query=P.parse(this.query)),d=d.slice(0,K)):w&&(this.search="",this.query={}),d&&(this.pathname=d),E[G]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){b=this.pathname||"";var tt=this.search||"";this.path=b+tt}return this.href=this.format(),this},g.prototype.format=function(){var k=this.auth||"";k&&(k=(k=encodeURIComponent(k)).replace(/%3A/i,":"),k+="@");var w=this.protocol||"",_=this.pathname||"",x=this.hash||"",V=!1,D="";this.host?V=k+this.host:this.hostname&&(V=k+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(V+=":"+this.port)),this.query&&c.isObject(this.query)&&Object.keys(this.query).length&&(D=P.stringify(this.query));var d=this.search||D&&"?"+D||"";return w&&w.substr(-1)!==":"&&(w+=":"),this.slashes||(!w||E[w])&&V!==!1?(V="//"+(V||""),_&&_.charAt(0)!=="/"&&(_="/"+_)):V||(V=""),x&&x.charAt(0)!=="#"&&(x="#"+x),d&&d.charAt(0)!=="?"&&(d="?"+d),w+V+(_=_.replace(/[?#]/g,function(T){return encodeURIComponent(T)}))+(d=d.replace("#","%23"))+x},g.prototype.resolve=function(k){return this.resolveObject(M(k,!1,!0)).format()},g.prototype.resolveObject=function(k){if(c.isString(k)){var w=new g;w.parse(k,!1,!0),k=w}for(var _=new g,x=Object.keys(this),V=0;V<x.length;V++){var D=x[V];_[D]=this[D]}if(_.hash=k.hash,k.href==="")return _.href=_.format(),_;if(k.slashes&&!k.protocol){for(var d=Object.keys(k),T=0;T<d.length;T++){var A=d[T];A!=="protocol"&&(_[A]=k[A])}return E[_.protocol]&&_.hostname&&!_.pathname&&(_.path=_.pathname="/"),_.href=_.format(),_}if(k.protocol&&k.protocol!==_.protocol){if(!E[k.protocol]){for(var G=Object.keys(k),Q=0;Q<G.length;Q++){var X=G[Q];_[X]=k[X]}return _.href=_.format(),_}if(_.protocol=k.protocol,k.host||y[k.protocol])_.pathname=k.pathname;else{for(var O=(k.pathname||"").split("/");O.length&&!(k.host=O.shift()););k.host||(k.host=""),k.hostname||(k.hostname=""),O[0]!==""&&O.unshift(""),O.length<2&&O.unshift(""),_.pathname=O.join("/")}if(_.search=k.search,_.query=k.query,_.host=k.host||"",_.auth=k.auth,_.hostname=k.hostname||k.host,_.port=k.port,_.pathname||_.search){var S=_.pathname||"",C=_.search||"";_.path=S+C}return _.slashes=_.slashes||k.slashes,_.href=_.format(),_}var $=_.pathname&&_.pathname.charAt(0)==="/",B=k.host||k.pathname&&k.pathname.charAt(0)==="/",H=B||$||_.host&&k.pathname,F=H,W=_.pathname&&_.pathname.split("/")||[],J=(O=k.pathname&&k.pathname.split("/")||[],_.protocol&&!E[_.protocol]);if(J&&(_.hostname="",_.port=null,_.host&&(W[0]===""?W[0]=_.host:W.unshift(_.host)),_.host="",k.protocol&&(k.hostname=null,k.port=null,k.host&&(O[0]===""?O[0]=k.host:O.unshift(k.host)),k.host=null),H=H&&(O[0]===""||W[0]==="")),B)_.host=k.host||k.host===""?k.host:_.host,_.hostname=k.hostname||k.hostname===""?k.hostname:_.hostname,_.search=k.search,_.query=k.query,W=O;else if(O.length)W||(W=[]),W.pop(),W=W.concat(O),_.search=k.search,_.query=k.query;else if(!c.isNullOrUndefined(k.search))return J&&(_.hostname=_.host=W.shift(),(l=!!(_.host&&_.host.indexOf("@")>0)&&_.host.split("@"))&&(_.auth=l.shift(),_.host=_.hostname=l.shift())),_.search=k.search,_.query=k.query,c.isNull(_.pathname)&&c.isNull(_.search)||(_.path=(_.pathname?_.pathname:"")+(_.search?_.search:"")),_.href=_.format(),_;if(!W.length)return _.pathname=null,_.search?_.path="/"+_.search:_.path=null,_.href=_.format(),_;for(var Y=W.slice(-1)[0],Z=(_.host||k.host||W.length>1)&&(Y==="."||Y==="..")||Y==="",I=0,n=W.length;n>=0;n--)(Y=W[n])==="."?W.splice(n,1):Y===".."?(W.splice(n,1),I++):I&&(W.splice(n,1),I--);if(!H&&!F)for(;I--;I)W.unshift("..");!H||W[0]===""||W[0]&&W[0].charAt(0)==="/"||W.unshift(""),Z&&W.join("/").substr(-1)!=="/"&&W.push("");var l,b=W[0]===""||W[0]&&W[0].charAt(0)==="/";return J&&(_.hostname=_.host=b?"":W.length?W.shift():"",(l=!!(_.host&&_.host.indexOf("@")>0)&&_.host.split("@"))&&(_.auth=l.shift(),_.host=_.hostname=l.shift())),(H=H||_.host&&W.length)&&!b&&W.unshift(""),W.length?_.pathname=W.join("/"):(_.pathname=null,_.path=null),c.isNull(_.pathname)&&c.isNull(_.search)||(_.path=(_.pathname?_.pathname:"")+(_.search?_.search:"")),_.auth=k.auth||_.auth,_.slashes=_.slashes||k.slashes,_.href=_.format(),_},g.prototype.parseHost=function(){var k=this.host,w=r.exec(k);w&&((w=w[0])!==":"&&(this.port=w.substr(1)),k=k.substr(0,k.length-w.length)),k&&(this.hostname=k)}},{"./util":138,punycode:103,querystring:106}],138:[function(p,L,v){L.exports={isString:function(a){return typeof a=="string"},isObject:function(a){return typeof a=="object"&&a!==null},isNull:function(a){return a===null},isNullOrUndefined:function(a){return a==null}}},{}],139:[function(p,L,v){(function(a){(function(){function c(g){try{if(!a.localStorage)return!1}catch{return!1}var u=a.localStorage[g];return u!=null&&String(u).toLowerCase()==="true"}L.exports=function(g,u){if(c("noDeprecation"))return g;var r=!1;return function(){if(!r){if(c("throwDeprecation"))throw new Error(u);c("traceDeprecation")?console.trace(u):console.warn(u),r=!0}return g.apply(this,arguments)}}}).call(this)}).call(this,typeof wt<"u"?wt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],140:[function(p,L,v){L.exports=function a(c,g){if(c&&g)return a(c)(g);if(typeof c!="function")throw new TypeError("need wrapper function");return Object.keys(c).forEach(function(r){u[r]=c[r]}),u;function u(){for(var r=new Array(arguments.length),o=0;o<r.length;o++)r[o]=arguments[o];var s=c.apply(this,r),t=r[r.length-1];return typeof s=="function"&&s!==t&&Object.keys(t).forEach(function(e){s[e]=t[e]}),s}}},{}],141:[function(p,L,v){L.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},{}]},{},[23])(23)})})(Lt);var xt=Lt.exports;const qt=Wt(xt),Ht=Ft({__proto__:null,default:qt},[xt]);class Bt extends HTMLElement{constructor(lt){if(super(),this.attachShadow({mode:"open"}),lt.cssText){const p=new CSSStyleSheet;p.replaceSync(lt.cssText),this.shadowRoot.adoptedStyleSheets=[p]}lt.htmlText&&(this.shadowRoot.innerHTML=lt.htmlText)}}const $t=`:host{cursor:pointer;display:flex;align-items:center}g{transition:transform .2s ease-in-out}:host([on]) g{transform:translate(28px)}:host([on]) g circle{fill:var(--base_color-accent)}.checkmark-icon,.x-icon{transition:opacity .2s ease-in-out}g .x-icon{opacity:1}:host([on]) g .x-icon{opacity:0}:host([on]) g .checkmark-icon{opacity:1}
`,zt=`<svg width="48" height="24" viewBox="0 0 48 30" xmlns="http://www.w3.org/2000/svg">\r
    <!-- Track -->\r
    <rect x="0" y="10" width="48" height="10" fill="#ccc" rx="5" />\r
\r
    <!-- Moving Circle (Slider) -->\r
    <g transform="translate(0, 0)">\r
        <circle class="slider-circle" cx="10" cy="15" r="10" fill="var(--base_color-secondary)" />\r
        <path class="checkmark-icon" d="M4 15 L8 19 L16 10" stroke="#fff" stroke-width="2" fill="none" opacity="0"\r
            stroke-linecap="round" stroke-linejoin="round" />\r
        <path class="x-icon" d="M7 12 L13 18 M7 18 L13 12" stroke="#fff" stroke-width="2" fill="none"\r
            stroke-linecap="round" stroke-linejoin="round" />\r
    </g>\r
\r
    <!-- Clickable Area -->\r
    <rect x="0" y="0" width="48" height="24" fill="transparent" />\r
</svg>`;class Ot extends Bt{constructor(){super({htmlText:zt,cssText:$t})}connectedCallback(){this.shadowRoot.host.addEventListener("click",()=>{this.hasAttribute("on")?this.removeAttribute("on"):this.setAttribute("on","")})}static get observedAttributes(){return["on"]}attributeChangedCallback(lt,p,L){lt==="on"&&(this.hasAttribute("on")?this.dispatchEvent(new CustomEvent("on")):this.dispatchEvent(new CustomEvent("off")))}}const Vt=`:host{display:grid;grid-template-rows:auto 1fr auto!important;overflow:hidden;padding:16px!important;gap:0!important}h1{margin:0}footer{display:flex;align-content:center}input{width:100%;padding:16px;height:fit-content}section{overflow:auto;padding:16px 0}section button{margin-left:16px}
`,Kt=`<header>\r
    <h1></h1>\r
</header>\r
\r
<section>\r
\r
</section>\r
\r
<footer>\r
    <input type="textarea">\r
    <button>send</button>\r
</footer>`;class Pt extends Bt{constructor(lt,p){var g,u;super({htmlText:Kt,cssText:Vt}),this.setAttribute("data-topic",p),this.classList.add("none"),this.classList.add("page");const L=(g=this.shadowRoot)==null?void 0:g.querySelector("h1");L.innerHTML=p;const v=(u=this.shadowRoot)==null?void 0:u.querySelector("section");lt.on("message",(r,o)=>{if(r==p){const s=document.createElement("div");s.innerText=o,v.appendChild(s)}});const a=()=>{document.querySelectorAll(`.page:not([data-topic="${p}"]`).forEach(o=>{o.classList.add("none")}),this.classList.remove("none")};document.querySelector(`li[data-topic="${p}"]`).addEventListener("click",r=>{console.log(p+"|"+this.getAttribute("data-topic")),a()})}}function Gt(){new Map([["dm-switch",Ot],["dm-chat",Pt]]).forEach((lt,p)=>{window.customElements.get(p)||window.customElements.define(p,lt)})}const Qt=ct=>typeof ct=="object"&&!Array.isArray(ct),Yt=(ct,lt,p)=>{if(typeof lt=="string"&&(ct[lt]=p),Array.isArray(lt))for(const L of lt)ct[L]=p;else if(Qt(lt))for(const L in lt)ct[L]=lt[L]},Jt=ct=>{const lt=new Map;for(const p in ct){const L=p.split("/");let v=lt;for(const a of L)v.has(a)||v.set(a,new Map),v=v.get(a)}return lt};class yt{constructor(lt,p,L){pt(this,"input_element");pt(this,"target_element");pt(this,"value",null);this.input_element=document.getElementById(lt),this.target_element=L?document.getElementById(L):null,this.update_value(p),this.bind_target()}update_value(lt){lt!==void 0&&(this.input_element instanceof HTMLElement?(this.value=lt,this.input_element.value=`${this.value}`):this.input_element instanceof Ot&&(lt==="on"||lt===!0?(this.value=!0,this.input_element.setAttribute("on","")):(this.value=!1,this.input_element.removeAttribute("on"))),this.target_element&&(this.target_element.textContent=`${this.value}`))}bind_target(){this.input_element instanceof HTMLInputElement?this.input_element.addEventListener("input",lt=>{this.update_value(lt.target.value)}):this.input_element instanceof Ot&&(this.input_element.addEventListener("on",()=>{this.update_value(!0)}),this.input_element.addEventListener("off",()=>{this.update_value(!1)}))}}const jt=ct=>ct?(ct^Math.random()*16>>ct/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,jt),Zt=()=>{var ct=["Impatient","Blue","Ugly","Friendly","Sunny","Quick","Intelligent","Curious","Elegant","Delightful","Playful","Vibrant","Clever","Lively","Cozy","Radiant","Sparkling","Adventurous","Mysterious","Peaceful"],lt=["Banana","Penguin","Rock","Pickle","Noodle","Giraffe","Squirrel","Sock","Llama","Wombat","Pancake","Unicorn","Pajamas","Bear","Taco","Tire","Lobster","Pineapple","Kangaroo","Beluga"],p=Math.floor(Math.random()*ct.length),L=Math.floor(Math.random()*lt.length);return ct[p]+lt[L]};class Xt{constructor(){pt(this,"url_path","mqtt://broker.hivemq.com:8000/mqtt");pt(this,"body",document.getElementById("body"));pt(this,"connect_page",document.getElementById("connect_page"));pt(this,"connect_form",document.getElementById("connect_form"));pt(this,"url",new yt("url_input",this.url_path));pt(this,"user",new yt("user_id_input",Zt(),"user_id_output"));pt(this,"client_id",new yt("client_id_input",jt(),"client_id_output"));pt(this,"password",new yt("password_input"));pt(this,"lwt_topic",new yt("lwt_topic_input","wi/disconnect"));pt(this,"lwt_message",new yt("lwt_message_input","So long, and thanks for all the fish."));pt(this,"lwt_qos",new yt("lwt_qos_input","1"));pt(this,"lwt_retain",new yt("lwt_retain_input"));pt(this,"keep_alive",new yt("keep_alive_input","60"));pt(this,"clean_session",new yt("clean_session_input"));pt(this,"connect_btn",document.getElementById("connect_btn"));pt(this,"subscribe_page",document.getElementById("subscribe_page"));pt(this,"subscribe_form",document.getElementById("subscribe_form"));pt(this,"subscribe_topic",new yt("subscribe_topic_input"));pt(this,"subscribe_qos",new yt("subscribe_qos_input"));pt(this,"subscribe_btn",document.getElementById("subscribe_btn"));pt(this,"add_sub_btn",document.getElementById("add_subscription"));pt(this,"open_conn_btn",document.getElementById("open_connection"));pt(this,"subscription_list",document.getElementById("sub_list"));pt(this,"connection_indicators",lt=>{const p=document.querySelectorAll(".plug_disconnected"),L=document.querySelectorAll(".check_circle");lt===!0?(console.log("connected"),L.forEach(v=>{v.classList.contains("none")&&v.classList.remove("none")}),p.forEach(v=>{v.classList.contains("none")||v.classList.add("none")})):lt===!1&&(console.log("disconnected"),L.forEach(v=>{v.classList.contains("none")||v.classList.add("none")}),p.forEach(v=>{v.classList.contains("none")&&v.classList.remove("none")}))});pt(this,"show",lt=>{var v;let p="",L;if(typeof lt=="string")p=lt,L=document.querySelectorAll(".page:not(#"+p+")");else if(lt instanceof HTMLDivElement)p=lt.id,L=document.querySelectorAll(".page:not(#"+p+")");else if(lt instanceof Pt){const a=lt.getAttribute("data-topic");L=document.querySelectorAll(`.page:not([data-topic="${a}"]`),lt.classList.remove("none")}L.forEach(a=>{a.classList.add("none")}),(v=document.getElementById(p))==null||v.classList.remove("none")});pt(this,"render_tree",(lt,p,L="")=>{const v=document.createElement("ul");this.connect_page,p.appendChild(v);for(const[a,c]of lt){const g=document.createElement("li");g.textContent=a;const u=L?L+"/"+a:a;g.setAttribute("data-topic",u),v.appendChild(g),c instanceof Map&&this.render_tree(c,g,u)}});pt(this,"render_pages",(lt,p)=>{for(const L in p)this.body.appendChild(new Pt(lt,L))})}}Gt();console.log(Ht);let Et=null;const At={},ft=new Xt;ft.subscribe_btn.addEventListener("click",()=>Nt(`${ft.subscribe_topic.value}`,{qos:parseInt(`${ft.subscribe_qos.value}`)}));ft.open_conn_btn.addEventListener("click",()=>ft.show(ft.connect_page));ft.add_sub_btn.addEventListener("click",()=>ft.show(ft.subscribe_page));const te=()=>{Et&&alert("Warning: if you've already connected, refresh the page to use your new settings. Reconnecting otherwise will try over and over. (You'll see the connection logo blinking red and black)");const ct={clientId:`${ft.client_id.value}`,username:`${ft.user.value}`,password:`${ft.password.value}`,will:{topic:`${ft.lwt_message.value}`,payload:ft.client_id.value+"-"+ft.user.value+": "+ft.lwt_message.value,qos:ft.lwt_qos.value,retain:ft.lwt_retain.value},keepalive:parseInt(`${ft.keep_alive.value}`),clean:ft.clean_session.value};Et=xt.connect(`${ft.url.value}`,ct),Et.on("connect",()=>{ft.connection_indicators(!0),At["wi/chat"]={qos:2},At[`${ft.lwt_topic.value}`]={qos:parseInt(`${ft.lwt_qos.value}`)},Nt(At),Et.publish("wi/chat","| "+ft.user.value+" has entered the chat on client "+ft.client_id.value)}),Et.on("close",()=>{ft.connection_indicators(!1)})};ft.connect_btn.addEventListener("click",te);function Nt(ct,lt){Et.subscribe(ct,lt,(p,L)=>{if(p)console.error("Error subscribing to topics:",p);else{console.log("Subscribed to topics:",L),Yt(At,ct,lt),ft.subscription_list.innerHTML="";const v=Jt(At);document.querySelectorAll("dm-chat.page").forEach(c=>c.remove()),ft.render_tree(v,ft.subscription_list),ft.render_pages(Et,At)}})}
